{"version":3,"sources":["webpack://Autodesk.Extensions.[name]/webpack/bootstrap","webpack://Autodesk.Extensions.[name]/external \"THREE\"","webpack://Autodesk.Extensions.[name]/./node_modules/css-loader/lib/css-base.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/addStyles.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/urls.js","webpack://Autodesk.Extensions.[name]/./extensions/ViewCubeUi/ViewCubeUi.css?15c5","webpack://Autodesk.Extensions.[name]/./extensions/ViewCubeUi/ViewCubeUi.css","webpack://Autodesk.Extensions.[name]/./extensions/ViewCubeUi/ViewCube.js","webpack://Autodesk.Extensions.[name]/./extensions/ViewCubeUi/ViewCubeUi.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","THREE","useSourceMap","list","toString","this","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","sourceURLs","sources","source","sourceRoot","concat","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","length","id","push","fn","memo","stylesInDom","isOldIE","window","document","all","atob","apply","arguments","getTarget","target","parent","querySelector","getElement","styleTarget","HTMLIFrameElement","contentDocument","head","e","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","options","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createElement","undefined","attrs","type","nonce","getNonce","addAttrs","el","keys","forEach","setAttribute","obj","update","remove","result","transform","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","updateLink","href","applyToTag","newObj","DEBUG","newList","mayRemove","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","location","baseUrl","protocol","host","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","locals","av","Autodesk","Viewing","avp","Private","DDSLoader","createShaderMaterial","ShaderUtils","WebGLRenderer","logger","isMobileDevice","errorCodeString","ErrorCodes","endpoint","getGlobal","GlobalManagerMixin","equalsOne","a","Math","abs","isAxisAlignedUnit","vec3","x","y","z","Triad","triadLength","offSet","triadColors","tempMatrix","sprites","spriteGeometry","getTextSprite","text","color","textCanvas","width","height","ctx2d","getContext","font","fillStyle","textAlign","textBaseline","fillText","textTexture","needsUpdate","side","transparent","depthWrite","depthTest","triadScene","triadLabelScene","triadGeom","xAxis","shading","yAxis","zAxis","applyMatrix","makeTranslation","triadThickness","makeRotationZ","PI","makeRotationY","add","xSprite","ySprite","zSprite","positionLabels","quaternion","spriteSecondaryAxisOffSet","spriteMainAxisOffset","position","set","applyQuaternion","orient","sceneUp","sceneFront","up","front","equals","clone","upAxis","secondaryAxis","tertiaryAxis","upAngle","alignmentAngle","frontAngle","tempQuaternion","rotationQuaternion","rotationAxis","normalize","setFromAxisAngle","multiply","setRotationFromQuaternion","getSprites","ViewCube","tagId","autocam","cubeContainer","localizeResourcePath","self","cam","camera","setCube","viewDir","center","sub","sceneRight","sceneFrontDirection","cross","sceneUpDirection","dotUp","dot","dotFront","dotRight","currentFace","showTriad","shadowScene","cubeScene","gridScene","lineScene","triad","controlScene","compassScene","controlCamera","cube","line","home","shadow","context","edgeNames","cornerNames","menuOptionList","menuEnableList","menuStateCallbackList","orthographicFaces","isPerspective","pcam","ocam","fov","aspect","copy","lookAt","arrowGroup","rollLeftOffset","rollRightOffset","rollOffset","homeOffset","menuOffset","gridMeshes","arrowBuffer","intersectsFace","controlBuffer","cubeBuffer","INTERSECTED","INTERSECTED_F","INTERSECTED_C","cubeSize","loadedTextureCount","_orthogonalView","_havePointerLockFeature","_havePointerLock","_pointerLockMoveBugSPK865","_isChrome","navigator","userAgent","search","_isWindows","platform","_dragged","_transparent","_onViewTypeChangedCb","changingTextures","animSpeed","animate","compass","viewScaleFactorCompass","viewScale","draggable","wantHomeButton","wantRollArrows","wantContextMenu","inactiveOpacity","getPosition","element","rect","getBoundingClientRect","left","top","w","h","pointerLockChange","preventDefault","stopPropagation","_document","getDocument","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","setControlsPositions","renderCompass","rollMesh","rollLeftMesh","rollRightMesh","contextMesh","mouseOverCube","navApi","isActionEnabled","opacity","requestAnimationFrame","render","mouseMoveOverCube","event","viewCubeMenuOpen","max","clientX","clientY","min","sqrt","mouseOutCube","loadTexture","url","image","Image","_window","getWindow","useCredentials","getUseCredentials","crossOrigin","texture","onload","src","createCubeGrid","currentGridLength","cubeCorners","cubeEdges","buildCubeCorner","buildCubeEdge","buildCubeFace","findPickingIntersects","pickingVector","intersectionBuffer","raycaster","direction","unproject","negate","intersectObjects","getPickVector","getEventCoords","coords","touches","pageX","pageY","screenX","screenY","movementX","prevX","movementY","prevY","which","getUseLeftHandedInput","prevCoords","mozMovementX","webkitMovementX","mozMovementY","webkitMovementY","onDocumentMouseDown","currentlyAnimating","removeEventListener","onDocumentMouseMove","addDocumentEventListener","onDocumentMouseUp","getUsePivotAlways","pivot","setPivotPoint","setPivotSetFlag","startInteraction","rightMouse","error","VIEWER_INTERNAL_ERROR","hideArrows","onDocumentMouseMoveCube","requestPointerLock","removeDocumentEventListener","showPivot","currentCursor","orbit","startCursor","startState","endMouseUp","stillNeedUp","addEventListener","exitPointerLock","registerOnViewTypeChangedCb","cb","Function","setViewType","viewType","VIEW_TYPES","ORTHOGRAPHIC","PERSPECTIVE","PERSPECTIVE_ORTHO_FACES","cubeIntersects","arrowIntersects","controlIntersects","endInteraction","menuOrigin","menuSize","menuItemNumber","floor","log","action","track","aggregate","goHome","setCurrentViewAsHome","resetHome","setCurrentViewAsFront","setCurrentViewAsTop","resetOrientation","removeDropdownMenu","mouseMoveSave","processMouseMove","drawDropdownMenu","face","FACES","orientation","getOrientation","order","right","down","back","bottom","f","calculateCubeTransform","elapsedTime","sphericallyInterpolateTransition","clockwise","destination","worldUp","isOrtho","dir","multiplyScalar","goToView","cubeRotateTo","setCameraOrtho","intersectsFaces","material","setHex","children","onWindowResize","offsetWidth","offsetHeight","updateProjectionMatrix","topFov","bottomFov","leftFov","rightFov","renderer","setSize","rotationX","rotationY","edge","square","masterCubeSize","geo","v0","v1","v2","v3","v4","vertices","faces","makeRotationX","computeFaceNormals","computeVertexNormals","overdraw","rotationZ","e0","e1","e2","e3","e4","e5","e6","e7","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","c10","c11","changeBasisWorldToStandard","V","worldD","cubeFront","worldU","worldR","answer","scale","upDir","spriteRotationMatrix","checkControlVisibility","renderTriad","setRotationFromMatrix","clear","getScreenShot","Promise","resolve","reject","canvas","ctx","fillRect","domElement","toBlob","vcBlob","img","drawImage","isFaceView","showArrows","hideContext","showContext","hideHome","showHome","refreshCube","useTransparency","onmouseover","onmousemove","onmouseout","show","showCompass","initCompass","prevRenderCompass","setCompassRotation","newNorthAngle","toRotate","northAngle","compassPointerMeshUp","rotateZ","compassPointerMeshDown","hasCompass","getResourceUrl","planeSize","compassGeom","compassPointerMaterial","resRoot","compassBaseMaterial","compassBaseMesh","xRot","rotateX","yTran","translateZ","showControls","dtor","refreshTexture","onTextureReady","locTexPath","load","minFilter","maxFilter","dispose","shader","uniforms","localize","global","LOCALIZATION_REL_PATH","bounds","filteringType","cubeGeometry","cubeLine","borderTexture","Array","arrowDist","arrowGeo","arrowMaterial1","arrowMaterial2","arrowMaterial3","arrowMaterial4","arrowSelection","arrowSelectionMat","upArrow","upArrowSelect","downArrow","downArrowSelect","rotation","rightArrow","rightArrowSelect","leftArrow","leftArrowSelect","homeGeo","homeMaterial","rollArrows","rollMaterial","roll","rollSelectionLeft","rollSelectionLeftMat","rollLeft","rollSelectionRight","rollSelectionRightMat","rollRight","contextGeo","contextMaterial","shadowGeo","shadowMat","shadowToCubeDist","toUpperCase","alpha","antialias","warn","autoClear","sortObjects","mozExitPointerLock","webkitExitPointerLock","mozRequestPointerLock","webkitRequestPointerLock","Init","ViewCubeUi","viewer","Extension","container","viewcube","homeViewContainer","_created","_initTriadVisibility","displayViewCube","_updateView","_onModelAdded","constructor","assign","_displayViewCube","impl","is2d","dispatchEvent","VIEW_CUBE_CREATED_EVENT","VIEWER_RESIZE_EVENT","prefs","addListeners","Prefs3D","VIEW_CUBE","VIEW_TYPE","model","models","getVisibleModels","MODEL_ADDED_EVENT","_setDefaultView","unload","removeListeners","hideHomeViewMenu","initContainer","initHomeButton","className","navigation","setRequestHomeView","setVisible","display","getModelCamera","getViewType","setViewCube","displayHomeButton","updatePrefs","_positionHomeButton","setGlobalManager","globalManager","refresh","radians","_initCompass","data","getData","metadata","projectNorthVector","XYZ","Vector3","frontDirection","upVector","crossVectors","projectNorthAngle","angleTo","customValues","trueNorthAngle","angleToTrueNorth","loadOptions","applyRefPoint","VIEW_CUBE_COMPASS","classList","theExtensionManager","registerExtension"],"mappings":"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","file":"ViewCubeUi/ViewCubeUi.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 877);\n","module.exports = THREE;","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./ViewCubeUi.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./ViewCubeUi.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./ViewCubeUi.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".viewcube,.viewcubeWrapper{display:block;position:absolute;outline:none;width:170px;height:170px;right:-1px;top:-1px;opacity:0.7;margin:0;-webkit-transition:opacity 0.2s ease;-moz-transition:opacity 0.2s ease;-ms-transition:opacity 0.2s ease;-o-transition:opacity 0.2s ease;transition:opacity 0.2s ease}.viewcubeWrapper{pointer-events:none}.viewcube{pointer-events:auto}.rewindFrame{background-color:#FFFFFF;position:absolute;height:56px;width:56px;z-index:1002}.dropDownMenu{position:absolute;min-width:220px;margin:0;z-index:1001;background-color:#FFFFFF;font-family:sans-serif;font-size:14px;list-style-type:none;border:solid;border-width:1px;border-color:#979797}.dropDownMenuItem{position:relative;width:calc(100% - 24px);height:21px;padding-left:24px;padding-top:4px;background-color:#FFFFFF;cursor:pointer}.dropDownMenuCheckbox{position:relative;width:calc(100% - 4px);padding-top:4px;height:21px;margin-left:4px;background-color:#FFFFFF;cursor:pointer}.dropDownMenuCheck{padding-top:2px;cursor:pointer}.dropDownMenuCheckText{position:relative;padding-left:2px;margin:0;cursor:pointer}.dropDownMenuItemDisabled{color:#999999;position:relative;width:calc(100% - 5px);height:23px;background-color:#FFFFFF;cursor:pointer}.dropDownMenuItem:hover{background-color:#E7EEF6}.dropDownMenuCheckbox:hover{background-color:#E7EEF6}.textBox{font-size:15px;background-color:#000;opacity:0.6;padding:2px 10px;border-radius:2px;position:fixed;display:none;font-family:Monospace;color:#fff;z-index:1000}#colorCode{position:absolute;left:0px;top:0px}#text,#steeringWheel{position:absolute;left:0px;top:0px;z-index:900}.homeViewWrapper{display:block;outline:none;margin:18px 0px 0px -20px;opacity:0.7;width:24px;height:24px;background-image:url(data:image/png;base64,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);cursor:pointer;pointer-events:auto}.homeViewWrapper:hover{opacity:1}.homeViewWrapper.no-viewcube{position:absolute;right:12px;top:10px;margin:0}.homeViewMenu{display:none;position:absolute;right:10px;top:28px;background-color:#FFFFFF;border:1px solid #979797;z-index:1}.homeViewMenuItem{padding:5px 20px;font-family:sans-serif;font-size:14px;cursor:pointer;z-index:2}.homeViewMenuItem:hover{background-color:#E7EEF6}.homeViewWrapper .homeViewMenuHandle{display:none;position:relative;left:18px;top:18px}\\n\", \"\"]);\n\n// exports\n","import * as THREE from \"three\";\nconst av = Autodesk.Viewing;\nconst avp = av.Private;\n\nconst DDSLoader = avp.DDSLoader; \nconst { createShaderMaterial } = avp.ShaderUtils;\nconst WebGLRenderer = avp.WebGLRenderer;\nconst logger = avp.logger;\nconst isMobileDevice = av.isMobileDevice;\nconst { errorCodeString, ErrorCodes } = av;\nconst endpoint = av.endpoint;\nconst getGlobal = av.getGlobal;\nconst GlobalManagerMixin = av.GlobalManagerMixin;\nconst EPSILON = 0.00001;\n\n/**\n * Checks if a number is 1 (or really, really close to 1). Things like 0.9999999999999 still count. This is needed\n * because THREE.Vector3.normalize doesn't always create a vector with length exactly 1, sometimes it just gets close.\n * For example:\n * var t = new THREE.Vector3(0, 0, -0.6873695734180347);\n * t.normalize();\n * t.z; // -0.9999999999999999\n *\n * @param {Number} a - Number to check\n * @return {boolean} - True if the given number is within 1e-12 of 1\n */\nvar equalsOne = function(a) {\n  return Math.abs(a - 1) < 1e-12;\n};\n\n/**\n * Check if a vector is aligned with an axis and has a length of 1\n *\n * @param {Vector3} vec3 - The vector to check\n * @return {boolean} - True if the vector is aligned to an axis and has length 1\n */\nvar isAxisAlignedUnit = function(vec3) {\n  return !(\n    !equalsOne(vec3.length()) ||\n    (!equalsOne(Math.abs(vec3.x)) && !equalsOne(Math.abs(vec3.y)) && !equalsOne(Math.abs(vec3.z)))\n  );\n};\n\nconst COLOR_ARROW = 0xB7B9BC;\n\n// A Triad representing the model's coordinates\nfunction Triad(triadLength) {\n  var offSet = triadLength / 2;\n  var triadThickness = 10;\n  var spriteSize = 50;\n  var triadColors = {\n    x: 0xff0000,\n    y: 0x00ff00,\n    z: 0x0000ff\n  };\n  var tempMatrix = new THREE.Matrix4(); // A matrix for temporary calculations\n  var sprites = []; // For tracking things that need to always face the camera\n\n  var spriteGeometry = new THREE.PlaneBufferGeometry(spriteSize, spriteSize);\n  var getTextSprite = function(text, color) {\n    var _document = av.getGlobal().document;\n    var textCanvas = _document.createElement('canvas');\n    textCanvas.width = textCanvas.height = 128;\n    var ctx2d = textCanvas.getContext('2d');\n    ctx2d.font = '128px Arial';\n    ctx2d.fillStyle = \"rgba(255,255,255,1)\";\n    ctx2d.textAlign = 'center';\n    ctx2d.textBaseline = 'middle';\n    ctx2d.fillText(text, textCanvas.width / 2, textCanvas.height / 2);\n\n    var textTexture = new THREE.Texture(textCanvas);\n    textTexture.needsUpdate = true;\n\n    return new THREE.Mesh(\n      spriteGeometry,\n      new THREE.MeshBasicMaterial({\n        map: textTexture,\n        side: THREE.DoubleSide,\n        transparent: true,\n        color: color,\n        depthWrite: false,\n        depthTest: true\n      })\n    );\n  };\n\n  this.triadScene = new THREE.Scene();\n  this.triadLabelScene = new THREE.Scene();\n\n  // Add the axes.\n  var triadGeom = new THREE.BoxGeometry(triadLength, triadThickness, triadThickness);\n  var xAxis = new THREE.Mesh(triadGeom, new THREE.MeshBasicMaterial(\n    {color: triadColors.x, shading: THREE.SmoothShading}));\n  var yAxis = new THREE.Mesh(triadGeom, new THREE.MeshBasicMaterial(\n    {color: triadColors.y, shading: THREE.SmoothShading}));\n  var zAxis = new THREE.Mesh(triadGeom, new THREE.MeshBasicMaterial(\n    {color: triadColors.z, shading: THREE.SmoothShading}));\n\n  xAxis.applyMatrix(tempMatrix.makeTranslation(triadThickness / 2, -offSet, -offSet));\n  yAxis.applyMatrix(tempMatrix.makeRotationZ(Math.PI / 2));\n  yAxis.applyMatrix(tempMatrix.makeTranslation(-offSet, triadThickness / 2, -offSet));\n  zAxis.applyMatrix(tempMatrix.makeRotationY(Math.PI / 2));\n  zAxis.applyMatrix(tempMatrix.makeTranslation(-offSet, -offSet, triadThickness / 2));\n\n  this.triadScene.add(xAxis);\n  this.triadScene.add(yAxis);\n  this.triadScene.add(zAxis);\n\n  // Add text\n  var xSprite = getTextSprite('X', triadColors.x);\n  var ySprite = getTextSprite('Y', triadColors.y);\n  var zSprite = getTextSprite('Z', triadColors.z);\n\n  // Rotate the text to match the up direction. Only rotate the positions, otherwise orienting them to face the\n  // camera becomes more complicated\n  var positionLabels = function(quaternion) {\n    var spriteSecondaryAxisOffSet = -(spriteSize + offSet) / 2 - 20;\n    var spriteMainAxisOffset = offSet + spriteSize;\n    xSprite.position.set(spriteMainAxisOffset, spriteSecondaryAxisOffSet, spriteSecondaryAxisOffSet);\n    ySprite.position.set(spriteSecondaryAxisOffSet, spriteMainAxisOffset, spriteSecondaryAxisOffSet);\n    zSprite.position.set(spriteSecondaryAxisOffSet, spriteSecondaryAxisOffSet, spriteMainAxisOffset);\n\n    if (quaternion) {\n      xSprite.position.applyQuaternion(quaternion);\n      ySprite.position.applyQuaternion(quaternion);\n      zSprite.position.applyQuaternion(quaternion);\n    }\n  };\n  positionLabels();\n\n  // Add them to the list of sprites to keep them oriented correctly\n  sprites.push(xSprite);\n  sprites.push(ySprite);\n  sprites.push(zSprite);\n\n  this.triadLabelScene.add(xSprite);\n  this.triadLabelScene.add(ySprite);\n  this.triadLabelScene.add(zSprite);\n\n  /**\n   * Reorients the triad so that the model coordinates are represented correctly. If the resulting orientation of the\n   * triad will not be aligned with X/Y/Z, nothing happens.\n   *\n   * @param {Vector3} sceneUp - The scene up. Expected to be a unit vector.\n   * @param {Vector3} sceneFront - The scene front. Expected to be a unit vector.\n   */\n  this.orient = function(sceneUp, sceneFront) {\n    if (!isAxisAlignedUnit(sceneUp) || !isAxisAlignedUnit(sceneFront)) {\n      return;\n    }\n\n    // Only reorient if something changed\n    if (this.up && this.front && sceneUp.equals(this.up) && sceneFront.equals(this.front)) {\n      return;\n    }\n\n    this.up = sceneUp.clone();\n    this.front = sceneFront.clone();\n\n    // The triad starts with Y up with each line pointing towards the positive direction of its axis.\n    // Orienting the triad to align with scene up and world front is done in 2 steps\n    // 1. Get the correct axis aligned with vertical (rotate about [1, 1, 1]) and keep it in line with the viewcube\n    // 2. Rotate about scene up to align the correct axis and direction with world front\n    // 3. Rotate about world front to get the correct direction for scene up\n\n    // Align scene up\n    // secondaryAxis and tertiaryAxis are used to work out which axes to check for aligning the front, simplifying\n    // the if statements a bit\n    var upAxis, secondaryAxis, tertiaryAxis, alignmentAngle = 0, frontAngle = 0, upAngle = 0;\n    if (sceneUp.x) {\n      upAxis = 'x';\n      secondaryAxis = 'y';\n      tertiaryAxis = 'z';\n      alignmentAngle = 2 * Math.PI / 3;\n    } else if (sceneUp.y) {\n      upAxis = 'y';\n      secondaryAxis = 'z';\n      tertiaryAxis = 'x';\n    } else if (sceneUp.z) {\n      upAxis = 'z';\n      secondaryAxis = 'x';\n      tertiaryAxis = 'y';\n      alignmentAngle = -2 * Math.PI / 3;\n    }\n\n    // Align front\n    if (equalsOne(-sceneFront[secondaryAxis])) {\n      // The 'secondaryAxis' is already parallel to the front so we need to decide we need a half rotation\n      frontAngle = Math.PI;\n    } else if (sceneFront[tertiaryAxis]) {\n      // The 'tertiaryAxis' is orthogonal to the front so we need a quarter rotation but have to decide which way\n      // to rotate. Direction is dependent on whether we need front to be + or - as well as whether sceneUp is + or -\n      // since that's the axis we'll be rotating around\n      frontAngle = -sceneFront[tertiaryAxis] * sceneUp[upAxis] * Math.PI / 2;\n    }\n\n    // Correct up direction\n    upAngle = equalsOne(-sceneUp[upAxis]) ? Math.PI : 0;\n\n    var tempQuaternion = new THREE.Quaternion();\n    var rotationQuaternion = new THREE.Quaternion();\n\n    // Step 1\n    var rotationAxis = new THREE.Vector3(1, 1, 1);\n    rotationAxis.normalize();\n    rotationQuaternion.setFromAxisAngle(rotationAxis, alignmentAngle);\n\n    // Step 2\n    tempQuaternion.setFromAxisAngle(sceneUp, frontAngle);\n    rotationQuaternion.multiply(tempQuaternion);\n\n    // Step 3\n    tempQuaternion.setFromAxisAngle(sceneFront, upAngle);\n    rotationQuaternion.multiply(tempQuaternion);\n\n    positionLabels(rotationQuaternion);\n    this.triadScene.setRotationFromQuaternion(rotationQuaternion);\n  };\n\n  this.getSprites = function() { return sprites; };\n}\n\n/* All coordinates in three.js are right handed\n * when looking at the Front of the Cube in the regular upright position: */\n/**\n * This is the view cube class subset of Autocam\n * this class renders and provides all functionality for the view cube\n * @class\n * @param {string} tagId - html tag id where you want the view cube to render - OBSOLETE\n * @param {Object} autocam - the autocam controller object\n * @param {HTMLDivElement} cubeContainer - the HTML element to contain the view cube\n * @param {string} localizeResourcePath - relative path to localized texture images\n * @param {Object} [options] - the optional options\n * @param {string} [options.showTriad] - whether to show the triad. 'up' is given by autocam's world up\n * */\nexport function ViewCube(tagId, autocam, cubeContainer, localizeResourcePath, options) {\n\n    var self = this;\n    GlobalManagerMixin.call(this);\n\n    var cam = autocam;\n    var camera = autocam.camera;\n    autocam.setCube(this);\n\n    const viewDir = cam.center.clone().sub(camera.position).normalize();\n    const sceneRight  = cam.sceneFrontDirection.clone().cross(cam.sceneUpDirection);\n    const dotUp    = viewDir.dot(cam.sceneUpDirection);\n    const dotFront = viewDir.dot(cam.sceneFrontDirection);\n    const dotRight = viewDir.dot(sceneRight);\n\n    if ((1 - Math.abs(dotUp)) < EPSILON) {\n        self.currentFace = dotUp > 0 ? \"bottom\" : \"top\";\n    } else if ((1 - Math.abs(dotFront)) < EPSILON) {\n        self.currentFace = dotFront > 0 ? \"front\" : \"back\";\n    } else if (1 - Math.abs(Math.abs(dotRight)) < EPSILON) {\n        self.currentFace = dotRight > 0 ? \"left\" : \"right\";\n    } else {\n        self.currentFace = \"front\";\n    }\n\n    self.showTriad = options && options.showTriad;\n    self.localizeResourcePath = localizeResourcePath;\n\n    var edgeNames = [\"top,front\",\"top right\", \"top,left\", \"top,back\", \"bottom,front\", \"bottom,right\", \"bottom,left\", \"bottom,back\", \"left,front\", \"front,right\", \"right,back\", \"back,left\"];\n    var cornerNames = [\"front,top,right\",\"back,top,right\",\"front,top,left\",\"back,top,left\",\"front,bottom,right\",\"back,bottom,right\",\"front,bottom,left\",\"back,bottom,left\"];\n\n   /**\n     *  A string array which contains the options for the view cube menu. Use null to indicate a section separator\n     * @type {Array}\n     */\n    var menuOptionList = [\n        \"Go Home\",                          // localized by call to drawDropdownMenu\n        null,\n        \"Orthographic\",                     // localized by call to drawDropdownMenu\n        \"Perspective\",                      // localized by call to drawDropdownMenu\n        \"Perspective with Ortho Faces\",     // localized by call to drawDropdownMenu\n        null,\n        \"Set current view as Home\",         // localized by call to drawDropdownMenu\n        \"Focus and set as Home\",            // localized by call to drawDropdownMenu\n        \"Reset Home\",                       // localized by call to drawDropdownMenu\n        null,\n        \"Set current view as Front\",        // localized by call to drawDropdownMenu\n        \"Set current view as Top\",          // localized by call to drawDropdownMenu\n        \"Reset orientation\"                 // localized by call to drawDropdownMenu\n        /*\n        null,\n        \"Properties...\",\n        null,\n        \"Help...\"\n        */\n    ];\n    var menuEnableList = [\n        true,\n        null,\n        true,\n        true,\n        true,\n        null,\n        true,\n        true,\n        true,\n        null,\n        true,\n        true,\n        true\n        /*\n        null,\n        \"Properties...\",\n        null,\n        \"Help...\"\n        */\n    ];\n    var menuStateCallbackList = [\n        null,\n        null,\n        function() { return !cam.orthographicFaces && !camera.isPerspective; },\n        function() { return !cam.orthographicFaces &&  camera.isPerspective; },\n        function() { return cam.orthographicFaces; },\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null\n        /*\n        null,\n        \"Properties...\",\n        null,\n        \"Help...\"\n        */\n    ];\n\n    // THREE.js Scenes\n    var shadowScene, cubeScene, gridScene, lineScene, triad, controlScene, compassScene;\n\n    // An array of objects that need to always face the camera\n    var sprites = [];\n\n    var controlCamera;\n    // self.camera = new THREE.PerspectiveCamera( camera.fov, window.innerWidth / window.innerHeight, 1, 10000 );\n    // make two cameras to flip between, depending if perspective or orthographic view is used.\n    // TODO: scale keeps the size of the view cube the same; 45 fov used to be the default FOV. Problem with this\n    // idea is that you also then need to adjust the position (and not below - setting it there does nothing) and this\n    // will change the look of the perspective cube.\n    self.pcam = new THREE.PerspectiveCamera( 45, 1.0, 1, 2000 ); // aspect gets truly set during Init()\n    self.ocam = new THREE.OrthographicCamera(-265,265, 265,-265, -1000, 1000);\n    self.ocam.fov = self.pcam.fov;\n    self.ocam.aspect = self.pcam.aspect;\n    self.camera = camera.isPerspective ? self.pcam : self.ocam;\n    self.camera.position.copy(camera.position);\n    self.center = new THREE.Vector3(0,0,0);\n    self.camera.lookAt(self.center);\n    // var length = camera.position.length();\n\n    // THREE.js Meshes\n    var cube, line, home, shadow, context;\n    var gridMeshes = [];\n    var arrowGroup;\n\n    // Sizes for Three.js renderers\n    //var windowHalfX;\n    //var windowHalfY;\n\n    // Buffers and past INTERSECTS used for mouse picking\n    var arrowBuffer = [];\n    var intersectsFace = [];\n    var controlBuffer = [];\n    var cubeBuffer = [];\n    var INTERSECTED = null;\n    var INTERSECTED_F = null;\n    var INTERSECTED_C = null;\n    var rollLeftOffset, rollRightOffset, rollOffset;\n    var homeOffset, menuOffset;\n\n    // Size of cube in relation to HTML tag\n    var cubeSize = 0;\n\n    // Position of HTML element\n    var position;\n\n    // Used to wait for textures to load before rendering the View Cube\n    var loadedTextureCount = 0;\n\n    // Flags\n    // Whether arrows (orthogonal and roll) are visible (i.e., you're directly facing a cube face).\n    var _orthogonalView = true;\n    var _havePointerLockFeature = false;\n    var _havePointerLock = false;\n    var _pointerLockMoveBugSPK865 = false;\n\tvar _isChrome = (navigator.userAgent.search(\"Chrome\") != -1);\n\tvar _isWindows = (navigator.platform.search(\"Win32\") != -1);\n    var _dragged = false;\n    var _transparent = false;\n\n    // Callback for menu selected item \n    var _onViewTypeChangedCb = null;\n\n    // store all loaded textures here so we are not constantly re-downloading them\n    var changingTextures = [];\n\n    // Height and Width of the renderer\n    // may be referred to as self.width and self.height\n    this.width = 0;\n    this.height = 0;\n\n    // Public changeable values\n    /**\n     * view cube animation speed (not 0 or negative),\n     * specified in time (milliseconds) to complete an animation\n     * @type {Number}\n     */\n    this.animSpeed = 500;\n    /**\n     * turn on and off animation\n     * @type {Boolean}\n     */\n    this.animate = true;\n    /**\n     * turn on and off ability to drag the view cube\n     * @type {Boolean}\n     */\n\n    this.compass = false;\n    this.viewScaleFactorCompass = 1.5;\n    this.viewScale = 1; // Set in Init based on cubeSize\n\n    this.draggable = true;\n\n    /**\n     * turn on and off the availability of the home button;\n     * note, this is a \"second\", smaller home button, you probably\n     * do not want it.\n     * @type {Boolean}\n     */\n    this.wantHomeButton = false;\n\n    /**\n     * turn on and off the availability of the roll arrows\n     * @type {Boolean}\n     */\n    this.wantRollArrows = true;\n\n    /**\n     * turn on and off the availability of the menu icon\n     * @type {Boolean}\n     */\n    this.wantContextMenu = true;\n\n    /**\n     * opacity when inactive (transparency must be enabled)\n     * @type {Number}\n     */\n    this.inactiveOpacity = 0.5;\n\n    /** Function to get position of html element on screen\n     *\n     * @param element - HTML DOM element to find position of\n     * @return {Object} - object which specifies x and y screen coordinates of location of input element\n     */\n    var getPosition = function (element) {\n        var rect = element.getBoundingClientRect();\n        return { x: rect.left, y: rect.top, w: rect.width, h: rect.height };\n\n        /*\n        var xPosition = window.pageXOffset;\n        var yPosition = window.pageYOffset;\n\n        while (element) {\n            xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);\n            yPosition += (element.offsetTop - element.scrollTop + element.clientTop);\n            element = element.offsetParent;\n        }\n        return { x:xPosition, y:yPosition };\n        */\n    };\n\n    /** Used by pointer lock API\n     *\n     * @param {Object} e - event object\n     */\n    var pointerLockChange = function(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        var _document = self.getDocument();\n        _havePointerLock = (_document.pointerLockElement === cubeContainer ||\n                            _document.mozPointerLockElement === cubeContainer ||\n                            _document.webkitPointerLockElement === cubeContainer);\n    };\n\n    var setControlsPositions = function() {\n        const rollArrowMargin = 30;\n        if (self.renderCompass) {\n            self.rollMesh.position.set(cubeSize + rollArrowMargin, cubeSize + rollArrowMargin, 0);\n            self.rollLeftMesh.position.set(cubeSize + rollArrowMargin, 1.5 * cubeSize, 0.1);\n            self.rollRightMesh.position.set(1.5 * cubeSize, cubeSize + rollArrowMargin, 0.1);\n            self.contextMesh.position.set(1.6 * cubeSize, - 1.6 * cubeSize, 0);\n        } else {\n            self.rollMesh.position.set(cubeSize * 0.5 + 20, cubeSize * 0.5 + 20, 0);\n            self.rollLeftMesh.position.set(cubeSize * 0.5 + 20, cubeSize + 20, 0.1);\n            self.rollRightMesh.position.set(cubeSize + 20, cubeSize * 0.5 + 20, 0.1);\n            self.contextMesh.position.set(cubeSize, -cubeSize, 0);\n        }\n    };\n\n    /** Create ViewCube and set up renderer and camera\n     * sets up all Three.js meshes for the View Cube\n     * and initializes all event handlers such as mousemove\n     * and mousedown and mouseup and pointerlock\n     */\n    var Init = function () {\n\n        // parentTag = document.getElementById(tagId);\n\n        // var element = $('#'+tagId); // ?? Is this different than the above?\n        // element.width(300);\n        // element.height(300);\n\n        var bounds = cubeContainer.getBoundingClientRect();\n        self.width  = bounds.width;\n        self.height = bounds.height;\n\n        position = getPosition(cubeContainer);\n\n        //windowHalfX = self.width / 2;\n        //windowHalfY = self.height / 2;\n\n        //camera for home and arrow\n        controlCamera = new THREE.PerspectiveCamera(70, self.height / self.width, 1, 10000);\n        controlCamera.position.set(0, 0, 500);\n\n        shadowScene = new THREE.Scene();\n        cubeScene = new THREE.Scene();\n        gridScene = new THREE.Scene();\n        lineScene = new THREE.Scene();\n        controlScene = new THREE.Scene();\n        _orthogonalView = true;\n\n        // This size means that the cube is (cubeSize)x(cubeSize)x(cubeSize) big\n        cubeSize = 160;\n        // This adjusts the camera position in perspective view. Has no effect on orthographic cams\n        self.viewScale = cubeSize * 4;\n\n        /******************************************Create the View Cube***********************************************/\n        \n        // Load in the faceMap textures for 6 faces\n        var material = self.refreshTexture();\n\n        var filteringType = THREE.LinearFilter;\n        var getResourceUrl = Autodesk.Viewing.Private.getResourceUrl;\n        var resRoot = 'res/textures/';\n\n        var cubeGeometry = new THREE.BoxGeometry(cubeSize, cubeSize, cubeSize, 4, 4, 4);\n        var cubeLine = new THREE.BoxGeometry(cubeSize+1 , cubeSize+1 , cubeSize+1, 4, 4, 4);\n\n        // Create a cube object mesh with specified geometry and faceMap materials\n        cube = new THREE.Mesh(cubeGeometry, material);\n        cube.position.set(0.0, 0, 0);\n        cubeScene.add(cube);\n\n        // Set up a line segment for the cube border\n        var borderTexture = loadTexture(getResourceUrl(resRoot + 'VCedge1.png'));\n\n        borderTexture.minFilter = borderTexture.maxFilter = filteringType;\n\n        line = new THREE.Mesh(cubeLine, new THREE.MeshBasicMaterial({ map: borderTexture, overdraw: false, transparent: true, shading: THREE.SmoothShading }));\n        line.position.set(0.0, 0, 0);\n        lineScene.add(line);\n\n        // Set up the triad\n        triad = new Triad(cubeSize + 20);\n        Array.prototype.push.apply(sprites, triad.getSprites());\n\n        /********************************************Set up the controls**********************************************/\n\n        // Orthogonal Arrows\n\n        var arrowDist = cubeSize + 5;\n\n        var arrowGeo = new THREE.Geometry();\n\n        var v1 = new THREE.Vector3(-30, 0, 0);\n        var v2 = new THREE.Vector3(30, 0, 0);\n        var v3 = new THREE.Vector3(0, -30, 0);\n\n        arrowGeo.vertices.push(v1);\n        arrowGeo.vertices.push(v2);\n        arrowGeo.vertices.push(v3);\n\n        arrowGeo.faces.push(new THREE.Face3(1, 0, 2));\n        arrowGeo.computeFaceNormals();\n\n        // Arrows are rendered flat over other mesh, so it's depthTest and depthWrite can be turned off\n        var arrowMaterial1 = new THREE.MeshBasicMaterial({ overdraw: true, color: COLOR_ARROW,\n            depthTest: false, depthWrite: false, transparent: false, opacity: 1, shading: THREE.FlatShading });\n        var arrowMaterial2 = new THREE.MeshBasicMaterial({ overdraw: true, color: COLOR_ARROW,\n            depthTest: false, depthWrite: false, transparent: false, opacity: 1, shading: THREE.FlatShading });\n        var arrowMaterial3 = new THREE.MeshBasicMaterial({ overdraw: true, color: COLOR_ARROW,\n            depthTest: false, depthWrite: false, transparent: false, opacity: 1, shading: THREE.FlatShading });\n        var arrowMaterial4 = new THREE.MeshBasicMaterial({ overdraw: true, color: COLOR_ARROW,\n            depthTest: false, depthWrite: false, transparent: false, opacity: 1, shading: THREE.FlatShading });\n\n        var arrowSelection = new THREE.PlaneBufferGeometry(cubeSize * 0.5, cubeSize * 0.3, 2, 2);\n        var arrowSelectionMat = new THREE.MeshBasicMaterial({transparent: true, opacity: 0.0});\n\n        var upArrow = new THREE.Mesh(arrowGeo, arrowMaterial1);\n        var upArrowSelect = new THREE.Mesh(arrowSelection, arrowSelectionMat);\n        upArrow.position.set(0, arrowDist, 0.0);\n        upArrowSelect.position.set(0, arrowDist * 0.9, 0.1);\n\n        var downArrow = new THREE.Mesh(arrowGeo, arrowMaterial2);\n        var downArrowSelect = new THREE.Mesh(arrowSelection, arrowSelectionMat);\n        downArrow.position.set(0, -arrowDist, 0.0);\n        downArrowSelect.position.set(0, -arrowDist * 0.9, 0.1);\n        downArrow.rotation.z += Math.PI;\n        downArrowSelect.rotation.z += Math.PI;\n\n        var rightArrow = new THREE.Mesh(arrowGeo, arrowMaterial3);\n        var rightArrowSelect = new THREE.Mesh(arrowSelection, arrowSelectionMat);\n        rightArrow.position.set(arrowDist, 0, 0.0);\n        rightArrowSelect.position.set(arrowDist * 0.9, 0, 0.1);\n        rightArrow.rotation.z -= Math.PI / 2;\n        rightArrowSelect.rotation.z -= Math.PI / 2;\n\n        var leftArrow = new THREE.Mesh(arrowGeo, arrowMaterial4);\n        var leftArrowSelect = new THREE.Mesh(arrowSelection, arrowSelectionMat);\n        leftArrow.position.set(-arrowDist, 0, 0.0);\n        leftArrowSelect.position.set(-arrowDist * 0.9, 0, 0.1);\n        leftArrow.rotation.z += Math.PI / 2;\n        leftArrowSelect.rotation.z += Math.PI / 2;\n\n        arrowGroup = new THREE.Object3D();\n        arrowGroup.position.set(0, 0, 0);\n        arrowGroup.add(upArrow);\n        arrowGroup.add(downArrow);\n        arrowGroup.add(rightArrow);\n        arrowGroup.add(leftArrow);\n\n        controlScene.add(upArrowSelect);\n        controlScene.add(downArrowSelect);\n        controlScene.add(rightArrowSelect);\n        controlScene.add(leftArrowSelect);\n        controlScene.add(arrowGroup);\n\n        arrowBuffer.push(upArrowSelect);\n        arrowBuffer.push(downArrowSelect);\n        arrowBuffer.push(rightArrowSelect);\n        arrowBuffer.push(leftArrowSelect);\n\n        // Home icon\n        var homeGeo = new THREE.PlaneBufferGeometry(cubeSize / 3, cubeSize / 3, 2, 2);\n        var homeMaterial = new THREE.MeshBasicMaterial({ map: loadTexture(getResourceUrl(resRoot + 'VChome.png')),\n            transparent: true, shading: THREE.FlatShading });\n        //homeMaterial.needsUpdate = true;\n        home = new THREE.Mesh(homeGeo, homeMaterial);\n        home.position.set(-cubeSize, cubeSize, 0);\n\n        homeOffset = controlBuffer.length;\n        controlScene.add(home);\n        controlBuffer.push(home);\n\n        // Arrows for rolling\n        var rollArrows = new THREE.PlaneBufferGeometry(cubeSize * 1.5, cubeSize * 1.5, 2, 2);\n        var rollMaterial = new THREE.MeshBasicMaterial({ map: loadTexture(getResourceUrl(resRoot + 'VCarrows.png')), shading: THREE.FlatShading, depthTest: false, depthWrite: false, transparent: true});\n        var roll = new THREE.Mesh(rollArrows, rollMaterial);\n        self.rollMesh = roll;\n\n        var rollSelectionLeft = new THREE.PlaneBufferGeometry(cubeSize * 0.6, cubeSize * 0.45, 2, 2);\n        var rollSelectionLeftMat = new THREE.MeshBasicMaterial({transparent: true, opacity: 0.0});\n        var rollLeft = new THREE.Mesh(rollSelectionLeft, rollSelectionLeftMat);\n        self.rollLeftMesh = rollLeft;\n\n        var rollSelectionRight = new THREE.PlaneBufferGeometry(cubeSize * 0.45, cubeSize * 0.6, 2, 2);\n        var rollSelectionRightMat = new THREE.MeshBasicMaterial({transparent: true, opacity: 0.0});\n        var rollRight = new THREE.Mesh(rollSelectionRight, rollSelectionRightMat);\n        self.rollRightMesh = rollRight;\n\n        controlScene.add(roll);\n        controlScene.add(rollLeft);\n        controlScene.add(rollRight);\n\n        rollLeftOffset = controlBuffer.length;\n        controlBuffer.push(rollLeft);\n        rollRightOffset = controlBuffer.length;\n        controlBuffer.push(rollRight);\n        rollOffset = controlBuffer.length;\n        controlBuffer.push(roll);\n\n        //Menu Icon\n        var contextGeo = new THREE.PlaneBufferGeometry(cubeSize / 2.3, cubeSize / 2.3, 2, 2);\n        var contextMaterial = new THREE.MeshBasicMaterial({ map: loadTexture(getResourceUrl(resRoot + 'VCcontext.png')),\n            transparent: true, depthTest: false, depthWrite: false, shading: THREE.FlatShading });\n        //homeMaterial.needsUpdate = true;\n        context = new THREE.Mesh(contextGeo, contextMaterial);\n        self.contextMesh = context;\n\n        menuOffset = controlBuffer.length;\n        controlScene.add(context);\n        controlBuffer.push(context);\n\n        // Move the controls to right positions\n        setControlsPositions();\n\n        // Cube Shadow (Plane)\n\n        var shadowGeo = new THREE.Geometry();\n\n        shadowGeo.vertices.push(new THREE.Vector3(0, 0, 0));\n\n        const shadowToCubeDist = Math.floor(cubeSize * 0.20 / 2) || 20;\n        shadowGeo.vertices.push(new THREE.Vector3(-cubeSize / 2, -cubeSize / 2 - shadowToCubeDist, -cubeSize / 2));\n        shadowGeo.vertices.push(new THREE.Vector3(cubeSize / 2, -cubeSize / 2 - shadowToCubeDist, -cubeSize / 2));\n        shadowGeo.vertices.push(new THREE.Vector3(cubeSize / 2, -cubeSize / 2 - shadowToCubeDist, cubeSize / 2));\n        shadowGeo.vertices.push(new THREE.Vector3(-cubeSize / 2, -cubeSize / 2 - shadowToCubeDist, cubeSize / 2));\n\n        shadowGeo.faces.push(new THREE.Face3(4, 3, 2));\n        shadowGeo.faces.push(new THREE.Face3(4, 2, 1));\n\n\n        var shadowMat;\n\n        // if(cam.renderer === 'WEBGL') {\n        //     var vertexShader = \"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}\";\n        //     var fragmentShader = \"void main() {gl_FragColor = vec4(0, 0, 0, 0.5);}\";\n        //     shadowMat = new THREE.ShaderMaterial({vertexShader: vertexShader, fragmentShader: fragmentShader});\n        // }else{\n        //     shadowMat = new THREE.MeshBasicMaterial({color:0x000000, transparent:true, opacity: 0.5});\n        // }\n        shadowMat = new THREE.MeshBasicMaterial({color:0x000000, transparent:true, opacity: 0.5});\n\n        shadow = new THREE.Mesh(shadowGeo, shadowMat);\n        shadowScene.add(shadow);\n\n        createCubeGrid();\n\n        if (cam.renderer.toUpperCase() === 'CANVAS'){\n            self.renderer = new THREE.CanvasRenderer();\n\n        }else if (cam.renderer.toUpperCase() === 'WEBGL'){\n            self.renderer = new WebGLRenderer({ alpha: true, antialias: false });\n\n            // Simplify debugging\n            self.renderer.name = 'ViewCubeRenderer';\n        }else {\n            logger.warn(\"Incorrect use of Autocam.renderer property\");\n            self.renderer = new THREE.CanvasRenderer();\n        }\n\n        self.useTransparency(true);\n        self.setSize(self.width,self.height);\n\n        self.camera.topFov = self.camera.bottomFov = self.camera.fov/2;\n        self.camera.leftFov = self.camera.rightFov = (self.camera.aspect * self.camera.fov)/2;\n        // need to copy to camera templates - half of these statements do nothing, since the camera points at pcam or ocam, but simpler than an if statement.\n        self.pcam.topFov = self.ocam.topFov = self.camera.topFov;\n        self.pcam.bottomFov = self.ocam.bottomFov = self.camera.bottomFov;\n        self.pcam.leftFov = self.ocam.leftFov = self.camera.leftFov;\n        self.pcam.rightFov = self.ocam.rightFov = self.camera.rightFov;\n\n        // Auto clear needed because of multiple scenes\n        self.renderer.autoClear = false;\n        self.renderer.setSize(self.width, self.height);\n        self.renderer.sortObjects = false;\n        cubeContainer.appendChild(self.renderer.domElement);\n\n        // Initialize all event handlers\n        cubeContainer.addEventListener('touchstart', onDocumentMouseDown, false);\n        cubeContainer.addEventListener('mousedown', onDocumentMouseDown, false);\n        cubeContainer.addEventListener('mousemove', onDocumentMouseMove, false);\n\n/*\n        _havePointerLockFeature = 'pointerLockElement' in document ||\n                                  'mozPointerLockElement' in document ||\n                                  'webkitPointerLockElement' in document;\n*/\n        //Disabling this because it causes an intrusive browser pop-up asking\n        //whether I want to allow full screen mode to happen (huh?)\n        _havePointerLockFeature = false;\n\n        if(_havePointerLockFeature) {\n            var _document = self.getDocument();\n            _document.exitPointerLock = _document.exitPointerLock ||\n                                       _document.mozExitPointerLock ||\n                                       _document.webkitExitPointerLock;\n\n            cubeContainer.requestPointerLock = cubeContainer.requestPointerLock ||\n                                               cubeContainer.mozRequestPointerLock ||\n                                               cubeContainer.webkitRequestPointerLock;\n\n            // Hook pointer lock state change events\n            self.addDocumentEventListener('pointerlockchange', pointerLockChange, false);\n            self.addDocumentEventListener('mozpointerlockchange', pointerLockChange, false);\n            self.addDocumentEventListener('webkitpointerlockchange', pointerLockChange, false);\n        }\n\n        // Changing textures (blue highlighting for home and roll arrows)\n        changingTextures.push(loadTexture(getResourceUrl(resRoot + 'VChomeS.png')));\n        changingTextures.push(loadTexture(getResourceUrl(resRoot + 'VCarrowsS0.png')));\n        changingTextures.push(loadTexture(getResourceUrl(resRoot + 'VCarrowsS1.png')));\n        changingTextures.push(loadTexture(getResourceUrl(resRoot + 'VChome.png')));\n        changingTextures.push(loadTexture(getResourceUrl(resRoot + 'VCarrows.png')));\n        changingTextures.push(loadTexture(getResourceUrl(resRoot + 'VCcontext.png')));\n        changingTextures.push(loadTexture(getResourceUrl(resRoot + 'VCcontextS.png')));\n    };\n\n    /** Used to make cube visible again when using the transparency option   */\n    var mouseOverCube = function() {\n        if( cam.navApi.isActionEnabled('orbit') ) {\n            cubeContainer.style.opacity = \"1.0\";\n            _transparent = false;\n        }\n        requestAnimationFrame(self.render);\n    };\n\n    /** Used to fade in and out the cube when using the transparency option */\n    var mouseMoveOverCube = function(event) {\n        if (!_transparent && !cam.viewCubeMenuOpen && cam.navApi.isActionEnabled('orbit') ) {\n            var x = Math.max(Math.abs((event.clientX - position.x) / position.w - 0.5) * 4.0 - 1.0, 0);\n            var y = Math.max(Math.abs((event.clientY - position.y) / position.h - 0.5) * 4.0 - 1.0, 0);\n            var d = Math.max(0, Math.min(Math.sqrt(x*x + y*y), 1.0));\n            cubeContainer.style.opacity = 1.0 - d * (1.0 - self.inactiveOpacity);\n        }\n        else if( cam.navApi.isActionEnabled('orbit') ) {\n            cubeContainer.style.opacity = 1.0;\n        }\n    };\n\n    /** Used to make cube transparent when using the transparency option */\n    var mouseOutCube = function() {\n        if(cam.viewCubeMenuOpen){\n            return;\n        }\n        cubeContainer.style.opacity = self.inactiveOpacity;\n        _transparent = true;\n        requestAnimationFrame(self.render);\n    };\n\n\n    /** Takes in a image url and outputs a THREE.texture to be used\n     * by Three.js materials\n     * @param {string} url - path to the image you want to load as a texture\n     * @return {THREE.Texture}\n     */\n    var loadTexture = function(url) {\n        var image = new Image();\n        var _window = self.getWindow();\n        var useCredentials = endpoint.getUseCredentials() && (url.indexOf('://') === -1 || url.indexOf(_window.location.host) !== -1);\n        if (useCredentials) {\n            image.crossOrigin = \"use-credentials\";\n        } else {\n            image.crossOrigin = \"anonymous\";\n        }\n        var texture = new THREE.Texture(image);\n        image.onload = function() {\n            texture.needsUpdate = true;\n            loadedTextureCount++;\n            if(loadedTextureCount >= 11){\n                // all textures are now loaded\n                requestAnimationFrame(self.render);\n            }\n        };\n\n        image.src = url;\n        return texture;\n    };\n\n    /** Creates the click-able grid around the View Cube\n     *  by running functions to create Three.js meshes\n     */\n    var createCubeGrid = function () {\n        var currentGridLength;\n        var cubeCorners = [];\n        var cubeEdges = [];\n\n        cubeCorners[0] = buildCubeCorner(0, 0);\n        cubeCorners[1] = buildCubeCorner(0, Math.PI / 2);\n        cubeCorners[2] = buildCubeCorner(0, -Math.PI / 2);\n        cubeCorners[3] = buildCubeCorner(0, Math.PI);\n        cubeCorners[4] = buildCubeCorner(Math.PI / 2, 0);\n        cubeCorners[5] = buildCubeCorner(Math.PI / 2, Math.PI / 2);\n        cubeCorners[6] = buildCubeCorner(Math.PI / 2, -Math.PI / 2);\n        cubeCorners[7] = buildCubeCorner(Math.PI / 2, Math.PI);\n\n        cubeEdges[0] = buildCubeEdge(0, 0, 0);\n        cubeEdges[1] = buildCubeEdge(0, Math.PI / 2, 0);\n        cubeEdges[2] = buildCubeEdge(0, -Math.PI / 2, 0);\n        cubeEdges[3] = buildCubeEdge(0, Math.PI, 0);\n        cubeEdges[4] = buildCubeEdge(Math.PI / 2, 0, 0);\n        cubeEdges[5] = buildCubeEdge(Math.PI / 2, Math.PI / 2, 0);\n        cubeEdges[6] = buildCubeEdge(Math.PI / 2, -Math.PI / 2, 0);\n        cubeEdges[7] = buildCubeEdge(Math.PI / 2, Math.PI, 0);\n        cubeEdges[8] = buildCubeEdge(0, 0, Math.PI / 2);\n        cubeEdges[9] = buildCubeEdge(0, 0, -Math.PI / 2);\n        cubeEdges[10] = buildCubeEdge(-Math.PI / 2, 0, -Math.PI / 2);\n        cubeEdges[11] = buildCubeEdge(-Math.PI, 0, -Math.PI / 2);\n\n        // Draw the front square on the grid\n        gridMeshes.push(buildCubeFace(0, 0));\n        gridMeshes[0].name = 'front';\n        intersectsFace.push(gridMeshes[0]);\n        cubeBuffer.push(gridMeshes[0]);\n        gridScene.add(gridMeshes[0]);\n\n        // Draw the right square on the grid\n        gridMeshes.push(buildCubeFace(0, Math.PI / 2));\n        gridMeshes[1].name = 'right';\n        intersectsFace.push(gridMeshes[1]);\n        cubeBuffer.push(gridMeshes[1]);\n        gridScene.add(gridMeshes[1]);\n\n        // Draw the back square on the grid\n        gridMeshes.push(buildCubeFace(0, Math.PI));\n        gridMeshes[2].name = 'back';\n        intersectsFace.push(gridMeshes[2]);\n        cubeBuffer.push(gridMeshes[2]);\n        gridScene.add(gridMeshes[2]);\n\n        // Draw the left grid\n        gridMeshes.push(buildCubeFace(0, -Math.PI / 2));\n        gridMeshes[3].name = 'left';\n        intersectsFace.push(gridMeshes[3]);\n        cubeBuffer.push(gridMeshes[3]);\n        gridScene.add(gridMeshes[3]);\n\n        // Draw the bottom grid\n        gridMeshes.push(buildCubeFace(Math.PI / 2, 0));\n        gridMeshes[4].name = 'bottom';\n        intersectsFace.push(gridMeshes[4]);\n        cubeBuffer.push(gridMeshes[4]);\n        gridScene.add(gridMeshes[4]);\n\n        // Draw the top grid\n        gridMeshes.push(buildCubeFace(-Math.PI / 2, 0));\n        gridMeshes[5].name = 'top';\n        intersectsFace.push(gridMeshes[5]);\n        cubeBuffer.push(gridMeshes[5]);\n        gridScene.add(gridMeshes[5]);\n\n        currentGridLength = gridMeshes.length;\n\n        var i;\n        for (i = 0; i < cubeCorners.length; i++) {\n            gridMeshes.push(cubeCorners[i]);\n            gridMeshes[currentGridLength + i].name = cornerNames[i];\n            gridScene.add(gridMeshes[currentGridLength + i]);\n            intersectsFace.push(gridMeshes[currentGridLength + i]);\n            cubeBuffer.push(gridMeshes[currentGridLength + i]);\n        }\n\n        currentGridLength = gridMeshes.length;\n\n        for (i = 0; i < cubeEdges.length; i++) {\n            gridMeshes.push(cubeEdges[i]);\n            gridMeshes[currentGridLength + i].name = edgeNames[i];\n            gridScene.add(gridMeshes[currentGridLength + i]);\n            intersectsFace.push(gridMeshes[currentGridLength + i]);\n            cubeBuffer.push(gridMeshes[currentGridLength + i]);\n        }\n    };\n\n\n    /**\n     * Get intersections between a mesh and mouse position (mouse picking)\n     * @param {THREE.Vector3} pickingVector - direction vector to find intersections\n     * @param {THREE.Camera} camera\n     * @param {THREE.Mesh[]} intersectionBuffer - an array of three.js meshes to check for intersections with these specific meshes\n     * @return {Object[]} - objects which were intersected\n     */\n    var findPickingIntersects = function(pickingVector, camera, intersectionBuffer) {\n        var raycaster;\n\n        var direction = new THREE.Vector3();\n        if (camera.type === \"PerspectiveCamera\") {\n            direction.copy(pickingVector);\n            // retrieve point on view plane to shoot ray through\n            direction.unproject(camera);\n            // direction is target point minus position\n            raycaster = new THREE.Raycaster(camera.position, direction.sub(camera.position).normalize());\n        } else {\n            // orthographic\n            var target = new THREE.Vector3();\n            target.copy(pickingVector);\n            // retrieve point on view plane to shoot ray through\n            target.unproject(camera);\n\n            // direction is constant, from position to origin.\n            // direction is negative of position\n            direction.copy(camera.position).negate().normalize();\n            raycaster = new THREE.Raycaster(target, direction);\n        }\n\n        return raycaster.intersectObjects(intersectionBuffer);\n\n    };\n\n    var getPickVector = function(event, position) {\n        var x = event.clientX - position.x;\n        var y = event.clientY - position.y;\n\n        x = (x / position.w * 2.0) - 1.0;\n        y = ((position.h - y) / position.h * 2.0) - 1.0;\n\n        return new THREE.Vector3(x, y, 0.5);\n    };\n\n    /* never used\n    function isFullscreen() {\n        return document.fullscreenElement ||\n               document.webkitFullscreenElement ||\n               document.mozFullScreenElement ||\n               document.msFullscreenElement;\n    }\n    */\n\n    function getEventCoords(event, self) {\n        var coords = {};\n\n        if( event.type.indexOf(\"touch\") === 0 ) {\n            if( event.touches.length > 0 ) {\n                coords.clientX   = event.touches[0].clientX;\n                coords.clientY   = event.touches[0].clientY;\n                coords.pageX     = event.touches[0].pageX;\n                coords.pageY     = event.touches[0].pageY;\n                coords.screenX   = event.touches[0].screenX;\n                coords.screenY   = event.touches[0].screenY;\n                coords.movementX = coords.screenX - self.prevX;\n                coords.movementY = coords.screenY - self.prevY;\n                coords.which     = cam.navApi.getUseLeftHandedInput() ? 3 : 1;\n            }\n            else {\n                coords = self.prevCoords;\n            }\n        }\n        else {\n            coords.clientX   = event.clientX;\n            coords.clientY   = event.clientY;\n            coords.pageX     = event.pageX;\n            coords.pageY     = event.pageY;\n            coords.screenX   = event.screenX;\n            coords.screenY   = event.screenY;\n            coords.which     = event.which;\n\n            if ( _havePointerLockFeature ) {\n                coords.movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n                coords.movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n            }\n            else {\n                coords.movementX = coords.screenX - self.prevX;\n                coords.movementY = coords.screenY - self.prevY;\n            }\n        }\n        self.prevX = coords.screenX;\n        self.prevY = coords.screenY;\n        self.prevCoords = coords;\n\n        return coords;\n    }\n\n    /** All functionality regarding cube clicks starts here\n     *\n     * @param {Object} event - event when mouse down occurs\n     */\n    var onDocumentMouseDown = function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        if( !cam.navApi.isActionEnabled('orbit') )\n            return;\n\n        if (cam.currentlyAnimating) { return; }\n\n        var coords = getEventCoords(event, self);\n\n        // Make sure our position is up to date...\n        position = getPosition(cubeContainer);\n\n        cubeContainer.removeEventListener('mousemove', onDocumentMouseMove, false);\n        self.addDocumentEventListener('mouseup', onDocumentMouseUp, false);\n        self.addDocumentEventListener('touchend', onDocumentMouseUp, false);\n        // Not needed: document.addEventListener('mousemove', onDocumentMouseMove, false);\n\n        if( !cam.navApi.getUsePivotAlways() ) {\n            // If the usePivot option is not on, we pivot around the center of the view:\n            cam.pivot.copy(cam.center);\n            cam.navApi.setPivotPoint(cam.center);\n            // This also clears the pivot set flag:\n            cam.navApi.setPivotSetFlag(false);\n        }\n\n        cam.startInteraction(coords.pageX, coords.pageY);\n\n        // Since this mouse down is for dragging the cube we should not be able do this if the cube is animating already\n        var intersectsWithCube;\n        var pickingVector;\n\n        //If cube is first thing clicked, add the current shot to rewind history\n        //if (cam.rewindParams.history.length == 0) cam.addHistoryElement();\n\n        //If clicking cube from anywhere other then end of timeline update history accordingly\n        //if (!cam.rewindParams.snapped || cam.rewindParams.timelineIndex +1 != cam.rewindParams.history.length) cam.addIntermediateHistoryElement();\n\n        var rightMouse = cam.navApi.getUseLeftHandedInput() ? 1 : 3;\n        if (coords.which === rightMouse) // Right mouse click, handled on mouse up\n            return;\n\n        if(self.animSpeed <= 0){\n            logger.error(\"animSpeed cannot be 0 or less, use ViewCube.animate flag to turn on and off animation\", errorCodeString(ErrorCodes.VIEWER_INTERNAL_ERROR));\n            return;\n        }\n\n        // get mouse picking intersections\n        pickingVector = getPickVector(coords, position);\n        intersectsWithCube = findPickingIntersects(pickingVector, self.camera, cubeBuffer);\n\n\n        if (intersectsWithCube.length > 0) {\n\n            hideArrows();\n            if(self.draggable){\n                self.addDocumentEventListener('mousemove', onDocumentMouseMoveCube, false);\n                self.addDocumentEventListener('touchmove', onDocumentMouseMoveCube, false);\n\n                // Check if browser has pointer lock support\n                if ( _havePointerLockFeature ) {\n                    // Ask the browser to lock the pointer\n                    cubeContainer.requestPointerLock();\n\t\t\t\t\t_pointerLockMoveBugSPK865 = (_isChrome && _isWindows);\n                }\n            }\n        }\n    };\n\n    /** Used for dragging the cube,\n     * @param {Object} event - event when mouse move occurs (contains information about pointer position)\n     */\n    var onDocumentMouseMoveCube = function (event) {\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        // This is an error if user puts in self.animSpeed = 0 or less\n        if(self.animSpeed <= 0){\n            self.removeDocumentEventListener(\"mousemove\", onDocumentMouseMoveCube, false);\n            self.removeDocumentEventListener(\"touchmove\", onDocumentMouseMoveCube, false);\n            logger.error(\"animSpeed cannot be 0 or less\", errorCodeString(ErrorCodes.VIEWER_INTERNAL_ERROR));\n            return;\n        }\n\n        if(cam.currentlyAnimating) {\n\t\t\treturn;\n\t\t}\n        var coords = getEventCoords(event, self);\n\n        if ( _havePointerLockFeature ) {\n\t\t\t// We skip the first movement event after requesting pointer lock\n\t\t\t// because Chrome on Windows sends out a bogus motion value.\n\t\t\tif( _pointerLockMoveBugSPK865 ) {\n\t\t\t\t_pointerLockMoveBugSPK865 = false;\n\t\t\t\tcoords.movementX = coords.movementY = 0;\n\t\t\t}\n        }\n\n        if(_havePointerLock) {\n\n            // Ignore erroneous data sent from pointer lock\n            // not sure why erroneous data gets received\n            // could be bug in pointer lock\n            if(coords.movementX > 300 || coords.movementY > 300) {\n                coords.movementX = 0;\n                coords.movementY = 0;\n            }\n        }\n\n        // If the mouse hasn't moved ignore this current movement (not sure why the mouse move event gets called)\n        // Also used for ignoring erroneous data\n        if(coords.movementX === coords.movementY && coords.movementX === 0) {\n            cam.currentlyAnimating = false;\n            return;\n        }\n        _orthogonalView = false;\n        _dragged = true;\n        cam.showPivot(true);\n        cam.currentCursor = new THREE.Vector2(coords.pageX, coords.pageY);\n        cam.orbit(cam.currentCursor, cam.startCursor, new THREE.Vector3( - coords.movementX, coords.movementY, 0 ), cam.startState);\n\n        self.camera.lookAt(self.center);\n\n        requestAnimationFrame(self.render);\n    };\n\n\n    var endMouseUp = function (stillNeedUp) {\n        if( !stillNeedUp ) {\n            self.removeDocumentEventListener('mouseup', onDocumentMouseUp, false);\n            self.removeDocumentEventListener('touchend', onDocumentMouseUp, false);\n        }\n\n        self.removeDocumentEventListener('mousemove', onDocumentMouseMoveCube, false);\n        self.removeDocumentEventListener('touchmove', onDocumentMouseMoveCube, false);\n        cubeContainer.addEventListener('mousemove', onDocumentMouseMove, false);\n\n        if ( _havePointerLock ) {\n            var _document = self.getDocument();\n            _document.exitPointerLock();\n        }\n\n    };\n\n    this.registerOnViewTypeChangedCb = function(cb) {\n        if (cb instanceof Function) {\n            _onViewTypeChangedCb = cb;\n        }\n    };\n\n    this.setViewType = function(viewType) {\n        switch (viewType) {\n            case avp.VIEW_TYPES.ORTHOGRAPHIC:\n                // change cube appearance\n                self.camera = self.ocam;\n                break;\n            case avp.VIEW_TYPES.PERSPECTIVE:\n                // change cube appearance\n                self.camera = self.pcam;\n                break;\n            case avp.VIEW_TYPES.PERSPECTIVE_ORTHO_FACES:\n                self.camera = _orthogonalView ? self.ocam : self.pcam;\n                break;\n            default:\n                // This viewType is not supported.\n                // We do not want to call the view type callback here\n                return;\n        }\n        _onViewTypeChangedCb && _onViewTypeChangedCb(viewType);\n    };\n\n    /** Rotates the cube when a division of the cube grid is clicked,\n     * also provides functionality for home button interaction, orthogonal arrows interaction,\n     * and roll arrows interaction\n     * @param {Object} event - event contains information about mouse position which is used in this function\n     */\n    var onDocumentMouseUp = function (event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        var cubeIntersects;\n        var arrowIntersects;\n        var controlIntersects;\n\n        if (cam.currentlyAnimating || _dragged) {\n            cam.endInteraction();\n            cam.showPivot(false);\n            _dragged = false;\n\n            endMouseUp(false);\n            return;\n        }\n        var coords = getEventCoords(event, self);\n\n        if (cam.viewCubeMenuOpen) {\n            var x = coords.clientX - position.x;\n            var y = coords.clientY - position.y;\n\n            //if clicked on the menu\n            if ((cam.menuOrigin.x <= x) && (x <= (cam.menuOrigin.x + cam.menuSize.x)) &&\n                (cam.menuOrigin.y <= y) && (y <= (cam.menuOrigin.y + cam.menuSize.y))){\n\n                // HACK!!\n                // TODO: make this a bit more robust. It doesn't take the menu separators\n                // into account and makes a gross assumption about the menu entry size.\n                var menuItemNumber = Math.floor(((y-5) - cam.menuOrigin.y)/25);\n\n                var log = function(action) {\n                    logger.track({ name: 'navigation/' + action, aggregate: 'count' });\n                };\n\n                switch(menuItemNumber){\n                    case 0:                 //home\n                        log('home');\n                        cam.goHome();\n                        break;\n                    case 1:                 //orthographic\n                        log('setortho');\n                        break;\n                    case 2:                 //perspective\n                        log('setpersp');\n                        break;\n                    case 3:                 //perspective with ortho faces\n                        self.setViewType(menuItemNumber);\n                        break;\n                    case 4:                 //set current view as home\n                        log('sethome');\n                        cam.setCurrentViewAsHome(false);\n                        break;\n                    case 5:                 //focus and set current view as home\n                        log('focushome');\n                        cam.setCurrentViewAsHome(true);\n                        break;\n                    case 6:                 //reset home\n                        log('resethome');\n                        cam.resetHome();\n                        break;\n                    case 7:                 //set current view as front\n                        log('setfront');\n                        cam.setCurrentViewAsFront();\n                        break;\n                    case 8:                 //set current view as top\n                        log('settop');\n                        cam.setCurrentViewAsTop();\n                        break;\n                    case 9:                 //reset orientation\n                        cam.resetOrientation();\n                        break;\n                }\n            }\n\n            cam.viewCubeMenuOpen = false;\n            cam.removeDropdownMenu(cubeContainer);\n\n            //if clicked off the cube canvas\n            if( coords.clientX < position.x || coords.clientX > (position.w + position.x)\n             || coords.clientY < position.y || coords.clientY > (position.h + position.y)) {\n                mouseOutCube();\n            }\n\n            // In case something needs a highlight change:\n            if( self.mouseMoveSave )\n                self.processMouseMove(self.mouseMoveSave);\n\n            // LMV-1876 and LMV-1986 - re-enable hotkeys, essentially\n            cam.endInteraction();\n\n            // remove event listeners\n            endMouseUp(false);\n            return;\n        }\n        var rightMouse = cam.navApi.getUseLeftHandedInput() ? 1 : 3;\n        if (coords.which === rightMouse) {\n            cam.viewCubeMenuOpen=true;\n            cam.drawDropdownMenu(menuOptionList, menuEnableList, menuStateCallbackList, coords.clientX, coords.clientY, cubeContainer, position);\n            endMouseUp(true);\n            return;\n        }\n        var pickingVector = getPickVector(coords, position);\n        cubeIntersects    = findPickingIntersects(pickingVector, self.camera, cubeBuffer);\n        arrowIntersects   = findPickingIntersects(pickingVector, controlCamera, arrowBuffer);\n        controlIntersects = findPickingIntersects(pickingVector, controlCamera, controlBuffer);\n\n        // Apply logic for clicking on arrows\n        if (arrowIntersects.length > 0 && _orthogonalView) {\n\n            var FACES = [\"top\", \"bottom\", \"right\", \"left\", \"front\", \"back\"];\n\n            var FACE_MAPPING = {\n                front: {\n                    up:    [0, 1, 2, 3],\n                    right: [2, 3, 1, 0],\n                    down:  [1, 0, 3, 2],\n                    left:  [3, 2, 0, 1],\n                },\n                right: {\n                    up:    [0, 1, 5, 4],\n                    right: [5, 4, 1, 0],\n                    down:  [1, 0, 4, 5],\n                    left:  [4, 5, 0, 1],\n                },\n                left: {\n                    up:    [0, 1, 4, 5],\n                    right: [4, 5, 1, 0],\n                    down:  [1, 0, 5, 4],\n                    left:  [5, 4, 0, 1],\n                },\n                back: {\n                    up:    [0, 1, 3, 2],\n                    right: [3, 2, 1, 0],\n                    down:  [1, 0, 2, 3],\n                    left:  [2, 3, 0, 1],\n                },\n                top: {\n                    up:    [5, 4, 2, 3],\n                    right: [2, 3, 4, 5],\n                    down:  [4, 5, 3, 2],\n                    left:  [3, 2, 5, 4],\n                },\n                bottom: {\n                    up:    [4, 5, 2, 3],\n                    right: [2, 3, 5, 4],\n                    down:  [5, 4, 3, 2],\n                    left:  [3, 2, 4, 5],\n                }\n            };\n\n            var orientation = cam.getOrientation();\n            var order = FACE_MAPPING[self.currentFace][orientation];\n\n            var face;\n            for (var f=0; f<4; f++) {\n                if (arrowIntersects[0].object === arrowBuffer[f]) {\n                    face = FACES[order[f]];\n                    break;\n                }\n            }\n\n            cam.calculateCubeTransform(face);\n            self.currentFace = face;\n\n            cam.elapsedTime =0;\n            cam.sphericallyInterpolateTransition();\n        }\n\n        if (controlIntersects.length > 0) {\n            cam.elapsedTime = 0;\n\n            if (self.wantHomeButton && controlIntersects[0].object === controlBuffer[homeOffset]) {\n                cam.goHome();\n                endMouseUp(false);\n                return;\n            }\n            if (self.wantContextMenu && controlIntersects[0].object === controlBuffer[menuOffset]) {\n                cam.viewCubeMenuOpen=true;\n                cam.drawDropdownMenu(menuOptionList, menuEnableList, menuStateCallbackList, coords.clientX, coords.clientY, cubeContainer, position);\n                endMouseUp(true);\n                return;\n            }\n            if (self.wantRollArrows && _orthogonalView && (controlIntersects[0].object === controlBuffer[rollLeftOffset] || controlIntersects[0].object === controlBuffer[rollRightOffset])) {\n                //TODO: when panning, dir changes -> position\n                var clockwise = (controlIntersects[0].object === controlBuffer[rollRightOffset]);\n                var destination = {\n                    center: cam.center.clone(),\n                    position: camera.position.clone(),\n                    pivot: camera.pivot.clone(),\n                    fov: camera.fov,\n                    worldUp: cam.sceneUpDirection.clone(),\n                    isOrtho: (camera.isPerspective === false)\n                };\n                var dir = cam.center.clone().sub(camera.position).normalize();\n\n                if (clockwise){\n                    destination.up = camera.up.clone().cross(dir);\n                }else{\n                    destination.up = camera.up.clone().multiplyScalar(-1);\n                    destination.up.cross(dir);\n                }\n                destination.up.normalize();\n\n                cam.goToView(destination);\n            }\n        }\n        if (cubeIntersects.length > 0) {\n            let face = cubeIntersects[0].object.name;\n            self.mouseMoveSave = event;\n            self.cubeRotateTo(face);\n        }\n        endMouseUp(false);\n    };\n\n    this.cubeRotateTo = function(face) {\n        self.currentFace = face;\n\n        // If ortho faces is on and the target is not another face,\n        // switch to perspective mode:\n        if( cam.orthographicFaces && (self.currentFace.indexOf(',') !== -1) ) {\n            cam.setCameraOrtho(false);\n        }\n        cam.calculateCubeTransform(self.currentFace);\n\n        cam.elapsedTime =0;\n\n        // After interpolating to the new target we may have to simulate\n        // a mouse move event at the final location so that the appropriate\n        // part of the cube is highlighted:\n        cam.sphericallyInterpolateTransition(function(){\n            if( self.mouseMoveSave )\n                self.processMouseMove(self.mouseMoveSave);\n        });\n    };\n\n    /** Used to highlight cube grid divisions/arrows/home\n     * @param {Object} event - event contains information about mouse position which is used in this function\n     */\n    this.processMouseMove = function (event) {\n        var intersectsFaces;\n        var arrowIntersects;\n        var controlIntersects;\n\n        if (cam.viewCubeMenuOpen || cam.currentlyAnimating) {\n            self.mouseMoveSave = event;\n            return;\n        }\n        self.mouseMoveSave = null;\n\n        var coords = getEventCoords(event, self);\n\n        var pickingVector = getPickVector(coords, position);\n\n        intersectsFaces = findPickingIntersects(pickingVector, self.camera, intersectsFace);\n        arrowIntersects = findPickingIntersects(pickingVector, controlCamera, arrowBuffer);\n        controlIntersects = findPickingIntersects(pickingVector, controlCamera, controlBuffer);\n\n        /**********Highlight arrows when hovered over************/\n\n        if (INTERSECTED && !_dragged) {\n            INTERSECTED.material.color.setHex(COLOR_ARROW);\n            INTERSECTED = null;\n            requestAnimationFrame(self.render);\n        }\n\n        if (arrowIntersects.length > 0 && !_dragged) {\n                INTERSECTED = arrowIntersects[0].object;\n                for( var i=arrowGroup.children.length;  --i >= 0; ) {\n                    if (INTERSECTED === arrowBuffer[i]) {\n                        INTERSECTED = arrowGroup.children[i];\n                        INTERSECTED.material.color.setHex(0x00afff);\n                        break;\n                    }\n                }\n                requestAnimationFrame(self.render);\n        }\n\n        /**************Highlight faces on cube******************/\n\n        if (INTERSECTED_F && !_dragged) {\n            // Make the previously selected face opacity: 0.0\n                INTERSECTED_F.material.opacity = 0.0;\n                INTERSECTED_F = null;\n                requestAnimationFrame(self.render);\n        }\n\n        if (intersectsFaces.length > 0 && !_dragged) {\n            // Make the currently selected face opacity: 0.3\n                INTERSECTED_F = intersectsFaces[0].object;\n                INTERSECTED_F.material.opacity = 0.3;\n                requestAnimationFrame(self.render);\n        }\n\n        if (controlIntersects.length > 0 && !_dragged){\n            if(INTERSECTED_C !== controlIntersects[0].object){\n                // home mouse over\n                if(self.wantHomeButton && controlIntersects[0].object === controlBuffer[homeOffset]){\n                    INTERSECTED_C = controlIntersects[0].object;\n                    controlBuffer[homeOffset].material.map = changingTextures[0];\n                }\n\n                // Left roll arrow mouse over\n                else if(self.wantRollArrows && controlIntersects[0].object === controlBuffer[rollLeftOffset]){\n                    INTERSECTED_C = controlIntersects[0].object;\n                    controlBuffer[rollOffset].material.map = changingTextures[1];\n                }\n\n                // Right roll arrow mouse over\n                else if(self.wantRollArrows && controlIntersects[0].object === controlBuffer[rollRightOffset]) {\n                    INTERSECTED_C = controlIntersects[0].object;\n                    controlBuffer[rollOffset].material.map = changingTextures[2];\n                }\n\n                // Menu Icon\n                else if(self.wantContextMenu && controlIntersects[0].object === controlBuffer[menuOffset]){\n                    INTERSECTED_C = controlIntersects[0].object;\n                    controlBuffer[menuOffset].material.map = changingTextures[6];\n                }\n\n                else{\n                    // home mouse over\n                    if(self.wantHomeButton && INTERSECTED_C === controlBuffer[homeOffset]) {\n                        INTERSECTED_C = null;\n                        controlBuffer[homeOffset].material.map = changingTextures[3];\n                    }\n\n                    // Left roll and Right roll arrow\n                    else if(self.wantRollArrows && (INTERSECTED_C === controlBuffer[rollLeftOffset] ||\n                        INTERSECTED_C === controlBuffer[rollRightOffset] || INTERSECTED_C === controlBuffer[rollOffset])){\n                        INTERSECTED_C = null;\n                        controlBuffer[rollOffset].material.map = changingTextures[4];\n                    }\n\n                    // menu icon\n                    else if(self.wantContextMenu && INTERSECTED_C === controlBuffer[menuOffset]){\n                        INTERSECTED_C = null;\n                        controlBuffer[menuOffset].material.map = changingTextures[5];\n                    }\n                }\n                requestAnimationFrame(self.render);\n            }\n        }else if(INTERSECTED_C !== null && !_dragged){\n            // home mouse over\n            if(self.wantHomeButton && INTERSECTED_C === controlBuffer[homeOffset]) {\n                INTERSECTED_C = null;\n                controlBuffer[homeOffset].material.map = changingTextures[3];\n            }\n\n            // Left roll and Right roll arrow\n            else if(self.wantRollArrows && (INTERSECTED_C === controlBuffer[rollLeftOffset] ||\n                INTERSECTED_C === controlBuffer[rollRightOffset] || INTERSECTED_C === controlBuffer[rollOffset])){\n                INTERSECTED_C = null;\n                controlBuffer[rollOffset].material.map = changingTextures[4];\n            }\n\n            // menu icon\n            else if(self.wantContextMenu && INTERSECTED_C === controlBuffer[menuOffset]){\n                INTERSECTED_C = null;\n                controlBuffer[menuOffset].material.map = changingTextures[5];\n            }\n\n            requestAnimationFrame(self.render);\n        }\n    };\n\n    var onDocumentMouseMove = function (event) {\n        if( cam.navApi.isActionEnabled('orbit') )\n            self.processMouseMove(event);\n    };\n\n    /** Refreshes values so that renderer is correct size (in pixels) **/\n    var onWindowResize = function () {\n        position = getPosition(cubeContainer);\n\n        // cubeContainer.style.width = self.width.toString() + \"px\";\n        // cubeContainer.style.height = \"inherit\";\n\n        self.width  = cubeContainer.offsetWidth;\n        self.height = cubeContainer.offsetHeight;\n\n        //windowHalfX = self.width / 2;\n        //windowHalfY = self.height / 2;\n\n        //self.camera.aspect = self.width / self.height; - one of the two cameras has this aspect, so setting it there sets it here.\n        self.pcam.aspect = self.ocam.aspect = self.width / self.height;\n        //self.camera.updateProjectionMatrix(); - done by the two calls below:\n        self.pcam.updateProjectionMatrix();\n        self.ocam.updateProjectionMatrix();\n\n        // PHB added. See Autocam.js windowResize\n        self.camera.topFov = self.camera.bottomFov = self.camera.fov/2;\n        self.camera.leftFov = self.camera.rightFov = (self.camera.aspect * self.camera.fov)/2;\n        // need to copy to camera templates - half of these statements do nothing, since the camera points at pcam or ocam, but simpler than an if statement.\n        self.pcam.aspect = self.ocam.aspect = self.camera.aspect;\n        self.pcam.topFov = self.ocam.topFov = self.camera.topFov;\n        self.pcam.bottomFov = self.ocam.bottomFov = self.camera.bottomFov;\n        self.pcam.leftFov = self.ocam.leftFov = self.camera.leftFov;\n        self.pcam.rightFov = self.ocam.rightFov = self.camera.rightFov;\n\n        self.renderer.setSize(self.width, self.height);\n        requestAnimationFrame(self.render);\n    };\n\n    /** Builds one square mesh of the grid (located on each face of the cube)\n     *\n     * @param {Number} rotationX - rotate shape by this amount in X\n     * @param {Number} rotationY - rotate shape by this amount in Y\n     * @return {THREE.Mesh} - mesh of the cube face (square part) rotated by params\n     */\n    var buildCubeFace = function (rotationX, rotationY) {\n\n        // These sizes may be changed if cube size is changed\n        var material;\n        var edge = Math.floor(cubeSize * 0.45 / 2) || 45;\n        var square = Math.floor(cubeSize * 0.60 / 2) || 60;\n        var masterCubeSize = edge + square;\n\n        var geo = new THREE.Geometry();\n\n        // Center of the cube\n        var v0 = new THREE.Vector3(0, 0, 0);\n\n        /******************FRONT OF CUBE********************/\n        var v1 = new THREE.Vector3(square, -square, masterCubeSize);\n        var v2 = new THREE.Vector3(square, square, masterCubeSize);\n        var v3 = new THREE.Vector3(-square, square, masterCubeSize);\n        var v4 = new THREE.Vector3(-square, -square, masterCubeSize);\n\n        geo.vertices.push(v0);\n\n        geo.vertices.push(v1);\n        geo.vertices.push(v2);\n        geo.vertices.push(v3);\n        geo.vertices.push(v4);\n\n        /******************FRONT FACE********************/\n\n            // Front square\n        geo.faces.push(new THREE.Face3(1, 2, 3));\n        geo.faces.push(new THREE.Face3(1, 3, 4));\n\n\n        // Apply matrix rotations for sides which are not the front\n        geo.applyMatrix(new THREE.Matrix4().makeRotationX(rotationX));\n        geo.applyMatrix(new THREE.Matrix4().makeRotationY(rotationY));\n\n        geo.computeFaceNormals();\n        geo.computeVertexNormals();\n\n        material = new THREE.MeshBasicMaterial({ overdraw:true, opacity:0.0, color:0x00afff, transparent:true });\n        return new THREE.Mesh(geo, material);\n    };\n\n    /** Builds one edge mesh of the grid\n     *\n     * @param rotationX - rotate shape by this amount X\n     * @param rotationY - rotate shape by this amount Y\n     * @param rotationZ - rotate shape by this amount Z\n     * @return {THREE.Mesh} - mesh of the cube edge rotated by params\n     */\n    var buildCubeEdge = function (rotationX, rotationY, rotationZ) {\n        var material;\n        var edge = Math.floor(cubeSize * 0.45 / 2) || 45;\n        var square = Math.floor(cubeSize * 0.60 / 2) || 60;\n        var masterCubeSize = edge + square;\n        var meshReturn;\n\n        var geo = new THREE.Geometry();\n\n        var e0 = new THREE.Vector3(square, masterCubeSize, masterCubeSize);\n        var e1 = new THREE.Vector3(-square, masterCubeSize, masterCubeSize);\n        var e2 = new THREE.Vector3(-square, square, masterCubeSize);\n        var e3 = new THREE.Vector3(square, square, masterCubeSize);\n\n        var e4 = new THREE.Vector3(square, masterCubeSize, square);\n        var e5 = new THREE.Vector3(-square, masterCubeSize, square);\n        var e6 = new THREE.Vector3(-square, masterCubeSize, masterCubeSize);\n        var e7 = new THREE.Vector3(square, masterCubeSize, masterCubeSize);\n\n        geo.vertices.push(e0);\n        geo.vertices.push(e1);\n        geo.vertices.push(e2);\n        geo.vertices.push(e3);\n\n        geo.vertices.push(e4);\n        geo.vertices.push(e5);\n        geo.vertices.push(e6);\n        geo.vertices.push(e7);\n\n        geo.faces.push(new THREE.Face3(0, 1, 2));\n        geo.faces.push(new THREE.Face3(0, 2, 3));\n\n        geo.faces.push(new THREE.Face3(4, 5, 6));\n        geo.faces.push(new THREE.Face3(4, 6, 7));\n\n\n        geo.applyMatrix(new THREE.Matrix4().makeRotationX(rotationX));\n        geo.applyMatrix(new THREE.Matrix4().makeRotationY(rotationY));\n        geo.applyMatrix(new THREE.Matrix4().makeRotationZ(rotationZ));\n\n        geo.computeFaceNormals();\n        geo.computeVertexNormals();\n\n        material = new THREE.MeshBasicMaterial({ overdraw:true, opacity:0.0, color:0x00afff, transparent:true });\n        meshReturn = new THREE.Mesh(geo, material);\n        return meshReturn;\n    };\n\n    /** Builds one corner mesh of the grid\n     *\n     * @param {Number} rotationX - rotate shape by this amount in X\n     * @param {Number} rotationY - rotate shape by this amount in Y\n     * @return {THREE.Mesh} - the cube corner mesh rotated by params\n     */\n    var buildCubeCorner = function (rotationX, rotationY) {\n        var material;\n        var edge = Math.floor(cubeSize * 0.45 / 2) || 45;\n        var square = Math.floor(cubeSize * 0.60 / 2) || 60;\n        var masterCubeSize = edge + square;\n        var meshReturn;\n\n        var geo = new THREE.Geometry();\n\n        var c0 = new THREE.Vector3(masterCubeSize, masterCubeSize, masterCubeSize);\n        var c1 = new THREE.Vector3(square, masterCubeSize, masterCubeSize);\n        var c2 = new THREE.Vector3(square, square, masterCubeSize);\n        var c3 = new THREE.Vector3(masterCubeSize, square, masterCubeSize);\n\n        var c4 = new THREE.Vector3(masterCubeSize, masterCubeSize, square);\n        var c5 = new THREE.Vector3(masterCubeSize, masterCubeSize, masterCubeSize);\n        var c6 = new THREE.Vector3(masterCubeSize, square, masterCubeSize);\n        var c7 = new THREE.Vector3(masterCubeSize, square, square);\n\n        var c8 = new THREE.Vector3(masterCubeSize, masterCubeSize, masterCubeSize);\n        var c9 = new THREE.Vector3(masterCubeSize, masterCubeSize, square);\n        var c10 = new THREE.Vector3(square, masterCubeSize, square);\n        var c11 = new THREE.Vector3(square, masterCubeSize, masterCubeSize);\n\n        geo.vertices.push(c0);\n        geo.vertices.push(c1);\n        geo.vertices.push(c2);\n        geo.vertices.push(c3);\n\n        geo.vertices.push(c4);\n        geo.vertices.push(c5);\n        geo.vertices.push(c6);\n        geo.vertices.push(c7);\n\n        geo.vertices.push(c8);\n        geo.vertices.push(c9);\n        geo.vertices.push(c10);\n        geo.vertices.push(c11);\n\n        geo.faces.push(new THREE.Face3(0, 1, 2));\n        geo.faces.push(new THREE.Face3(0, 2, 3));\n\n        geo.faces.push(new THREE.Face3(4, 5, 6));\n        geo.faces.push(new THREE.Face3(4, 6, 7));\n\n        geo.faces.push(new THREE.Face3(8, 9, 10));\n        geo.faces.push(new THREE.Face3(8, 10, 11));\n\n\n        geo.applyMatrix(new THREE.Matrix4().makeRotationX(rotationX));\n        geo.applyMatrix(new THREE.Matrix4().makeRotationY(rotationY));\n\n        geo.computeFaceNormals();\n        geo.computeVertexNormals();\n\n        material = new THREE.MeshBasicMaterial({ overdraw:true, opacity:0.0, color:0x00afff, transparent:true });\n        meshReturn = new THREE.Mesh(geo, material);\n        return meshReturn;\n    };\n\n    var changeBasisWorldToStandard = function (V) {\n        var worldD = cam.cubeFront.clone();\n        var worldU = cam.sceneUpDirection.clone();\n        var worldR = worldD.clone().cross(worldU);\n        worldU.copy(worldR).cross(worldD);\n\n        worldD.normalize();\n        worldU.normalize();\n        worldR.normalize();\n\n        var answer = new THREE.Vector3(worldD.x,worldU.x,worldR.x).multiplyScalar(V.x);\n        answer.add(new THREE.Vector3(worldD.y,worldU.y,worldR.y).multiplyScalar(V.y));\n        answer.add(new THREE.Vector3(worldD.z,worldU.z,worldR.z).multiplyScalar(V.z));\n\n        return answer;\n    };\n\n    /** Render the View Cube scenes and perform checks for control visibility **/\n    this.render = function () {\n        // switch view cube to match whatever camera.isPerspective says to use.\n        self.camera = camera.isPerspective ? self.pcam : self.ocam;\n\n        var scale = self.compass ? self.viewScaleFactorCompass * self.viewScale : self.viewScale;\n        var viewDir = cam.center.clone().sub(camera.position).normalize();\n        var upDir   = camera.up.normalize();\n        var spriteRotationMatrix = new THREE.Matrix4();\n\n        viewDir = changeBasisWorldToStandard(viewDir);\n        upDir   = changeBasisWorldToStandard(upDir);\n\n        self.camera.position.copy(viewDir);\n        self.camera.position.multiplyScalar(-scale / self.camera.position.length());\n        self.camera.up = upDir.normalize();\n        self.camera.lookAt(self.center);\n\n        checkControlVisibility();\n\n        // Only render triad if enabled and up/front are axis aligned. Otherwise it looks weird\n        var renderTriad = self.renderTriad &&\n          isAxisAlignedUnit(cam.sceneUpDirection) &&\n          isAxisAlignedUnit(cam.sceneFrontDirection);\n\n        var renderer = self.renderer;\n        if (renderer) {\n            // Orient any sprites to face the camera\n            for (var i = 0; i < sprites.length; i++) {\n              spriteRotationMatrix.lookAt(self.camera.position, sprites[i].position, self.camera.up);\n              sprites[i].setRotationFromMatrix(spriteRotationMatrix);\n            }\n\n            renderer.clear();\n            // There are 3 scenes: the first is the shadow, then the cube with textures, then the grid is on top\n            renderer.render(shadowScene, self.camera);\n            renderer.render(cubeScene, self.camera);\n            renderer.render(lineScene, self.camera);\n\n            if (renderTriad) {\n              // Reorient in case up/front changed. Weirdly the scene front direction is backwards so we have to\n              // multiply by -1\n              triad.orient(cam.sceneUpDirection, cam.sceneFrontDirection.clone().multiplyScalar(-1));\n              renderer.render(triad.triadScene, self.camera);\n              renderer.render(triad.triadLabelScene, self.camera);\n            }\n            renderer.render(gridScene, self.camera);\n            // render the compass after the cube. If we do it before, the cube will be hidden\n            if (self.renderCompass) {\n                renderer.render(compassScene, self.camera); \n            }\n\n            // Different camera since these shouldn't move with the View Cube\n            renderer.render(controlScene, controlCamera);\n        }\n    };\n\n    /**\n     * Returns a promise that resolves with an image/png Blob.\n     *\n     * @returns {Promise}\n     */\n    this.getScreenShot = function(options) {\n        return new Promise(function(resolve, reject){\n\n            var renderer = self.renderer;\n            if (!renderer)\n                return reject('No renderer');\n\n            // Add background\n            var _document = self.getDocument();\n            var canvas = _document.createElement('canvas');\n            canvas.width = self.width;\n            canvas.height = self.height;\n            var ctx = canvas.getContext('2d');\n            ctx.fillStyle = '#FFFFFF';\n            ctx.fillRect(0, 0, self.width, self.height);\n\n            renderer.domElement.toBlob(onViewCubeBlob, 'image/png');\n\n            function onViewCubeBlob(vcBlob) {\n                var img = new Image();\n                var _window = self.getWindow();\n                img.src = _window.URL.createObjectURL(vcBlob);\n                img.onload = () => {\n                    ctx.drawImage(img, 0, 0, self.width, self.height);\n                    _window.URL.revokeObjectURL(img.src);\n                    canvas.toBlob((blob) => { resolve(blob); }, 'image/png');\n                };\n            }\n        });\n    };\n\n    /**\n     * checks whether arrows (orthogonal and roll), drop down menus, and home button should be visible or not at\n     * this current time\n     */\n    var checkControlVisibility = function(){\n        // Arrow Visibility\n\n        _orthogonalView = cam.isFaceView();\n\n        (_orthogonalView && !_transparent && !cam.currentlyAnimating) ? showArrows() : hideArrows();\n\n        // Menu Visibility\n        _transparent ? hideContext() : showContext();\n\n        // Home Visibility\n        _transparent ? hideHome() : showHome();\n    };\n\n    /** Hide View Cube Arrows **/\n    var hideArrows = function() {\n        controlScene.remove(arrowGroup);\n\n        controlBuffer[rollOffset].material.opacity = 0.0;\n        controlBuffer[menuOffset].material.opacity = 0.0;\n    };\n\n    /** Show View Cube Arrows **/\n    var showArrows = function() {\n        controlScene.add(arrowGroup);\n\n        var opacity = self.wantRollArrows ? 1.0 : 0.0;\n        controlBuffer[rollOffset].material.opacity = opacity;\n        controlBuffer[menuOffset].material.opacity = opacity;\n    };\n\n    /** Hide the view cube menu button **/\n    var hideContext = function() {\n        context.material.opacity = (isMobileDevice()) ? 1.0 : 0.0;\n    };\n\n    /** Show the view cube menu button **/\n    var showContext = function() {\n        context.material.opacity = self.wantContextMenu ? 1.0 : 0.0;\n    };\n\n    /** Hide the home button **/\n    var hideHome = function() {\n        home.material.opacity = 0.0;\n    };\n\n    /** Show the home button **/\n    var showHome = function() {\n        home.material.opacity = self.wantHomeButton ? 1.0 : 0.0;\n    };\n\n    /* Public Methods */\n    /** Update the View Cube camera to a new camera view\n     * @public\n     * @this ViewCube\n     * @param {int[]} eye - client provided camera position (in their world coordinates)\n     * @param {int[]} centre - client provided pivot point or centre (where the camera is looking at in their world coordinates)\n     * @param {int[]} upVector - client provided up vector\n     */\n\n    /** Refresh height and width renderer sizes\n     * @public\n     * @this ViewCube\n     */\n    this.refreshCube = function () {\n        onWindowResize();\n    };\n\n    /** Set the size of the View Cube\n     * @public\n     * @this ViewCube\n     * @param {int} width - in pixels\n     * @param {int} height - in pixels\n     */\n    this.setSize = function (width, height) {\n        self.width = width;\n        self.height = height;\n\n        if(cubeContainer.children.length > 1){\n            for(var i = 1; i < cubeContainer.children.length; i++)\n                cubeContainer.children[i].style.bottom = (self.height/5).toString() + \"px\";\n        }\n\n        onWindowResize();\n    };\n\n    /** Option to turn on and off transparency on mouse out for the view cube\n     * @public\n     * @this ViewCube\n     * @param {boolean} transparent - true to use transparency, false to turn it off\n     */\n    this.useTransparency = function (transparent){\n        _transparent = transparent;\n        if(transparent) {\n            cubeContainer.onmouseover = mouseOverCube;\n            cubeContainer.onmousemove = mouseMoveOverCube;\n            cubeContainer.onmouseout = mouseOutCube;\n            mouseOutCube();\n        }\n        else {\n            cubeContainer.onmouseover = null;\n            cubeContainer.onmouseout = null;\n            cubeContainer.onmousemove = null;\n            cubeContainer.style.opacity = \"1.0\";\n        }\n    };\n\n    this.showTriad = function (show) {\n      if (show !== self.renderTriad) {\n        self.renderTriad = show;\n        requestAnimationFrame(self.render);\n      }\n    };\n\n    this.showCompass = function(show = true) {\n        this.initCompass();\n        \n\n        if (self.renderCompass !== show) {\n            self.prevRenderCompass = self.renderCompass; // prevRenderCompass is used for \"Reset Orientation\" option\n            self.renderCompass = show;\n            // Move the controls to right positions\n            setControlsPositions();\n            requestAnimationFrame(self.render);\n        }\n    };\n\n    // North angle is the angle to viewcube's back face normal vector\n    this.setCompassRotation = function (newNorthAngle = 0) {\n        this.initCompass();\n\n        const toRotate = newNorthAngle - self.northAngle;\n\n        if (toRotate === 0) {\n            return; \n        }\n\n        self.northAngle = newNorthAngle;\n\n        // rotate about world Y which is the same as object Z\n        self.compassPointerMeshUp.rotateZ(toRotate);\n        self.compassPointerMeshDown.rotateZ(toRotate);\n        \n        requestAnimationFrame(self.render);\n    };\n\n    this.initCompass = function () {\n        if (self.hasCompass) {\n            return; // already initialized\n        }\n\n        self.hasCompass = true;\n        self.northAngle = 0; // Angle of north in radians wrt front\n\n        let resRoot = 'res/textures/';\n        let getResourceUrl = Autodesk.Viewing.Private.getResourceUrl;\n        // create the mesh for compass and add it to compass scene\n        compassScene = new THREE.Scene();\n\n        // geometry and material\n        const planeSize = cubeSize * 2.9;\n        let compassGeom = new THREE.PlaneBufferGeometry(planeSize, planeSize, 2, 2);\n        let compassPointerMaterial = new THREE.MeshBasicMaterial({ color:0x000000,  side: THREE.DoubleSide, map: loadTexture(getResourceUrl(resRoot + 'VCcompass-pointer-b.png')), shading: THREE.FlatShading, transparent: true});\n        let compassBaseMaterial = new THREE.MeshBasicMaterial({ color:0x000000,  side: THREE.DoubleSide, map: loadTexture(getResourceUrl(resRoot + 'VCcompass-base.png')), shading: THREE.FlatShading, transparent: true});\n\n        // mesh\n        // We create two meshes for the pointer one on each side of the base mesh, because it causes flicker with transparency set\n        const compassPointerMeshUp = new THREE.Mesh(compassGeom, compassPointerMaterial);\n        const compassPointerMeshDown = new THREE.Mesh(compassGeom, compassPointerMaterial);\n        const compassBaseMesh = new THREE.Mesh(compassGeom, compassBaseMaterial);\n        self.compassPointerMeshUp = compassPointerMeshUp; \n        self.compassPointerMeshDown = compassPointerMeshDown; \n        \n        const xRot = - Math.PI / 2;\n        compassBaseMesh.rotateX(xRot);\n        compassPointerMeshUp.rotateX(xRot);\n        compassPointerMeshDown.rotateX(xRot);\n\n        // Translate by world Y, which is object's Z after the rotation above\n        const yTran = -cubeSize * 0.5 - (Math.floor(cubeSize * 0.25 / 2) || 25);\n        compassBaseMesh.translateZ(yTran);\n        compassPointerMeshUp.translateZ(yTran + 0.1);\n        compassPointerMeshDown.translateZ(yTran - 0.1);\n\n        compassScene.add(compassBaseMesh);\n        compassScene.add(compassPointerMeshUp);\n        compassScene.add(compassPointerMeshDown);\n        \n        requestAnimationFrame(self.render);\n    };\n\n    /**\n     * Emulates a mouseOver event (when `show=true`) to display the context menu\n     * affordance and make the viewcube render fully opaque. Invoking the method with \n     * `show=false` will emulate a mouseOut event, hiding the context menu affordance\n     * and making the cube transparent.\n     *\n     * @param {boolean} show - true to emulate a mouseOver event, false to emulate a mouseOut event.\n     */\n    this.showControls = function(show) {\n        if (show || show === undefined)\n          mouseOverCube();\n        else\n          mouseOutCube();\n    };\n\n    this.dtor = function() {\n        this.renderer = null;\n        _onViewTypeChangedCb = null;\n    };\n\n    this.refreshTexture = function(onTextureReady) {\n\n        // The face names texture is localized:\n        // Load in the faceMap textures for 6 faces\n        var getResourceUrl = Autodesk.Viewing.Private.getResourceUrl;\n        var locTexPath = this.localizeResourcePath || 'res/textures/';\n\n        var texture = new DDSLoader().load(getResourceUrl(locTexPath + 'VCcrossRGBA8small.dds'), onTextureReady);\n        texture.minFilter = texture.maxFilter = THREE.LinearFilter;\n        \n        this.texture && this.texture.dispose();\n        this.texture = texture;\n\n        var material = this.material;\n        if (!material) {\n            var shader = THREE.ShaderLib[ \"cube\" ];\n            material = createShaderMaterial(shader);\n            material.depthWrite = false;\n            this.material = material;\n        }\n\n        material.uniforms[ \"tCube\" ].value = texture;\n        return material;\n    };\n\n    this.localize = function() {\n        const global = getGlobal();\n        this.localizeResourcePath = global.LOCALIZATION_REL_PATH;\n        this.refreshTexture( ()=>{\n            // Must delay a frame for the case when the texture is cached by the browser.\n            requestAnimationFrame(this.render);\n        });\n    };\n\n    /* Build the cube */\n    Init();\n}\n\navp.ViewCube = ViewCube;","'use strict';\n\nimport { ViewCube } from './ViewCube';\nimport './ViewCubeUi.css';\n\nconst av = Autodesk.Viewing;\nconst avp = Autodesk.Viewing.Private;\nconst global = av.getGlobal();\n\n\n/**\n * Create the UI for the view cube.\n * \n * The extension id is: `Autodesk.ViewCubeUi`\n * \n * @example\n *    viewer.loadExtension('Autodesk.ViewCubeUi');\n * \n * @see {@link Autodesk.Viewing.Extension} for common inherited methods.\n * @memberof Autodesk.Viewing.Extensions\n * @alias Autodesk.Viewing.Extensions.ViewCubeUi\n * @class\n * @param {Autodesk.Viewing.Viewer3D} viewer - Viewer instance.\n * @param {object} options - Not used.\n */\nexport function ViewCubeUi(viewer, options) {\n    av.Extension.call(this, viewer, options);\n    // Keep the constructor LEAN\n    // The actual initialization happens in create()\n    this.container = null;\n    this.cube = null; // Autocam.ViewCube\n    this.viewcube = null;\n    this.homeViewContainer = null;\n    this._created = false;\n    this._initTriadVisibility = false;\n    this.refreshCube = this.refreshCube.bind(this);\n    this.displayViewCube = this.displayViewCube.bind(this);\n    this.setViewType = this.setViewType.bind(this);\n    this._updateView = this._updateView.bind(this);\n    this._onModelAdded = this._onModelAdded.bind(this);\n}\n\nViewCubeUi.prototype = Object.create(Autodesk.Viewing.Extension.prototype);\nViewCubeUi.prototype.constructor = ViewCubeUi;\n\nObject.assign(ViewCubeUi.prototype, {\n    /**\n     * @private\n     */\n    load: function() {\n        this.create();\n\n        this._displayViewCube(this.viewer.impl.is2d);\n\n        this.localize();\n\n        // Dispatch a view cube created event\n        this.viewer.dispatchEvent({type: av.VIEW_CUBE_CREATED_EVENT});\n\n        // Refresh the cube when resizing\n        this.viewer.addEventListener(av.VIEWER_RESIZE_EVENT, this.refreshCube);\n        \n        // Register the displayViewCube function as the callback for the viewCube preference.\n        this.viewer.prefs.addListeners(avp.Prefs3D.VIEW_CUBE, this.displayViewCube);\n\n        // Change the view when the VIEW_TYPE preference is set.\n        this.viewer.prefs.addListeners(avp.Prefs3D.VIEW_TYPE, this.setViewType);\n\n        if (this.viewer.model) {\n            // Add first model according to the current mode (2D or 3D)\n            const models = this.viewer.getVisibleModels().filter(model => !!this.viewer.impl.is2d === model.is2d());\n            this._onModelAdded({ model: models[0] });\n        }\n\n        // Register an event handler to update the view cube (not just once for model unloading/loading use cases)\n        this.viewer.addEventListener(av.MODEL_ADDED_EVENT, this._onModelAdded);\n\n        // This needs to be called to ensure that the preference callback is called.\n        // By the time the viewer.setProfile function is called in the viewer (which will set the preferences), this extension is not loaded.\n        this._setDefaultView();\n\n        return true;\n    },\n\n    /**\n     * Destroy the view cube.\n     *\n     * @private\n     */\n    unload: function() {\n        this.viewer.prefs.removeListeners(avp.Prefs3D.VIEW_CUBE, this.displayViewCube);\n        this.viewer.prefs.removeListeners(avp.Prefs3D.VIEW_TYPE, this.setViewType);\n        this.viewer.removeEventListener(av.VIEWER_RESIZE_EVENT, this.refreshCube);\n        this.viewer.removeEventListener(av.MODEL_ADDED_EVENT, this._onModelAdded);\n\n        if (this.container) {\n            this.viewer.container.removeChild(this.container);\n            this.viewcube = null;\n        }\n\n        if (this.cube) {\n            this.cube.dtor();\n            this.cube = null;\n        }\n\n        this.homeViewContainer = null;\n        this.hideHomeViewMenu = null;\n        this.viewer = null;\n        return true;\n    },\n\n    /**\n     * Initialize the view cube and the home button.\n     * This method is called when the extension is loaded.\n     */\n    create: function() {\n        if (this._created)\n            return;\n        this.initContainer();\n        this.initHomeButton();\n        this._created = true;\n    },\n\n    /**\n     * @private\n     */\n    initContainer: function() {\n        var _document = this.getDocument();\n        this.container = _document.createElement('div');\n        this.container.className = \"viewcubeWrapper\";\n        this.viewer.container.appendChild(this.container);\n    },\n\n    /**\n     * @private\n     */\n    initHomeButton: function () {\n        if (this.homeViewContainer) {\n            return;\n        }\n\n        var _document = this.getDocument();\n        var homeViewContainer = _document.createElement('div');\n        homeViewContainer.className = \"homeViewWrapper\";\n\n        this.container.appendChild(homeViewContainer);\n        this.homeViewContainer = homeViewContainer;\n\n        var self = this;\n        homeViewContainer.addEventListener(\"click\", function() {\n            self.viewer.navigation.setRequestHomeView(true);\n        });\n    },\n\n    /**\n     * Show or hide the view cube element. This also applies to the home button.\n     *\n     * @param {boolean} show - If set to false, the view cube and the home button will become invisible.\n     * @alias Autodesk.Viewing.Extensions.ViewCubeUi#setVisible\n     */\n    setVisible: function (show) {\n        this.container.style.display = show ? 'block' : 'none';\n    },\n\n    /**\n     * Update the VIEW_TYPE preference's default value.\n     *\n     * @private\n     */\n    _setDefaultView: function() {\n        if (this.viewer.impl.is2d) return;\n\n        if (this.viewer.impl.getModelCamera(this.viewer.model)) {\n            return;\n        }\n\n        this.viewer.prefs.dispatchEvent(avp.Prefs3D.VIEW_TYPE);\n    },\n\n    /**\n     * Set the viewType for the VIEW_TYPE preference\n     *\n     * @param {number} viewType - view index. \n     * @private\n     */\n    _updateView: function(viewType) {\n        if (this.viewer.impl.is2d) return;\n\n        if (!this.viewer.prefs.set(avp.Prefs3D.VIEW_TYPE, viewType)) {\n            // If the value was not changed, check with autocam as well, in case it was changed programmatically\n            const autocamViewType = this.viewer.autocam.getViewType();\n            if (viewType !== autocamViewType) {\n                this.viewer.prefs.dispatchEvent(avp.Prefs3D.VIEW_TYPE);\n            }\n        }\n    },\n\n    /**\n     * Set the viewCube view type. \n     *\n     * @param {string} viewType - 1 for orthographic, 2 for perspective, 3 for orthoFaces\n     */\n    setViewType: function(viewType) {\n        if (this.viewer.impl.is2d || !this.cube) return;\n        this.cube.setViewType(viewType);\n    },\n\n    /**\n     * Show the x,y,z axes of the view cube.\n     *\n     * @param {boolean} show - if set to true, the view cube axes will be shown.\n     * @alias Autodesk.Viewing.Extensions.ViewCubeUi#showTriad\n     */\n    showTriad: function (show) {\n        if (this.cube)\n            this.cube.showTriad(show);\n        else \n            this._initTriadVisibility = show;\n    },\n\n    /**\n     * Set the face of ViewCube and apply camera transformation according to it.\n     *\n     * @param {string} face - The face name of ViewCube. The name can contain multiple face names,\n     * the format should be `\"[front/back], [top/bottom], [left/right]\"`.\n     *\n     * @example\n     *    viewer.setViewCube('front top right');\n     *    viewer.setViewCube('bottom left');\n     *    viewer.setViewCube('back');\n     * \n     * @alias Autodesk.Viewing.Extensions.ViewCubeUi#setViewCube\n     */\n    setViewCube: function(face) {\n        if (this.cube) {\n            this.cube.cubeRotateTo(face);\n        }\n    },\n\n    /**\n     * Hides the Home button next to the ViewCube.\n     *\n     * @param {boolean} show\n     * @alias Autodesk.Viewing.Extensions.ViewCubeUi#displayHomeButton\n     */\n    displayHomeButton: function(show) {   // show/hide home button.\n        if(this.homeViewContainer)\n            this.homeViewContainer.style.display = show ? '' : 'none';\n    },\n\n    /**\n     * Display the view cube. This will not effect the home button.\n     *\n     * @param {boolean} display - if set to false the view cube element will be invisible\n     * @param {boolean} updatePrefs - update the view cube preference\n     * @alias Autodesk.Viewing.Extensions.ViewCubeUi#displayViewCube\n     */\n    displayViewCube: function (display, updatePrefs) {\n        if (updatePrefs)\n            this.viewer.prefs.set(avp.Prefs3D.VIEW_CUBE, display);\n\n        if (display && !this.cube && !this.viewer.impl.is2d) {\n            var _document = this.getDocument();\n            this.viewcube = _document.createElement(\"div\");\n            this.viewcube.className = \"viewcube\";\n            this.container.appendChild(this.viewcube);\n            this.cube = new ViewCube(\"cube\", this.viewer.autocam, this.viewcube, global.LOCALIZATION_REL_PATH);\n            this.cube.registerOnViewTypeChangedCb(this._updateView);\n            this.cube.setGlobalManager(this.globalManager);\n\n            // Move sibling on top of the viewcube.\n            this.container.appendChild(this.homeViewContainer);\n\n            if (this._initTriadVisibility) {\n                this.showTriad(true);\n            }\n            delete this._initTriadVisibility;\n        }\n        else if (!this.cube) {\n            this._positionHomeButton();\n            return; //view cube is not existent and we want it off? Just do nothing.\n        }\n\n        this.viewcube.style.display = (display ? \"block\" : \"none\");\n\n        this._positionHomeButton();\n\n        if( display ) {\n            this.viewer.autocam.refresh();\n        }\n    },\n\n    /**\n     * Localize the view cube\n     *\n     * @alias Autodesk.Viewing.Extensions.ViewCubeUi#localize\n     */\n    localize: function() {\n        this.cube && this.cube.localize();\n    },\n\n    /**\n     * @param {boolean} [show=true] show the compass\n     */\n    showCompass: function (show = true) {\n        this.cube && this.cube.showCompass(show);\n    },\n\n    /**\n     * \n     * @param {number} [radians=0] // Angle of north in radians wrt front\n     */\n    setCompassRotation: function (radians = 0) {\n        this.cube && this.cube.setCompassRotation(radians);\n    },\n\n    /**\n     * @param model\n     * @private\n     */\n    _initCompass: function (model) {\n    \n        // calculate the north orientation angle\n        const data = model && model.getData();\n        const metadata = data && data.metadata;\n        let projectNorthVector = metadata && metadata['world north vector'];\n        projectNorthVector = projectNorthVector && projectNorthVector.XYZ;\n        projectNorthVector = projectNorthVector && new THREE.Vector3(projectNorthVector[0], projectNorthVector[1], projectNorthVector[2]);\n\n        // Skip initialization if the model doesn't have the north vector\n        if (!projectNorthVector) {\n            return;\n        }\n\n        // Calculate the N orientation\n        \n        //       Front Direction (usually same as project or world north)\n        //             ^    \n        //             | \n        //             |\n        //  left <---- o  ----> Right\n        //           /    \n        //          /  \n        //         /   \n        //True North   \n\n        // frontDirection is the direction looking into the front face of the cube\n        const frontDirection = this.viewer.autocam.sceneFrontDirection.clone();\n        const upVector = this.viewer.autocam.sceneUpDirection.clone();\n        let cross = new THREE.Vector3();\n        cross.crossVectors(frontDirection, projectNorthVector);\n        const projectNorthAngle = projectNorthVector.angleTo(frontDirection) * (cross.dot(upVector) < 0 ? -1 : 1);\n        const customValues = metadata['custom values'];\n        let trueNorthAngle = (customValues && customValues.angleToTrueNorth) || 0;\n        trueNorthAngle = trueNorthAngle * (Math.PI / 180);\n\n        // Project North + True North will give us the final angle to point the north\n        // Do not rotate the compass in aggregated view which sets applyRefPoint\n        const radians = data?.loadOptions?.applyRefPoint ? 0 : projectNorthAngle + trueNorthAngle;\n        this.cube.initCompass();\n        this.setCompassRotation(radians);\n\n        // Only show compass if preference is set\n        this.showCompass(!!this.viewer.prefs.get(avp.Prefs3D.VIEW_CUBE_COMPASS));\n    },\n\n    /**\n     * @param is2d\n     * @private\n     */\n    _displayViewCube: function(is2d) {\n        // Do not display the ViewCube for 2d models\n        const display = is2d ? false : this.viewer.prefs.get(avp.Prefs3D.VIEW_CUBE);\n        this.displayViewCube(display);\n    },\n\n    /**\n     * @param event\n     * @private\n     */\n    _onModelAdded: function(event) {\n        // As soon as we enter 2D mode, hide the viewcube\n        this._displayViewCube(this.viewer.impl.is2d);\n\n        if (this.cube && !this.cube.hasCompass && !this.viewer.impl.is2d) {\n            this._initCompass(event.model);\n        }\n    },\n\n    /**\n     * @private\n     */\n    _positionHomeButton: function () {\n        if (this.homeViewContainer) {\n            var viewCubeVisible = this.cube && this.viewcube && (this.viewcube.style.display === 'block');\n            if (viewCubeVisible) {\n                this.homeViewContainer.classList.remove('no-viewcube');\n            } else {\n                this.homeViewContainer.classList.add('no-viewcube');\n            }\n        }\n    },\n\n    /**\n     * Refresh the view cube\n     *\n     * @alias Autodesk.Viewing.Extensions.ViewCubeUi#refreshCube\n     */\n    refreshCube: function() {\n        this.cube && this.cube.refreshCube();\n    },\n});\n\n\n/**\n * Register the extension with the extension manager.\n */\nav.theExtensionManager.registerExtension('Autodesk.ViewCubeUi', ViewCubeUi);\n"],"sourceRoot":""}