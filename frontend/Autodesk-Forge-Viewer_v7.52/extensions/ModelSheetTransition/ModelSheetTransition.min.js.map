{"version":3,"sources":["webpack://Autodesk.Extensions.[name]/webpack/bootstrap","webpack://Autodesk.Extensions.[name]/./node_modules/css-loader/lib/css-base.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/addStyles.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/urls.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/BoundsPlane.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/ModelSheetTransition.css?0cdc","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/ModelSheetTransition.css","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/ModelSheetCommon.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/ModelSheetConstants.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/ModelSheetTransitionLocals.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/SheetToModel.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/ModelToSheet.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/UI/ModelSheetGenericUI.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/UI/ModelSheet3DMarker.js","webpack://Autodesk.Extensions.[name]/./extensions/ModelSheetTransition/ModelSheetTransition.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","useSourceMap","list","toString","this","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","sourceURLs","sources","source","sourceRoot","concat","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","length","id","push","fn","memo","stylesInDom","isOldIE","window","document","all","atob","apply","arguments","getTarget","target","parent","querySelector","getElement","styleTarget","HTMLIFrameElement","contentDocument","head","e","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","options","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createElement","undefined","attrs","type","nonce","getNonce","addAttrs","el","keys","forEach","setAttribute","obj","update","remove","result","transform","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","updateLink","href","applyToTag","newObj","DEBUG","newList","mayRemove","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","location","baseUrl","protocol","host","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","BoundsPlane","viewer","overlayName","materialManager","impl","matman","isVisible","lock","createOverlayScene","geometry","THREE","PlaneBufferGeometry","points","Vector3","linesGeometry","Geometry","verts","vertices","fillMaterial","MeshPhongMaterial","color","side","DoubleSide","specular","transparent","opacity","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","depthTest","depthWrite","edgeMaterial","LineBasicMaterial","doNotCut","solidName","_getMaterialHash","addMaterial","edgesName","addMaterialNonHDR","boundariesMesh","Mesh","lineMesh","Line","LinePieces","boundsGroup","Group","add","matrixAutoUpdate","boundsPlane","createBoundsPlane","matrix","getBoundsPlane","copy","matrixWorldNeedsUpdate","invalidate","withAnimation","fadeAnim","stop","startValue","addOverlay","onTimer","Autodesk","Viewing","Private","smootherStep","setMaterialsOpacity","onFadeEnd","removeOverlay","fadeValue","setVisible","removeMaterial","removeOverlayScene","locals","viewportBoundsAnim","getSuitable2DModel","is2d","get2DModels","setCutPlane","clearSelectedFloor","pos","rot","Quaternion","scale","decompose","getExtensionAsync","sectionExt","normal","applyQuaternion","levelsExtension","getExtension","floorSelector","selectFloor","prevLock","toolController","setIsLocked","setSectionPlane","setViewportBounds","model","endBox","duration","skip","dstBox","Box3","originalBounds","getBoundingBox","clone","currentBounds","getViewportBounds","startBox","box","min","z","max","setBounds","lerpVectors","Promise","resolve","setTimeout","resetModelTransformAndViewport","setPlacementTransform","Matrix4","changePaperVisibility","setDoNotCut","fitAfterTransformImmediate","camera","getCamera","applyMatrix4","updateCameraMatrices","navigation","setPivotPoint","setPivotSetFlag","fitToBounds","bounds","getVisibleBounds","fitBounds","fitToBoundsWithAnimation","fit","computeFit","position","fov","aspect","dstView","up","flyToView","fitCameraToSheet","toOrthographic","bbox","getModelToViewerTransform","center","getCenter","size","y","rotation","extractRotation","normalize","locales","en","SheetToModel","extension","ext","model2D","nodeAndViewportPromise","getNodeAndViewport","setNavigationLock","bubbleNode","viewport","displayError","i18n","translate","console","warn","setSelectedViewport","showModel","model3D","unitScale","getUnitScale","get2DTo3DMatrix","isMatrixInLocalCoords","modelToViewerTransform","multiplyMatrices","viewportBounds","analytics","track","ModelSheetTransition","AnalyticsEventName","action","alignment","AEC","ViewportsExtension","AecModelDataViewport","from","file_2d_extension","getDocumentNode","getInputFileType","file_3d_extension","ModelToSheet","getPlacementTransform","invMatrix","LmvMatrix4","isDoublePrecision","getInverse","getVisibleModels","hideModel","updateUI","resetTransformAndViewport","ModelSheetGenericUI","onHide","ctxMenu","ContextMenu","onShowHide","onGoToSheet","x","menu","icon","title","showMenu","open","ModelSheet3DMarker","ui","onClick","onMouseEnter","onMouseLeave","onMouseWheel","calculateMatrixAndBounds","createAndAddMarker","viewportMatrix","button","UI","Button","getGuid","setToolTip","getName","container","classList","addEventListener","getBoundingClientRect","Array","isArray","changedPointers","clientX","clientY","left","top","show","isSheetVisible","hideSheet","showSheet","nodePromise","getParentSheetNode","isSelected","onMarkerSelected","onMarkerDeselected","getNode","node","setMarkerSelected","reportAnalytics","showSheetAndSetTransform","getModel","transitionModelToSheet","enterTimeout","addPlane","clearTimeout","removePlane","scaleMatrix","makeScale","setPosition","multiply","model3DTransform","setFromMatrix","mousewheel","models","getAllModels","find","maxX","minY","bottomRight","worldToClient","setWorldPosition","updateClientLocation","namespace","AutodeskNamespace","LevelsExtensionId","ModelSheetTransitionExtension","Extension","loadDocument","loadModel","_displayError","updateMarkersClientLocation","updateMarkers","addMarkersForModel","removeMarkersForModel","onViewportDataFetched","onSelectedFloorChanged","onExtensionLoaded","onExtensionUnloaded","sheetToModel","modelToSheet","defaultPosition2D","defaultTarget2D","areMarkersVisible","markers","error","cache","getCache","nodesAndViewports","Map","transformedModels","extendLocalization","loadExtension","viewportsExtension","MODEL_ADDED_EVENT","MODEL_REMOVED_EVENT","Events","VIEWPORT_DATA_FETCHED_EVENT","EXTENSION_LOADED_EVENT","EXTENSION_UNLOADED_EVENT","extensionId","removeEventListener","hideSelectedSheet","destroyUIFor2D","destroyUIFor3D","createUIfor2D","resetModelIfNeeded","viewports","getViewportsForModel","vp","AlignmentServiceViewport","getRelatedModel3DInfo","setButtonEnabled","createUIfor3D","getHiddenModels","toolbar","getToolbar","toolbarButton","toolbarGroup","getControl","TOOLBAR","MODELTOOLSID","setIcon","setState","State","DISABLED","transitionStarted","transition2Dto3D","set","addControl","enabled","supported","supportedTooltip","unsupportedTooltip","INACTIVE","removeFromParent","ui3DCreated","setDefaultStyle","ui3D","get3DModels","CAMERA_CHANGE_EVENT","VIEWER_RESIZE_EVENT","MODEL_VIEWPORT_BOUNDS_CHANGED_EVENT","MODEL_TRANSFORM_CHANGED_EVENT","is3d","relatedViewports","duringModelToSheetTransition","findModel","vpKeys","getMarkersKeysForModel","includes","removeMarker","vpGuid","marker","getSelectedViewportGuid","_selectedViewportOrGuid","findViewportByGuid","viewportOrGuid","destroy","model3DMatrix","isTopViewViewport","selectedMarker","has","setView","orientCameraUp","controls","recordHomeView","delete","getViewportsAsync","onlyTopViewPlans","useOnlyAecModelDataViewports","getViewports","getViewportsForModelAsync","get3DNodesForViewport","nodes","bubbleNode3D","regionId","message","AlertBox","transition3Dto2D","FloorSelector","SELECTED_FLOOR_CHANGED","getSelectedViewport","sectionExtension","setSectionFromPlane","theExtensionManager","registerExtension"],"mappings":"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","file":"ModelSheetTransition/ModelSheetTransition.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 841);\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","const FillOpacity = 0.7;\nconst EdgeOpacity = 1.0;\nconst FadeDuration = 0.3; // In seconds\n\nexport default class BoundsPlane {\n    constructor(viewer, overlayName) {\n        this.viewer = viewer;\n        this.overlayName = overlayName;\n        this.materialManager = viewer.impl.matman();\n        this.isVisible = false;\n        this.lock = false;\n    }\n\n    createBoundsPlane() {\n        this.viewer.impl.createOverlayScene(this.overlayName);\n        // Fill geometry\n        const geometry = new THREE.PlaneBufferGeometry(1, 1);\n\n        const points = [];\n        points.push(new THREE.Vector3( -0.5, -0.5, 0 ));\n        points.push(new THREE.Vector3( -0.5, 0.5, 0 ));\n        points.push(new THREE.Vector3( 0.5, 0.5, 0 ));\n        points.push(new THREE.Vector3( 0.5, -0.5, 0 ));\n        \n        // Outline geometry\n        const linesGeometry = new THREE.Geometry();\n        const verts = linesGeometry.vertices;\n        verts.push(points[0]);\n        verts.push(points[1]);\n\n        verts.push(points[1]);\n        verts.push(points[2]);\n\n        verts.push(points[2]);\n        verts.push(points[3]);\n\n        verts.push(points[3]);\n        verts.push(points[0]);\n\n        this.fillMaterial = new THREE.MeshPhongMaterial({\n            color: 0xCDEAF7,\n            side: THREE.DoubleSide,\n            specular: 0x000000,\n            transparent: true,\n            opacity: FillOpacity,\n            polygonOffset: true,\n            polygonOffsetFactor: 1.0,\n            polygonOffsetUnits: 5,\n            depthTest: false,\n            depthWrite: false,\n        });\n        this.edgeMaterial = new THREE.LineBasicMaterial({\n                color: 0x000000,\n                side: THREE.DoubleSide,\n                opacity: EdgeOpacity,\n                transparent: true,\n                depthTest: false,\n                depthWrite: false,\n        });\n        this.fillMaterial.doNotCut = true;\n        this.edgeMaterial.doNotCut = true;\n    \n        this.solidName = this.materialManager._getMaterialHash(null, 'ModelSheetTransition.solid');\n        this.materialManager.addMaterial(this.solidName, this.fillMaterial, true);\n    \n        this.edgesName = this.materialManager._getMaterialHash(null, 'ModelSheetTransition.edges');\n        this.materialManager.addMaterialNonHDR(this.edgesName, this.edgeMaterial);\n    \n        const boundariesMesh = new THREE.Mesh(geometry, this.fillMaterial);\n        const lineMesh = new THREE.Line(linesGeometry, this.edgeMaterial, THREE.LinePieces);\n        const boundsGroup = new THREE.Group();\n        boundsGroup.add(boundariesMesh);\n        boundsGroup.add(lineMesh);\n    \n        boundsGroup.matrixAutoUpdate = false;\n    \n        return boundsGroup;\n    }\n\n    getBoundsPlane() {\n        if (!this.boundsPlane) {\n            this.boundsPlane = this.createBoundsPlane();\n        }\n    \n        return this.boundsPlane;\n    }\n\n    setFromMatrix(matrix) {\n        const boundsPlane = this.getBoundsPlane();\n\n        boundsPlane.matrix.copy(matrix);\n        boundsPlane.matrixWorldNeedsUpdate = true;\n    }\n\n    // Set the material opacitiy to a percentage of their full value\n    setMaterialsOpacity(t) {\n        this.fillMaterial.opacity = t * FillOpacity;    \n        this.edgeMaterial.opacity = t * EdgeOpacity;\n        this.viewer.impl.invalidate(false, false, true);\n    }\n\n    setVisible(isVisible, withAnimation = true) {\n        if (this.isVisible === isVisible) {\n            return;\n        }\n\n        if (this.fadeAnim) {\n            this.fadeAnim.stop();\n            this.fadeAnim = null;\n        }\n\n        this.isVisible = isVisible;\n        const boundsPlane = this.getBoundsPlane();\n\n        const startValue = isVisible ? 0 : 1;\n\n        if (isVisible) this.viewer.impl.addOverlay(this.overlayName, boundsPlane);\n        \n        if (withAnimation) {\n            const onTimer = (t) => {\n                t = Autodesk.Viewing.Private.smootherStep(t);\n                this.setMaterialsOpacity(t);\n            };\n\n            const onFadeEnd = () => {\n                if (!isVisible) this.viewer.impl.removeOverlay(this.overlayName, boundsPlane);\n                this.fadeAnim = null;\n            };\n\n            this.fadeAnim = Autodesk.Viewing.Private.fadeValue(startValue, 1-startValue, FadeDuration, onTimer, onFadeEnd);\n        } else {\n            if (isVisible) {\n                this.setMaterialsOpacity(1);\n            } else {\n                this.viewer.impl.removeOverlay(this.overlayName, boundsPlane);\n            }\n        }\n\n        this.viewer.impl.invalidate(false, false, true);\n    }\n\n    destroy() {\n        this.setVisible(false);\n\n        if (this.solidName) {\n            this.materialManager.removeMaterial(this.solidName);\n            this.materialManager.removeMaterial(this.edgesName);\n        }\n\n        this.viewer.impl.removeOverlayScene(this.overlayName);\n    }\n}","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./ModelSheetTransition.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./ModelSheetTransition.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./ModelSheetTransition.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".viewericon-model-sheet-transition:before{font-family:'modelSheetTransitionIcon';content:\\\"M\\\"}@font-face{font-family:'modelSheetTransitionIcon';src:url(\\\"data:application/font-woff;base64,d09GRgABAAAAAAP8AAoAAAAABjgAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAD4AAABWVsFjP2NtYXAAAAE0AAAAPAAAAUoArAFrZ2x5ZgAAAXAAAADAAAAAwMOBpSJoZWFkAAACMAAAACsAAAA2GlHbmWhoZWEAAAJcAAAAGwAAACQIPQQDaG10eAAAAngAAAAIAAAACAgAAABsb2NhAAACgAAAAAYAAAAGAGAAAG1heHAAAAKIAAAAIAAAACABEABGbmFtZQAAAqgAAAE7AAACbdWMZSRwb3N0AAAD5AAAABUAAAApARAAAHicY2BkYWCcwMDKwMHUyXSGgYGhH0IzvmYwYuRgYGBiYGVmwAoC0lxTGBwYfBl8WUDcGBaIMCOIAACZnwe0AAB4nGNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZiALN///8EqwPT/LVD1QMDIxkBdwEhYyWADAMFRBxMABAAAAAAD4AQAACEAKQAxADkAAAEuAicjJSMmIgcFBgcGBxQVER4BFwUXMyU+ATURNCc4AQEmLwERBREwEyYvASUNATABBg8BESURMAPeAQUFAwP+SQUJFQn+TQYEBwUBDQsBsQ0ZAbcLDQL9+BacsgFkKhaUqgFUAVP+rQGNF5yyAWUDFAUHBgPSBQXNBAcGCQUG/eEMFAXABcIFFAwCIgUG/VQJRU8BxJ3+PAILCkJLoaGX/pIKRU4BxJ3+PAB4nGNgZGBgAOKs5tdr4/ltvjJwszCAwO2Vp/2QaeYHYHEOBiYQBQBAlgphAHicY2BkYGBhAIIYMMnA/ICBkQEVMAEAG9IBTAAEAAAABAAAAAAAAAAAYAAAAAEAAAACADoABAAAAAAAAgAAAAoACgAAAP8AAAAAAAB4nHWPS07DMBCGf/cFtBKqqGCH5AViASh9iFU37Jp9F92nrdOH0jhy3Eo9AOfhCJyAI9AbcAd+0gGhUmJ5/M03k3EC4AI7KOyfS+49K5wy23MJJ7gWLtPfCFfID8JVNPAoXKN/Eq7jHqFwAy04TlCVM2Z3eBZWaOJFuIRzvAqX6d+EK+R34Squ8CFcQ1OVhesYqZZwA7dqEZrUuMibqR5vdZhss7k37vscmtk6idyhHhmXL2yqu0Hnp/R7TL6Z9byPdezsSg9s6k2SWJ05uzQTH8y9z/rtdiw+mNgVf98g5XaI4HlOoTHGljFEwjPDvPDuTz5knGFNGx2pHuajIuZYwPI+jS4CdI689d/X5Njwth6tR8w8Zo/FijQoJn51J1yWJitqS5oJfVBM97R9tLnig/6AXZz0CTRjb6QAeJxjYGKAAC4G7AAozwhSAwAB1gASAAAA\\\") format(\\\"woff\\\");font-weight:normal;font-style:normal}.viewericon-model-sheet-eye-hide:before{font-family:'modelSheetContextMenuIcons';font-size:20px;text-rendering:auto;-webkit-font-smoothing:antialiased;content:\\\"\\\\EA01\\\"}.viewericon-model-sheet-eye-show:before{font-family:'modelSheetContextMenuIcons';font-size:20px;text-rendering:auto;-webkit-font-smoothing:antialiased;content:\\\"\\\\EA02\\\"}.viewericon-model-sheet-sheet:before{font-family:'modelSheetContextMenuIcons';font-size:20px;text-rendering:auto;-webkit-font-smoothing:antialiased;content:\\\"\\\\EA03\\\"}@font-face{font-family:'modelSheetContextMenuIcons';src:url(\\\"data:application/font-woff;base64,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\\\") format(\\\"woff\\\");font-weight:400;font-style:normal}.hyper-sheet-marker.adsk-button{position:absolute;width:32px;height:32px;left:0;top:0;margin:0;padding:0;background:rgba(255,255,255,0.7);border-radius:50%;box-sizing:content-box;transition:color .2s ease-in-out;will-change:transform;border:none}.hyper-sheet-marker-icon:before{font-family:'modelSheetContextMenuIcons';font-size:16px;text-rendering:auto;-webkit-font-smoothing:antialiased;content:\\\"\\\\EA03\\\";display:flex;flex-direction:row;transform:translate(-50%, -50%);position:absolute;left:50%;top:50%}.hyper-sheet-marker.adsk-button:hover{color:#3C3C3C !important;background:#fff}.hyper-sheet-marker.adsk-button.clicked{box-shadow:0px 0px 0px 2px #006EAF}.hyper-sheet-marker.adsk-button.selected{box-shadow:0px 0px 0px 2px #000000}\\n\", \"\"]);\n\n// exports\n","import { FLY_TO_DURATION, FIT_TO_SHEET_DURATION } from './ModelSheetConstants';\n\nexport const getSuitable2DModel = (viewer) => {\n    return viewer.impl.is2d && viewer.impl.get2DModels()[0];\n};\n\nexport const setCutPlane = async (viewer, matrix, clearSelectedFloor) => {\n    const pos = new THREE.Vector3();\n    const rot = new THREE.Quaternion();\n    const scale = new THREE.Vector3();\n    matrix.decompose(pos, rot, scale);\n    const sectionExt = await viewer.getExtensionAsync('Autodesk.Section');\n    // Assuming original's sheet normal is +Z (which should be the case)\n    const normal = new THREE.Vector3(0, 0, 1);\n    normal.applyQuaternion(rot);\n\n    // Deselect current floor section if exists.\n    // This is needed so the viewport's section plane won't collide with a selected floor section.\n    if (clearSelectedFloor) {\n        const levelsExtension = viewer.getExtension('Autodesk.AEC.LevelsExtension');\n        levelsExtension?.floorSelector?.selectFloor(undefined, false);\n    }\n\n    // Tool controller can be locked if the user tries an interaction such as panning\n    const prevLock = viewer.toolController.setIsLocked(false);\n    sectionExt.setSectionPlane(normal, pos, false);\n    viewer.toolController.setIsLocked(prevLock);\n};\n\n// Pass endBox=null to reset to original bounds\n// Pass a duration > 0 to animate\nexport const setViewportBounds = (() => {\n    let viewportBoundsAnim = null;\n\n    const convertToBox3 = (box) => {\n        if (!box || box instanceof THREE.Box3) {\n            return box;\n        }\n        \n        // The crop box that is passed sometimes contains only (x, y).\n        // To make the lerping consistent this converts the box to a Box3\n        box.min.z = box.max.z = 0;\n        return new THREE.Box3(box.min, box.max);\n    };\n\n    return async (viewer, model, endBox, duration) => {\n        if (viewportBoundsAnim) {\n            viewportBoundsAnim.skip();\n            viewportBoundsAnim = null;\n        }\n\n        const dstBox = new THREE.Box3();\n\n        // The initial box is the bounding box\n        const originalBounds = model.getBoundingBox(true, false).clone();\n        \n        // If the cropping area was changed from the initial one, get the current one\n        const currentBounds = model.getViewportBounds()?.clone();\n        \n        // When endBox is null, it means we want to restore the original box\n        const startBox = currentBounds || originalBounds;\n        endBox = convertToBox3(endBox) || originalBounds;\n\n        const setBounds = () => {\n            viewer.impl.setViewportBounds(model, dstBox);\n        };\n\n        const onTimer = t => {\n            t = Autodesk.Viewing.Private.smootherStep(t);\n            dstBox.min.lerpVectors(startBox.min, endBox.min, t);\n            dstBox.max.lerpVectors(startBox.max, endBox.max, t);\n\n            setBounds();\n        };\n\n        return new Promise(resolve => {\n            const onFinished = () => {\n                viewportBoundsAnim = null;\n                setTimeout(resolve);\n            };\n\n            if (duration === 0) { // Call directly\n                dstBox.copy(endBox);\n                setBounds();\n                resolve();\n            } else {\n                viewportBoundsAnim = Autodesk.Viewing.Private.fadeValue(0, 1, duration, onTimer, onFinished);\n            }\n        });\n    };\n})();\n\nexport const resetModelTransformAndViewport = (viewer, model) => {\n    // Reset transform\n    viewer.impl.setPlacementTransform(model, new THREE.Matrix4());\n\n    model.changePaperVisibility(true);\n    viewer.impl.setDoNotCut(model, true);\n\n    // Reset viewport bounds (without animation - duration set to 0)\n    setViewportBounds(viewer, model, null, 0);\n};\n\n// When transitioning from 2D to 3D, the sheet might end in a completely different position.\n// Assuming the sheet has already been fitted, and applying the transform to the camera, we make sure the fitting remains\n// while still facing the sheet.\nexport const fitAfterTransformImmediate = (viewer, matrix) => {\n    const camera = viewer.getCamera();\n    camera.applyMatrix4(matrix);\n    camera.updateCameraMatrices();\n    // Set pivot point to current target\n    viewer.navigation.setPivotPoint(camera.target);\n    viewer.navigation.setPivotSetFlag(true);\n};\n\nexport const fitToBounds = (viewer, model) => {\n    const bounds = model.getVisibleBounds();\n    // fitBounds will also set the pivot point from the camera's target\n    viewer.navigation.fitBounds(true, bounds, false, true);\n\n    viewer.impl.invalidate(true);\n};\n\nexport const fitToBoundsWithAnimation = async (viewer, model) => {\n    const bounds = model.getVisibleBounds();\n    const camera = viewer.getCamera();\n    const fit = viewer.navigation.computeFit(camera.position, camera.target, camera.fov, bounds, camera.aspect);\n\n    const dstView = {\n        position: fit.position,\n        target: fit.target,\n        up: camera.up\n    };\n\n    return new Promise(resolve => {\n        Autodesk.Viewing.Private.flyToView(viewer, dstView, FLY_TO_DURATION, () => {\n            // Wait a frame for last invalidate to take hold, before allowing to continue.\n            // Avoids a graphical glitch when the 3D model is already loaded\n            setTimeout(resolve);\n        }, false);\n    });\n};\n\nexport const fitCameraToSheet = (viewer, model) => {\n    viewer.navigation.toOrthographic();\n\n    const bbox = model.getBoundingBox(true, false).clone();\n\n    const matrix = model.getModelToViewerTransform() || new THREE.Matrix4();\n    const center = bbox.getCenter();\n\n    // Set the center of the sheet as the target, then move away in the z direction towards the camera\n    // to set the desired position. Then apply transform to both.\n    // Using this as parameters for computeFit will give us the destination that would be the same as fit To View.\n    const position = center.clone();\n    position.z += bbox.size().y;\n    position.applyMatrix4(matrix);\n    \n    const target = center.applyMatrix4(matrix);\n\n    const rotation = new THREE.Matrix4();\n    rotation.extractRotation(matrix);\n\n    // Apply rotation to up vector - according to 2D model default up direction.\n    const up = new THREE.Vector3(0, 1, 0).applyMatrix4(rotation).normalize();\n\n    // Transform box to the current state\n    bbox.applyMatrix4(matrix);\n\n    const { fov, aspect } = viewer.getCamera();\n    const fit = viewer.navigation.computeFit(position, target, fov, bbox, aspect);\n    const dstView = {\n        position: fit.position,\n        target: fit.target,\n        up\n    };\n\n    return new Promise(resolve => {\n        Autodesk.Viewing.Private.flyToView(viewer, dstView, FIT_TO_SHEET_DURATION, () => {\n            // Wait a frame for last invalidate to take hold, before allowing to continue.\n            // Avoids a graphical glitch\n            setTimeout(resolve);\n        }, false);\n    });\n};","export const HIDE_DURATION = 2.5; // In seconds\nexport const SHOW_DURATION = 1.5; // In seconds\nexport const FLY_TO_DURATION = 1.0; // In seconds\nexport const FIT_TO_SHEET_DURATION = 0.5; // In seconds","/**\n * Include each locale json file and return it in an object\n * that can be consumed by i18n\n */\n\nimport json_en from '../../res/locales/en/nobundle-modelSheetTransition.loc.json';\n\nexport const locales = {\n    en: json_en,\n};\n","import { HIDE_DURATION } from './ModelSheetConstants';\nimport { setCutPlane, setViewportBounds, fitAfterTransformImmediate, fitToBoundsWithAnimation } from './ModelSheetCommon';\n\nexport default class SheetToModel {\n    constructor(extension) {\n        this.ext = extension;\n        this.viewer = extension.viewer;\n    }\n\n    async transition2Dto3D(model2D) {\n        if (!this.viewer.impl.is2d) {\n            return;\n        }\n\n        // Start fetching the transforms\n        const nodeAndViewportPromise = this.ext.getNodeAndViewport(model2D);\n\n        // First transition to showing whole sheet. Lock navigation until transition is finished.\n        this.viewer.setNavigationLock(true);\n        await fitToBoundsWithAnimation(this.viewer, model2D);\n\n        let bubbleNode, viewport;\n\n        try {\n            ({ bubbleNode, viewport } = await nodeAndViewportPromise);\n        } catch (err) {\n            // Restore navigation\n            this.viewer.setNavigationLock(false);\n\n            this.ext.displayError(Autodesk.Viewing.i18n.translate('No suitable model found for transition.'));\n            console.warn(err);\n            return;\n        }\n\n        // Prevent sheets from getting cut by cutplanes\n        this.viewer.impl.setDoNotCut(model2D, true);\n\n        this.ext.setSelectedViewport(viewport);\n\n        // Show the 3D model\n        const model3D = await this.ext.showModel(bubbleNode);\n\n        const unitScale = model2D.getUnitScale();\n        let matrix = viewport.get2DTo3DMatrix(unitScale);\n        \n        if (viewport.isMatrixInLocalCoords()) {\n            const modelToViewerTransform = model3D.getModelToViewerTransform();\n            if (modelToViewerTransform) {\n                matrix = matrix.clone().multiplyMatrices(modelToViewerTransform, matrix);\n            }\n        }\n        \n        // Set the transform to the sheet\n        model2D.setPlacementTransform(matrix);\n        fitAfterTransformImmediate(this.viewer, matrix);\n\n        // Define a cutplane with the sheet's plane, so that it's fully visible and not occluded by the model when we start\n        // This cutplane can then be moved in the sheet's normal axis.\n        await setCutPlane(this.viewer, matrix);\n\n        // Navigation is free from this point\n        this.viewer.setNavigationLock(false);\n\n        // Hide paper and crop to viewport\n        this.viewer.impl.changePaperVisibility(model2D, false, true, null, HIDE_DURATION);\n\n        const viewportBounds = viewport.getViewportBounds(unitScale);\n\n        if (viewportBounds) {\n            await setViewportBounds(this.viewer, model2D, viewportBounds, HIDE_DURATION);\n        }\n\n        Autodesk.Viewing.Private.analytics.track(Autodesk.ModelSheetTransition.AnalyticsEventName, {\n            action: 'View',\n            alignment: viewport instanceof Autodesk.AEC.ViewportsExtension.AecModelDataViewport ? 'Automatic' : 'Manual',\n            from: 'Sheet',\n            file_2d_extension: model2D.getDocumentNode().getInputFileType(),\n            file_3d_extension: bubbleNode.getInputFileType(),\n        });\n    }\n}","import { SHOW_DURATION } from './ModelSheetConstants';\nimport { setCutPlane, fitAfterTransformImmediate, fitCameraToSheet, setViewportBounds } from './ModelSheetCommon';\n\nexport default class ModelToSheet {\n    constructor(extension) {\n        this.ext = extension;\n        this.viewer = extension.viewer;\n    }\n\n    async transition3Dto2D(model) {\n        if (this.viewer.impl.is2d) {\n            return;\n        }\n\n        const matrix = model.getPlacementTransform();\n        const invMatrix = (new Autodesk.Viewing.Private.LmvMatrix4(matrix.isDoublePrecision)).getInverse(matrix);\n        this.viewer.setNavigationLock(true);\n\n        await setCutPlane(this.viewer, matrix);\n\n        await fitCameraToSheet(this.viewer, model);\n\n        // Hide other models\n        const otherModels = this.viewer.getVisibleModels().filter(m => m !== model);\n        otherModels.forEach(m => this.ext.hideModel(m.getDocumentNode()));\n\n        // Show paper and restore viewport\n        this.viewer.impl.changePaperVisibility(model, true, true, null, SHOW_DURATION);\n        await setViewportBounds(this.viewer, model, null, SHOW_DURATION);\n\n        // Reset transform\n        this.viewer.impl.setPlacementTransform(model, new THREE.Matrix4());\n        this.viewer.impl.invalidate(true);\n        fitAfterTransformImmediate(this.viewer, invMatrix);\n\n        this.ext.updateUI({ resetTransformAndViewport: false });\n\n        this.viewer.impl.setDoNotCut(model, false);\n\n        this.viewer.setNavigationLock(false);\n    }\n}","/*\nUI needs to receive the location to display (not dynamic - clicking outside closes the menu)\nUI needs to receive the urn / or bubble (see utils in UI repo) to show the correct thumbnail\nUI needs to receive state of sheet (is it shown/hidden)\nUI needs to receive 2 callbacks to run when show/hide is called, and when go to sheet is called\n*/\n\nexport default class ModelSheetGenericUI {\n    constructor(viewer, onHide) {\n        this.viewer = viewer;\n        this.ctxMenu = new Autodesk.Viewing.Private.ContextMenu(this.viewer, { onHide });\n    }\n\n    show(position, isVisible, onShowHide, onGoToSheet) {\n        const { x, y } = position;\n\n        const menu = [];\n        menu.push({\n            icon: isVisible ? 'viewericon-model-sheet-eye-hide' : 'viewericon-model-sheet-eye-show',\n            title: isVisible ? 'Hide sheet' :'Show sheet',\n            target: onShowHide,\n        });\n        menu.push({\n            icon: 'viewericon-model-sheet-sheet',\n            title: 'Go to sheet',\n            target: onGoToSheet,\n        });\n\n        this.ctxMenu.showMenu(menu, x, y);\n        this.ctxMenu.open = true;\n    }\n\n}","export default class ModelSheet3DMarker {\n    constructor(extension, viewport, model3D, ui, isVisible) {\n        this.extension = extension;\n        this.viewer = extension.viewer;\n        this.viewport = viewport;\n        this.model3D = model3D;\n        this.ui = ui;\n\n        // Generic shared plane to use when sheet is not visible\n        this.boundsPlane = extension.boundsPlane;\n\n        // Bounded functions\n        this.onShowHide = this.onShowHide.bind(this);\n        this.onGoToSheet = this.onGoToSheet.bind(this);\n        this.update = this.update.bind(this);\n        this.onClick = this.onClick.bind(this);\n        this.onMouseEnter = this.onMouseEnter.bind(this);\n        this.onMouseLeave = this.onMouseLeave.bind(this);\n        this.onMouseWheel = this.onMouseWheel.bind(this);\n\n        this.matrix = new THREE.Matrix4();\n\n        this.calculateMatrixAndBounds();\n        this.createAndAddMarker();\n        this.setVisible(isVisible);\n    }\n\n    calculateMatrixAndBounds() {\n        // The functions getViewportBounds() and get3DTo2DMatrix() work in sheet-space, so that they require\n        // the sheetUnitScale - which we don't know before loading the sheet (here we only have a reference for the 3D model).\n        //\n        // But, since we only care about the relative position of the viewport inside the sheet, we can use a dummy unit scale here.\n        const dummyScale = 1.0;\n        this.viewportBounds = this.viewport.getViewportBounds(dummyScale);\n        this.viewportMatrix = this.viewport.get2DTo3DMatrix(dummyScale);\n    }\n\n    createAndAddMarker() {\n        // Guid is added to the hash to allow multiple copies of the same sheet to be loaded, with different placements\n        this.button = new Autodesk.Viewing.UI.Button(`mst-b-${this.viewport.getGuid()}`);\n        this.button.setToolTip(this.viewport.getName());\n\n        this.container = this.button.container;\n        this.container.classList.add('hyper-sheet-marker', 'hyper-sheet-marker-icon');\n         // The icon class adds some styling we don't need (and enlarges the click area)\n        this.button.icon.remove(\"adsk-button-icon\");\n\n        this.container.addEventListener('click', this.onClick);\n        this.container.addEventListener('mouseenter', this.onMouseEnter);\n        this.container.addEventListener('mouseleave', this.onMouseLeave);\n        this.container.addEventListener('mousewheel', this.onMouseWheel);\n\n        this.viewer.container.appendChild(this.container);\n\n        this.update();\n    }\n\n    setVisible(isVisible) {\n        this.button?.setVisible(isVisible);\n    }\n\n    setDefaultStyle() {\n        this.container.classList.remove('clicked');\n    }\n\n    onClick(e) {\n        this.boundsPlane.lock = true;\n        const viewport = this.viewer.container.getBoundingClientRect();\n\n        // Normalize Hammer events\n        if (Array.isArray(e.changedPointers) && e.changedPointers.length > 0) {\n            e.clientX = e.changedPointers[0].clientX;\n            e.clientY = e.changedPointers[0].clientY;\n        }\n    \n        const x = e.clientX - viewport.left;\n        const y = e.clientY - viewport.top;\n\n        this.container.classList.add('clicked');\n\n        this.ui.show({x, y}, this.isSheetVisible, this.onShowHide, this.onGoToSheet);\n    }\n\n    onShowHide() {\n        const from = 'Marker';\n\n        if (this.isSheetVisible) {\n            this.hideSheet(from);\n        } else {\n            this.showSheet(from);\n        }\n    }\n\n    async getNode() {\n        if (!this.nodePromise) {\n            this.nodePromise = this.viewport.getParentSheetNode();\n        }\n\n        return await this.nodePromise;\n    }\n\n    setMarkerSelected(isSelected) {\n        if (isSelected) {\n            this.container.classList.add('selected');\n            this.isSheetVisible = true;\n            this.extension.onMarkerSelected(this);\n        } else {\n            this.container.classList.remove('selected');\n            this.isSheetVisible = false;\n            this.extension.onMarkerDeselected(this);\n        }\n    }\n\n    async hideSheet(from) {\n        if (!this.isSheetVisible) {\n            return;\n        }\n\n        const node = await this.getNode();\n        this.extension.hideSheet(node);\n        this.setMarkerSelected(false);\n\n        this.reportAnalytics('Hide', from, node);\n    }\n\n    async showSheet(from) {\n        if (this.isSheetVisible) {\n            return;\n        }\n\n        this.setMarkerSelected(true);\n        \n        const node = await this.getNode();\n        const model = await this.extension.showSheetAndSetTransform(node, this.viewport, this.model3D);\n\n        this.reportAnalytics('View', from, node);\n\n        // Make sure that model should still be visible at this step (maybe someone clicked showSheet & hideSheet fast enough so by this point it should be hidden again). \n        if (!this.isSheetVisible) {\n            this.extension.hideModel(node);\n            return null;\n        }\n\n        return model;\n    }\n\n    async onGoToSheet() {\n        let model = await this.getModel();\n        if (!this.isSheetVisible || !model) {\n            model = await this.showSheet();\n        }\n    \n        this.extension.transitionModelToSheet(model);\n    }\n\n    onMouseEnter() {\n        if (this.isSheetVisible) {\n            return;\n        }\n\n        this.enterTimeout = setTimeout(() => {\n            this.addPlane();\n        }, 300);        \n    }\n\n    onMouseLeave() {\n        if (!this.boundsPlane.lock) {\n            clearTimeout(this.enterTimeout);\n            this.enterTimeout = null;\n            this.removePlane();\n        }\n    }\n\n    addPlane() {\n        // When the sheet is not visible, show a plane to give a sense of its dimensions\n        const min = new THREE.Vector3(this.viewportBounds.min.x, this.viewportBounds.min.y, 0);\n        const max = new THREE.Vector3(this.viewportBounds.max.x, this.viewportBounds.max.y, 0);\n        const bbox = new THREE.Box3(min, max);\n\n        const size = bbox.size();\n        const scaleMatrix = new THREE.Matrix4().makeScale(size.x, size.y, 1);\n        scaleMatrix.setPosition(bbox.getCenter());\n        const matrix = this.matrix.clone();\n        matrix.multiply(scaleMatrix);\n\n        if (this.viewport.isMatrixInLocalCoords()) {\n            const model3DTransform = this.model3D.getModelToViewerTransform();\n            if (model3DTransform) {\n                matrix.multiplyMatrices(model3DTransform, matrix);\n            }\n        }\n\n        this.boundsPlane.setFromMatrix(matrix);\n        this.boundsPlane.setVisible(true);\n    }\n\n    removePlane() {\n        this.boundsPlane.setVisible(false);\n    }\n\n    onMouseWheel(e) {\n        // Propagate mouse wheel event to viewer\n        this.viewer.toolController.mousewheel(e);\n    }\n\n    async getModel() {\n        const node = await this.getNode();\n\n        const models = this.viewer.getAllModels();\n        const model = models.find(m => {\n            return m.getDocumentNode() === node;\n        });\n\n        return model;\n    }\n\n    setWorldPosition() {\n        const maxX = this.viewportBounds.max.x;\n        const minY = this.viewportBounds.min.y;\n\n        this.matrix.copy(this.viewportMatrix);\n\n        const bottomRight = (new THREE.Vector3(maxX, minY, 0.0)).applyMatrix4(this.matrix);\n\n        if (this.viewport.isMatrixInLocalCoords()) {\n            const model3DTransform = this.model3D.getModelToViewerTransform();\n            if (model3DTransform) {\n                bottomRight.applyMatrix4(model3DTransform);\n            }\n        }\n\n        this.location = bottomRight;\n    }\n\n    updateClientLocation() {\n        const pos = this.viewer.impl.worldToClient(this.location);\n\n        this.container.style.transform = `translate(${pos.x}px, ${pos.y}px)`;\n    }\n\n    update() {\n        this.setWorldPosition();\n        this.updateClientLocation();\n    }\n\n    destroy() {\n        if (this.container) {\n            this.viewer.container.removeChild(this.container);\n        }\n\n        this.button = null;\n    }\n\n    reportAnalytics(action, from, node) {\n        if (!action || !from || !node) {\n            return;\n        }\n        \n        Autodesk.Viewing.Private.analytics.track(Autodesk.ModelSheetTransition.AnalyticsEventName, {\n                action,\n                alignment: this.viewport instanceof Autodesk.AEC.ViewportsExtension.AecModelDataViewport ? 'Automatic' : 'Manual',\n                from,\n                file_2d_extension: node.getInputFileType(),\n                file_3d_extension: this.model3D.getDocumentNode().getInputFileType(),\n        });\n    }\n}","import { getSuitable2DModel, resetModelTransformAndViewport, setCutPlane, fitToBounds } from './ModelSheetCommon';\nimport { locales } from \"./ModelSheetTransitionLocals\";\nimport './ModelSheetTransition.css';\nimport SheetToModel from './SheetToModel';\nimport ModelToSheet from './ModelToSheet';\nimport ModelSheetGenericUI from './UI/ModelSheetGenericUI';\nimport ModelSheet3DMarker from './UI/ModelSheet3DMarker';\nimport BoundsPlane from './BoundsPlane';\n\n/**\n* ModelSheetTransition is an extension for transitioning from a 2D model to its context inside a 3D model.\n* Prerequisite is that the context (relationship and transform) exists and can be provided by a service.\n*\n*  * @example\n*   viewer.loadExtension('Autodesk.ModelSheetTransition')\n*\n* @memberof Autodesk.Viewing.Extensions\n* @see {@link Autodesk.Viewing.Extension} for common inherited methods.\n* @alias Autodesk.Viewing.Extensions.ModelSheetTransition\n* @class\n*/\n\nconst extensionName = 'Autodesk.ModelSheetTransition';\nconst namespace = AutodeskNamespace(extensionName);\n\nconst OverlayName = 'ModelSheetTransition_Extension_Overlay';\nconst LevelsExtensionId = 'Autodesk.AEC.LevelsExtension';\nconst AnalyticsEventName = 'viewer.hypermodel.view';\n\nexport default class ModelSheetTransitionExtension extends Autodesk.Viewing.Extension {\n    /**\n    * @param viewer\n    * @param options - If no service is provided will just default to looking for available AEC data.\n    *                  Must include a loadModel function that loads the related model (to load as hidden)\n    *                  Must include a showModel function that shows the related model\n    *                  Must include a hideModel function that hides the related model\n    *                  Can include a displayError function that uses a custom UI to show errors\n    */\n    constructor(viewer, options = {}) {\n        super(viewer, options);\n\n        this.loadDocument = options.loadDocument;\n        this.loadModel = options.loadModel;\n        this.showModel = options.showModel;\n        this.hideModel = options.hideModel;\n        this.displayError = options.displayError || this._displayError.bind(this);\n\n        // Bindings\n        this.updateUI = this.updateUI.bind(this);\n        this.updateMarkersClientLocation = this.updateMarkersClientLocation.bind(this);\n        this.updateMarkers = this.updateMarkers.bind(this);\n        this.addMarkersForModel = this.addMarkersForModel.bind(this);\n        this.removeMarkersForModel = this.removeMarkersForModel.bind(this);\n        this.onViewportDataFetched = this.onViewportDataFetched.bind(this);\n        this.onSelectedFloorChanged = this.onSelectedFloorChanged.bind(this);\n        this.onExtensionLoaded = this.onExtensionLoaded.bind(this);\n        this.onExtensionUnloaded = this.onExtensionUnloaded.bind(this);\n\n        this.sheetToModel = new SheetToModel(this);\n        this.modelToSheet = new ModelToSheet(this);\n\n        this.defaultPosition2D = new THREE.Vector3(0, 0, 1);\n        this.defaultTarget2D = new THREE.Vector3(0, 0, 0);\n\n        this.areMarkersVisible = false;\n        this.markers = {};\n    }\n\n    async load() {\n        if (!this.loadModel || !this.showModel || !this.hideModel) {\n            console.error('One of ModelSheetTransition callbacks is missing.');\n            return false;\n        }\n\n        this.cache = this.getCache();\n\n        if (!this.cache.nodesAndViewports) {\n            this.cache.nodesAndViewports = new Map();\n        }\n\n        if (!this.cache.transformedModels) {\n            this.cache.transformedModels = new Map();\n        }\n\n        this.extendLocalization(locales);\n\n        this.viewportsExtension = await this.viewer.loadExtension('Autodesk.AEC.ViewportsExtension');\n\n        this.viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT, this.updateUI);\n        this.viewer.addEventListener(Autodesk.Viewing.MODEL_REMOVED_EVENT, this.updateUI);\n        this.viewportsExtension.addEventListener(Autodesk.AEC.ViewportsExtension.Events.VIEWPORT_DATA_FETCHED_EVENT, this.onViewportDataFetched);\n\n        this.viewer.addEventListener(Autodesk.Viewing.EXTENSION_LOADED_EVENT, this.onExtensionLoaded);\n        this.viewer.addEventListener(Autodesk.Viewing.EXTENSION_UNLOADED_EVENT, this.onExtensionUnloaded);\n\n        // Call onExtensionLoaded manually in order to check if the extension was already loaded.\n        this.onExtensionLoaded({ extensionId: LevelsExtensionId });\n\n        return true;\n    }\n\n    unload() {\n        this.viewer.removeEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT, this.updateUI);\n        this.viewer.removeEventListener(Autodesk.Viewing.MODEL_REMOVED_EVENT, this.updateUI);\n        this.viewportsExtension.removeEventListener(Autodesk.AEC.ViewportsExtension.Events.VIEWPORT_DATA_FETCHED_EVENT, this.onViewportDataFetched);\n\n        this.viewer.removeEventListener(Autodesk.Viewing.EXTENSION_LOADED_EVENT, this.onExtensionLoaded);\n        this.viewer.removeEventListener(Autodesk.Viewing.EXTENSION_UNLOADED_EVENT, this.onExtensionUnloaded);\n\n        // Call onExtensionUnloaded manually in order to simulate the unloading of the extension.\n        this.onExtensionUnloaded({ extensionId: LevelsExtensionId });\n\n        this.hideSelectedSheet();\n\n        this.destroyUIFor2D();\n        this.destroyUIFor3D();\n\n        this.viewer = null;\n        this.options = null;\n\n        return true;\n    }\n\n    onViewportDataFetched() {\n        // Create UI according to new viewport data.\n        this.updateUI({ resetTransformAndViewport: false });\n    }\n\n    async updateUI({ resetTransformAndViewport = true } = {}) {\n        const model2D = getSuitable2DModel(this.viewer);\n\n        if (model2D) { // A suitable 2D model is only returned in 2D mode\n            this.destroyUIFor3D();\n            this.createUIfor2D();\n\n            this.resetModelIfNeeded(model2D, resetTransformAndViewport);\n\n            // updateUI is called whenever there's new viewport data, so this function\n            // will return from the cached data.\n            const viewports = this.getViewportsForModel(model2D);\n            \n            if (viewports.length) {\n                // Currently, only latest viewport is used\n                const vp = viewports[viewports.length - 1];\n                \n                try {\n                    // For a viewport from service, check there's permissions for file (and that it hasn't been deleted)\n                    // This call will throw in those cases.\n                    if (vp instanceof Autodesk.AEC.ViewportsExtension.AlignmentServiceViewport) {\n                        await vp.getRelatedModel3DInfo();\n                    }\n                    \n                    this.setButtonEnabled(true);\n                } catch (e) {\n                    this.setButtonEnabled(false);\n                }\n            } else {\n                this.setButtonEnabled(false);\n            }\n        } else {\n            this.destroyUIFor2D();\n\n            if (!this.viewer.impl.is2d) { // Is 3D\n                this.createUIfor3D();\n\n                // Add / Remove markers according to current viewer state.\n                this.viewer.getHiddenModels().forEach(this.removeMarkersForModel);\n                this.viewer.getVisibleModels().forEach(this.addMarkersForModel);\n            }\n        }\n    }\n\n    /**\n    * Invoked by the viewer when the toolbar UI is available.\n    *\n    * @param {Autodesk.Viewing.UI.ToolBar} toolbar - toolbar instance.\n    *\n    * @alias Autodesk.Viewing.Extensions.ModelSheetTransitionExtension#onToolbarCreated\n    */\n    onToolbarCreated(toolbar) {\n        this.updateUI();\n    }\n\n    /**\n    * @private\n    */\n    createUIfor2D() {\n        const toolbar = this.viewer.getToolbar && this.viewer.getToolbar();\n\n        if (!toolbar || this.toolbarButton) {\n            return;\n        }\n\n        const toolbarGroup = toolbar.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID);\n        if (!toolbarGroup) {\n            return;\n        }\n\n        // Create the button first.\n        this.toolbarButton = new Autodesk.Viewing.UI.Button('toolbar-model-sheet-transition');\n        this.toolbarButton.setToolTip('Fetching alignment information...');\n        this.toolbarButton.setIcon('viewericon-model-sheet-transition');\n        this.toolbarButton.setState(Autodesk.Viewing.UI.Button.State.DISABLED);\n        this.toolbarButton.onClick = async () => {\n            if (this.transitionStarted) {\n                return;\n            }\n\n            this.transitionStarted = true;\n            const model = getSuitable2DModel(this.viewer);\n            if (!model) {\n                console.warn('No suitable 2D model found for sheet to model transition');\n                return;\n            }\n            this.setButtonEnabled(false, true);\n            await this.sheetToModel.transition2Dto3D(model);\n            this.cache.transformedModels.set(model, model); // Save the model in cache to restore its state later (showing page, clear transform, etc.)\n            this.setButtonEnabled(true, true);\n\n            this.transitionStarted = false;\n        };\n\n        toolbarGroup.addControl(this.toolbarButton);\n    }\n\n    setButtonEnabled(enabled, supported = enabled) {\n        if (!this.toolbarButton) {\n            return;\n        }\n\n        const supportedTooltip = 'View drawing in 3D';\n        const unsupportedTooltip = 'Current view is not supported by View drawing in 3D';\n\n        this.toolbarButton.setState(enabled ? Autodesk.Viewing.UI.Button.State.INACTIVE : Autodesk.Viewing.UI.Button.State.DISABLED);\n        this.toolbarButton.setToolTip(supported ? supportedTooltip : unsupportedTooltip);\n    }\n\n    /**\n    * @private\n    */\n    destroyUIFor2D() {\n        if (!this.toolbarButton) {\n            return;\n        }\n\n        const toolbar = this.viewer.getToolbar && this.viewer.getToolbar();\n        if (!toolbar) {\n            return;\n        }\n\n        this.toolbarButton.removeFromParent();\n        this.toolbarButton = null;\n    }\n\n    /**\n     * @private\n     */\n    createUIfor3D() {\n        if (this.ui3DCreated) {\n            return;\n        }\n\n        const onHide = () => {\n            if (!this.markers) {\n                return;\n            }\n\n            for (let key in this.markers) {\n                this.markers[key].setDefaultStyle();\n            }\n\n            // When exiting the context menu, remove any bounds plane\n            this.boundsPlane.lock = false;\n            this.boundsPlane.setVisible(false);\n        };\n\n        this.ui3D = (this.options.ui3D && new this.options.ui3D(onHide)) || new ModelSheetGenericUI(this.viewer, onHide);\n        \n        this.boundsPlane = new BoundsPlane(this.viewer, OverlayName);\n        \n        // For each 3D model in scene, search for viewports in AEC model data. TODO: Also search in alignment service.\n        const models3D = this.viewer.impl.get3DModels();\n\n        models3D.forEach(this.addMarkersForModel);\n\n        this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.updateMarkersClientLocation);\n        this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.updateMarkersClientLocation);\n        this.viewer.addEventListener(Autodesk.Viewing.MODEL_VIEWPORT_BOUNDS_CHANGED_EVENT, this.updateMarkers);\n        this.viewer.addEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT, this.updateMarkers);\n\n        this.ui3DCreated = true; \n    }\n\n    async addMarkersForModel(model) {\n        if (!model.is3d() || !model.getDocumentNode()) {\n            return;\n        }\n\n        const relatedViewports = this.getViewportsForModel(model);\n\n        // If we are during model to sheet transition - there is no need to add 3D markers, since they will soon be gone anyway.\n        if (this.duringModelToSheetTransition) {\n            return;\n        }\n\n        // Make sure the model is still visible.\n        if (!this.viewer.impl.findModel(model.id)) {\n            return;\n        }\n\n        // Remove any markers that don't exist anymore\n        const vpKeys = relatedViewports.map(vp => vp.getGuid());\n        const keysToRemove = this.getMarkersKeysForModel(model).filter(key => !vpKeys.includes(key));\n        \n        keysToRemove.forEach(key => this.removeMarker(key));\n\n        // Add new markers\n        relatedViewports.forEach(vp => {\n            const vpGuid = vp.getGuid();\n\n            // Marker already exists for this viewport.\n            if (this.markers[vpGuid]) {\n                return;\n            }\n\n            const marker = new ModelSheet3DMarker(this, vp, model, this.ui3D, this.areMarkersVisible);\n            this.markers[vpGuid] = marker;\n\n            // In case that we just created the marker of the currently selected viewport - make it selected.\n            if (this.getSelectedViewportGuid() === vpGuid) {\n                marker.setMarkerSelected(true);\n            }\n        });\n    }\n\n    getSelectedViewportGuid() {\n        const isGuid = typeof this._selectedViewportOrGuid === 'string';\n\n        return isGuid ? this._selectedViewportOrGuid : this._selectedViewportOrGuid?.getGuid();\n    }\n\n    getSelectedViewport() {\n        const isGuid = typeof this._selectedViewportOrGuid === 'string';\n\n        if (!isGuid) {\n            return this._selectedViewportOrGuid;\n        }\n\n        // If it's a guid, need to search the corresponding viewport\n        const vp = this.viewportsExtension.findViewportByGuid(this._selectedViewportOrGuid);\n\n        if (vp) {\n            // Update so we don't need to search again\n            this._selectedViewportOrGuid = vp;\n\n            return vp;\n        }\n\n        return null;\n    }\n\n    setSelectedViewport(viewportOrGuid) {\n        this._selectedViewportOrGuid = viewportOrGuid;\n    }\n\n    removeMarkersForModel(model) {\n        if (!model.getDocumentNode()) {\n            return;\n        }\n\n        const keys = this.getMarkersKeysForModel(model);\n\n        keys.forEach(key => this.removeMarker(key));\n    }\n\n    // Returns an array with the keys for this model\n    getMarkersKeysForModel(model) {\n        if (!model.is3d()) {\n            return [];\n        }\n\n        return Object.keys(this.markers).filter(key => {\n            const marker = this.markers[key];\n            return marker.model3D === model;\n        });\n    }\n\n    removeMarker(key) {\n        this.markers[key].destroy();\n        delete this.markers[key];\n    }\n\n    async showSheetAndSetTransform(node, viewport, model3D) {\n        this.setSelectedViewport(viewport);\n\n        const model = await this.loadModel(node);\n\n        this.cache.transformedModels.set(model, model); // Save the model in cache to restore its state later (showing page, clear transform, etc.)\n\n        const unitScale = model.getUnitScale();\n        const viewportBounds = viewport.getViewportBounds(unitScale);\n        let matrix = viewport.get2DTo3DMatrix(unitScale);\n\n        if (viewport.isMatrixInLocalCoords()) {\n            const model3DMatrix = model3D.getModelToViewerTransform();\n\n            if (model3DMatrix) {\n                matrix = (new THREE.Matrix4()).multiplyMatrices(model3DMatrix, matrix);\n            }\n        }\n        \n        model.setPlacementTransform(matrix);\n        model.setViewportBounds(this.viewer.impl.matman(), viewportBounds);\n\n        const clearSelectedFloor = viewport.isTopViewViewport();\n        setCutPlane(this.viewer, matrix, clearSelectedFloor);\n        \n        model.changePaperVisibility(false);\n        this.viewer.impl.setDoNotCut(model, true);\n\n        // Show model only when everything is ready\n        this.showModel(node);\n\n        return model;\n    }\n\n\n    hideSelectedSheet() {\n        this.selectedMarker?.hideSheet();\n    }\n\n    onMarkerSelected(marker) {\n        // Hide previously selected node\n        this.hideSelectedSheet();\n\n        this.selectedMarker = marker;\n    }\n\n    onMarkerDeselected(marker) {\n        // Make sure that another marker hasn't taken the spot first\n        if (marker === this.selectedMarker) {\n            this.selectedMarker = null;\n        }\n    }\n\n    setAllMarkersVisible(isVisible) {\n        if (this.areMarkersVisible === isVisible) {\n            return;\n        }\n\n        this.areMarkersVisible = isVisible;\n\n        for (let key in this.markers) {\n            this.markers[key].setVisible(isVisible);\n        }\n    }\n\n    hideSheet(node) {\n        this.setSelectedViewport(null);\n        const model = this.viewer.impl.findModel(node);\n        \n        if (model) {\n            resetModelTransformAndViewport(this.viewer, model);\n        }\n        \n        this.hideModel(node);\n    }\n    \n    /**\n     * @private\n     */\n    destroyUIFor3D() {\n        if (!this.ui3DCreated) {\n            return;\n        }\n\n        this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.updateMarkersClientLocation);\n        this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.updateMarkersClientLocation);\n        this.viewer.removeEventListener(Autodesk.Viewing.MODEL_VIEWPORT_BOUNDS_CHANGED_EVENT, this.updateMarkers);\n        this.viewer.removeEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT, this.updateMarkers);\n        \n        for (let key in this.markers) {\n            this.markers[key].destroy();\n        }\n\n        this.boundsPlane.destroy();\n        this.boundsPlane = null;\n\n        this.markers = {};\n        this.selectedMarker = null;\n        this.setSelectedViewport(null);\n\n        this.ui3DCreated = false;\n    }\n\n    // Update the element's location when the camera moves\n    updateMarkersClientLocation() {\n        if (!this.markers) {\n            return;\n        }\n\n        for (let key in this.markers) {\n            this.markers[key].updateClientLocation();\n        }\n    }\n\n    // When the bounds move, the marker's world position needs to be readjusted\n    updateMarkers() {\n        if (!this.markers) {\n            return;\n        }\n\n        for (let key in this.markers) {\n            this.markers[key].update();\n        }\n    }\n\n    // If this model was changed due to a transition, reset those changes\n    resetModelIfNeeded(model, resetTransformAndViewport = true) {\n        if (!this.cache.transformedModels.has(model)) {\n            return false;\n        }\n\n        if (resetTransformAndViewport) {\n            // Set camera to a top view position. The initial value is not important,\n            // since fitToBounds will fix that afterwards.\n            this.viewer.navigation.setView(this.defaultPosition2D, this.defaultTarget2D);\n            this.viewer.navigation.orientCameraUp(true);\n\n            resetModelTransformAndViewport(this.viewer, model);\n            fitToBounds(this.viewer, model);\n        }\n\n        // Make sure home view is synced (since we are changing the transform after the model has been added)\n        // Wait for next frame to make sure view is updated\n        setTimeout(() => this.viewer.impl.controls.recordHomeView());\n\n        this.cache.transformedModels.delete(model);\n\n        return true;\n    }\n\n    async getViewportsForModelAsync(model) {\n        let viewports = await this.viewportsExtension.getViewportsAsync(model.getDocumentNode(), { onlyTopViewPlans: false });\n\n        if (this.options.useOnlyAecModelDataViewports) {\n            viewports = viewports.filter(viewport => viewport instanceof Autodesk.AEC.ViewportsExtension.AecModelDataViewport);\n        }\n\n        return viewports;\n    }\n\n    getViewportsForModel(model) {\n        let viewports = this.viewportsExtension.getViewports(model.getDocumentNode(), { onlyTopViewPlans: false });\n                \n        if (this.options.useOnlyAecModelDataViewports) {\n            viewports = viewports.filter(viewport => viewport instanceof Autodesk.AEC.ViewportsExtension.AecModelDataViewport);\n        }\n\n        return viewports;\n    }\n\n    // Given a 2D sheet (and optionally a viewport guid), returns a bubbleNode of the 3D node that it's attached to.\n    async getNodeAndViewport(model2D, vpGuid) {\n        const viewports = await this.getViewportsForModelAsync(model2D);\n\n        // For now we don't have the option to select a viewport, so always take the latest one\n        const viewport = vpGuid ?\n            viewports.find(vp => vp.getGuid() === vpGuid) :\n            viewports[viewports.length - 1];\n\n        if (!this.cache.nodesAndViewports.has(viewport)) {\n            const nodes = await viewport.get3DNodesForViewport();\n            const bubbleNode3D = nodes[0];\n\n            model2D.regionId = viewport.getGuid(); // Save in model, in case the sheet is realigned (so it won't create a new region)\n\n            this.cache.nodesAndViewports.set(viewport, { viewport, bubbleNode: bubbleNode3D });\n        }\n\n        return this.cache.nodesAndViewports.get(viewport);\n    }\n\n    // Default displayError function. Can be overriden through options\n    _displayError(message) {\n        Autodesk.Viewing.Private.AlertBox.displayError(this.viewer.container, message, 'Model Sheet Transition');\n    }\n\n    async transitionModelToSheet(model) {\n        this.duringModelToSheetTransition = true;\n        this.destroyUIFor3D();\n        await this.modelToSheet.transition3Dto2D(model);\n        this.duringModelToSheetTransition = false;\n    }\n\n    onExtensionLoaded({ extensionId }) {\n        if (extensionId === LevelsExtensionId) {\n            const levelsExtension = this.viewer.getExtension(LevelsExtensionId);\n\n            // Register to SELECTED_FLOOR_CHANGED event only if LevelsExtension is being loaded eventually.\n            if (levelsExtension) {\n                levelsExtension.floorSelector.addEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED, this.onSelectedFloorChanged);\n            }\n        }\n    }\n\n    onExtensionUnloaded({ extensionId }) {\n        if (extensionId === LevelsExtensionId) {\n\n            const levelsExtension = this.viewer.getExtension(LevelsExtensionId);\n\n            if (levelsExtension) {\n                levelsExtension.floorSelector?.removeEventListener(Autodesk.AEC.FloorSelector.SELECTED_FLOOR_CHANGED, this.onSelectedFloorChanged);\n            }\n        }\n    }\n\n    onSelectedFloorChanged() {\n        // In case that we are currently viewing a top-view viewport (z aligned), and a level was\n        // selected by the levels extension, clean the section plane that we applied for the viewport.\n        // Otherwise we might get a scenario when the entire model is cut.\n        if (this.getSelectedViewport()?.isTopViewViewport()) {\n            const sectionExtension = this.viewer.getExtension('Autodesk.Section');\n            sectionExtension?.setSectionFromPlane(null);\n        }\n    }\n}\n\nnamespace.ModelSheetTransitionExtension = ModelSheetTransitionExtension;\nnamespace.AnalyticsEventName = AnalyticsEventName;\n\n// Register the extension with the extension manager.\nAutodesk.Viewing.theExtensionManager.registerExtension(extensionName, ModelSheetTransitionExtension);\n"],"sourceRoot":""}