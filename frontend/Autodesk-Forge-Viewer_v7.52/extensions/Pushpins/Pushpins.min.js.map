{"version":3,"sources":["webpack://Autodesk.Extensions.[name]/webpack/bootstrap","webpack://Autodesk.Extensions.[name]/./node_modules/css-loader/lib/css-base.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/addStyles.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/urls.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinExtension.css?4b73","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinExtension.css","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinEvents.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins3D/PushPinViewerState.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinConstants.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinItem.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUtils.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinManager.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinLabel/HTMLPushPinLabel.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinLabel/PushPinBillboardLabel.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins2D/PushPinBillboardTool2D.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinInputHandler.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins2D/RenderHandler2D.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins3D/PushPinBillboardTool3D.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins3D/RenderHandler3D.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinTools.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUi/PushPinVisButtonBase.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUi/IssuePushPinVisButton.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUi/RfiPushPinVisButton.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUi/QualityIssuePushPinVisButton.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinObserver.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinLegacyFallback.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinLocales.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinExtension.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","useSourceMap","list","toString","this","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","sourceURLs","sources","source","sourceRoot","concat","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","length","id","push","fn","memo","stylesInDom","isOldIE","window","document","all","atob","apply","arguments","getTarget","target","parent","querySelector","getElement","styleTarget","HTMLIFrameElement","contentDocument","head","e","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","options","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createElement","undefined","attrs","type","nonce","getNonce","addAttrs","el","keys","forEach","setAttribute","obj","update","remove","result","transform","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","updateLink","href","applyToTag","newObj","DEBUG","newList","mayRemove","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","location","baseUrl","protocol","host","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","locals","v","eye","orthographicHeightVector","PUSHPIN_EVENTS","PUSH_PIN_EDIT_START_EVENT","PUSH_PIN_EDIT_END_EVENT","PUSH_PIN_PREPARING_THUMBNAIL","PUSH_PIN_CREATED_EVENT","PUSH_PIN_SELECTED_EVENT","PUSH_PIN_REMOVED_EVENT","PUSH_PIN_REMOVE_ALL_EVENT","PUSH_PIN_MODIFY_EVENT","PUSH_PIN_UPDATE_EVENT","PUSH_PIN_VISIBILITY_EVENT","PUSH_PIN_ITEMS_LOADED","PUSH_PIN_CLICKED_EVENT","PUSH_PIN_SELECT_NONE","applyOffsetToCamera","viewport","offset","Number","x","y","z","pivotPoint","applyOffsetToCutplanes","cutplanes","normal","THREE","Vector3","cutplane","toVector","dot","restoreViewState","viewer","immediate","data","viewerState","amendedData","globalOffset","model","getData","state","parse","invGlobalOffset","getAttributesVersion","findModel","modelTransform","getModelTransform","transformViewerState","objectSet","amendViewportIfNeeded","visibleModels","getVisibleModels","seedUrn","getSeedUrn","onlySingleModel","seedURN","isolatedItems","isolated","k","isNodeExists","restoreState","navapi","navigation","updateCamera","getCamera","updateMatrixWorld","src","dst","transformPoint","values","tf","applyMatrix4","toArray","transformNormal","normalMatrix","Matrix3","getNormalMatrix","applyMatrix3","normalize","transformOrthographicHeight","subVectors","multiplyScalar","orthographicHeight","copy","add","distanceTo","isOrthographic","up","worldUpVector","plane","Plane","constant","set","statusHexValues","moveableIcon","markerOffsets","namespace","AutodeskNamespace","decodeUrn","urn","getLineageId","encodedUrn","split","decodedPart","console","error","start","end","substring","findMatchingModel","models","issueLineageId","myData","_nextPushPinId","PushPinItem","itemData","label","status","position","objectId","externalId","objectData","locationIds","selected","isVisible","draggable","selectable","normalSize","selectedSize","draggableStatus","selectedStatus","assign","correctDataFormat","modelTf","placementWithOffset","placementTf","placementTransform","localData","modelLocalToViewer","modelLocalToWorld","viewerToModelLocal","Matrix4","getInverse","worldToModelLocal","dbId","res","documentNode","getDocumentNode","docNodeData","guid","viewableId","viewableID","viewName","newPos","attributesVersion","originalDocumentResolution","setViewerState","hasPosition","computeMaxLevel","w","h","lx","Math","ceil","log2","ly","max","clientToWorldLeaflet","loadOptions","bounds","isPdf","Autodesk","Viewing","PDFUtils","getLeafletLoadOptions","getLeafletBoundingBox","modelData","bbox","texWidth","texHeight","worldPos","clientToWorld","point","worldTopLeft","min","sub","newX","size","newY","maxLevel","scale","pow","px","py","isLeaflet","applyPdfWorldScaling","clientPos","worldToClient","originalDocumentWidth","dpiCorrection","wx","wy","leafletToPdfWorld","impl","convertPdfToLeaflet","pdfToLeafletWorld","invertModelTransform","PushPinManager","EventDispatcher","pushPinList","selectedItem","PushPinTypes","ISSUES","RFIS","QUALITY_ISSUES","is2D","is2d","modelBB","getBoundingBox","worldUp","worldUpName","isPseudo2D","disableOcclusionTest","pushPinsVisibilityByType","getInitialPushpinVisibilityByType","pushpinsByType","getInitialPushpinsByType","Promise","resolve","onPushpinEditStartBinded","onPushpinEditStart","onPushpinEditEndBinded","onPushpinEditEnd","addEventListener","cache","issueTypeKey","typeKey","generateIssueThumbnail","generateRFIThumbnail","shouldGenerateThumbnail","reject","width","height","zoomRatio","pWorld","markerPos","fireEvent","canvasBounds","getCanvasBoundingClientRect","floor","thumbnailSizeWorld","zeroWorld","isPageCoordinates","Box3","expandByPoint","expandByVector","getCropBounds","camera","cropCenter","thumbnailSize","clientBounds","overlayRenderer","ctx","screenshotCamera","onRenderDone","canvas","targetToCanvas","ctx2d","getContext","fillStyle","beginPath","arc","PI","closePath","fill","ScreenShot","getScreenShotWithBounds","outputWidth","outputHeight","blobToImage","img","catch","intersectedLocationIds","getLocationIdsAtPoint","setLocationIds","isTriggeringEvent","createFromLocal","getItemById","newItem","setLocal","addItem","then","setItemLocationIds","generateThumbnail","thumbnail","dataArray","pushPinData","createItem","getItemIndexById","visible","unshift","pushPinTypeObject","removeItemById","every","reTriggerEvent","triggerSelectionEvent","oldOne","selectOne","event","func","hasEventListener","getExtension","getExtensionAsync","explodeExt","setUIEnabled","pushpinEditStarted","getLocationsExtensionAsync","locationsExtension","showLocations","showAllLocations","hoverLocationsByIds","highlightPausedBackup","isHighlightPaused","pauseHighlight","getLocationsExtension","hideAllLocations","onMouseMove","_document","getGlobal","HTMLPushPinLabel","container","className","text","dirty","textString","innerHTML","bgWidth","clientWidth","top","left","clientHeight","PushPinBillboardLabel","marker","labelText","createLabel","TOP_PADDING","display","av","PushPinBillboardTool2D","names","setGlobalManager","globalManager","active","pushpins","selectedPushpin","curCameraZ","curCameraRotationZ","tmpVec","tmpMatrix","getName","onCameraChangeBinded","onCameraChange","handleResizeBinded","handleResize","CAMERA_CHANGE_EVENT","VIEWER_RESIZE_EVENT","createMarkerContainer","removeEventListener","toPrecision","rotation","updatePushpinsProjection","updateContainerProjection","pushpinContainer","appendOrderedElementToViewer","pushpin","intersectPoint","containerBounds","getScreenViewport","multiplyMatrices","projectionMatrix","matrixWorldInverse","applyProjection","round","unproject","convertLeafletPosition","setOriginalDocumentResolution","createMarker","enableDragging","disableDragging","showMarker","hideMarker","initNewPushpin","selectPushpin","getDocument","classList","backgroundColor","boxShadow","setMarkerPosition","setPushpinContainerPosition","newPosX","newPosY","curPushpin","destroyMarker","removePushpin","destroyLabel","xTranslate","yTranslate","initPos","project","hex","newPosition","updatedPosition","offsetWidth","updatePushpin","redraw","xPos","yPos","deselect","clearSelection","pointerEvents","backgroundImage","button","setTimeout","GlobalManagerMixin","PushPinInputHandler","pushpinRenderer","mousePosition","onTouchDragBinded","onTouchDrag","onMouseMoveBinded","onMouseUpBinded","onMouseUp","onMouseDownBinded","onMouseDown","onHammerInputBinded","onHammerInput","mouseEnabled","mousePrevValue","lock","shiftKey","clientX","pointers","clientY","detach","isTouchDevice","hammer","Hammer","Manager","recognizers","GestureRecognizers","drag","inputClass","isIE11","PointerEventInput","TouchInput","on","isMobileDevice","enableMouseButtons","setMouseDisabledWhenTouching","isFirst","isFinal","destroy","processMouseEvent","handleMouseMove","preventDefault","handleMouseDown","handleMouseUp","convertEventHammerToMouse","RenderHandler2D","viewerApi","pushPinManager","pushpinDirty","onSelectedChangedBind","onSelectedChanged","onRemoveBind","onRemove","onRemoveAllBind","onRemoveAll","onModifyBind","onModify","onUpdateBind","onUpdate","createBind","onVisibilityChangedBind","onVisibilityChanged","pushpinBillboardTool","toolController","registerTool","deregisterTool","isActive","activateTool","inputHandler","setCreateFunction","deactivateTool","removeCreateFunction","focusCameraOnSelectedItem","enableItemDragging","dispatchEvent","deselectItem","setPushpinDirty","removeAll","showMarkers","setDirty","getSelectedItem","disableItemDragging","attachTo","createRenderItem","isIOSDevice","reselect","promise","isLoaded","loadPushpin","createPushpin","updateStyle","modelBounds","utilities","modelWidth","modelHeight","fitBounds","restoreViewerStateImmediate","items","reverse","mouseX","mouseY","hitItem","some","bb","getBoundingClientRect","self","startDragging","mousePos","ev","pageX","pageY","body","scrollLeft","clientLeft","scrollTop","clientTop","mouseCoords","mouseOffset","wi","hi","containerPosX","containerPosY","dragging","hoverLocations","render","tagName","toLowerCase","offsetParent","offsetLeft","offsetTop","getOffset","PushPinBillboardTool3D","raycastLimitPerSecond","maxMsPerRayCastCycle","updateTimestamp","tmpFrustum","Frustum","raycastThrottle","throttle","continueRayCasts","stamp","performance","now","castRay","MODEL_TRANSFORM_CHANGED_EVENT","callback","wait","context","timeout","callbackArgs","later","updatePushpins","applyModelTransform","setFromMatrix","containsPoint","getProperties2","props","startsWith","endsWith","parsedExternalId","Array","isArray","isOTG","fileExt","ifcId","properties","find","displayName","displayCategory","displayValue","parentDbId","fetchExternalId","message","Private","logger","warn","needsExternalId","getState","generateMetadata","vpVec","clientToViewport","castRayViewport","setObjectId","setObjectData","setExternalId","parseInt","isNaN","opacity","hide","RenderHandler3D","onSectionBind","onSection","CUTPLANES_CHANGE_EVENT","sectionExt","getSectionPlanes","setSectionFromPlane","setCutPlaneSet","intersectGround","setSeedUrn","docPos","getPosition","getMouseOffset","PushPinTool","priority","pushpinCursor","pushPinInitData","createMode","testId","autoCreate","auto","isHover","renderTool","register","deregister","activate","show","duringShowing","enable","controller","getActiveToolName","enablePushPinSelect","pushPin","canvasX","canvasY","createTwoPushPin","createThreePushPin","handleSingleClick","findIntersections","pressedItem","checkPushpinClick","triggered","triggerPushpinClick","selectNone","createPushPin","addDocumentEventListener","handler","stopPropagation","removeDocumentEventListener","hoveredItem","PushPinVisButton","extension","initiallyHidePushpins","pushpinVisBtn","setButtonConstants","buttonConstants","btnClass","btnLabel","noPushpinLabel","hidePushpinLabel","showPushpinLabel","pushpinNormalIcon","pushpinHideIcon","btn","UI","Button","setToolTip","i18n","translate","setIcon","onClick","State","DISABLED","setState","INACTIVE","ACTIVE","showAll","tool","showByType","hideByType","getToolbar","toolbar","modelTools","getControl","TOOLBAR","MODELTOOLSID","navigationBar","NAVTOOLSID","toolbarOptions","ControlGroup","addControl","createButton","Event","STATE_CHANGED","onPushpinVisBtnStateChange","updateButtonStatus","issuePushpinCount","getItemCountByType","issueButtonDisable","removeFromParent","IssuePushPinVisButton","RfiPushPinVisButton","QualityIssuePushPinVisButton","_window","PushPinMobileObserver","pushpinManager","addListeners","messageName","pushPinItem","metadata","webkit","messageHandlers","callbackHandler","postMessage","command","JSINTERFACE","BIM360","Extension","PushPin","isOldDCPushPin","boxData","box","fromArray","minXYZ","maxXYZ","getModelLocalBox","distanceToPoint","getUnitScale","viewerBox","applyLegacyFallback","fixOldDCPushPin","locales","en","cs","de","es","fr","it","ja","ko","pl","ru","tr","nl","sv","da","no","PushPinExtension","extendLocalization","onModelAdded","onModelRemoved","MODEL_ADDED_EVENT","MODEL_REMOVED_EVENT","destroyUI","destroyPushpinManager","destroyTool","initPushpinManager","initTool","createUI","Events","PUSH_PIN_MANAGER_INITIALIZED","PUSH_PIN_MANAGER_DESTROYED","observer","removeAllItems","startCreateItem","updateButtonsStatus","endCreateItem","updatePattern","pushPinDatas","is3d","addItems","blockEvent","pushpinsData","pushpinData","legacyToLocalPushPinData","loadItemFromLocal","updateItemById","isDraggable","cancelPositionChange","setPosition","origItemPosition","removeItemsByType","uiButtons","hideIssuesButton","initiallyHideIssuesPushpins","hideFieldIssuesButton","initiallyHideFieldIssuesPushpins","hideRfisButton","initiallyHideRfisPushpins","uiButton","addButton","MODEL_ROOT_LOADED_EVENT","enableVisButton","destroyButton","setVisibleByType","useLegacyFallback","getLocal","pMin","pMax","getLegacyGlobalOffset","localToLegacyPushPinData","getLegacyPushPinData","PUSH_PIN_EXT_NAME","theExtensionManager","registerExtension"],"mappings":"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","file":"Pushpins/Pushpins.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 832);\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./PushPinExtension.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./PushPinExtension.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./PushPinExtension.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@font-face{font-family:'issueicon';src:url(data:application/font-woff;charset=utf-8;base64,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);font-weight:normal;font-style:normal}[class^=\\\"issueicon-\\\"],[class*=\\\" issueicon-\\\"]{font-family:'issueicon';font-style:normal;font-weight:normal;font-variant:normal;line-height:1;padding-top:2px;speak:none;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}@font-face{font-family:'rfiicon';src:url(data:application/font-woff;charset=utf-8;base64,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);font-weight:normal;font-style:normal}[class^=\\\"rfiicon-\\\"],[class*=\\\" rfiicon-\\\"]{font-family:'rfiicon';font-style:normal;font-weight:normal;font-variant:normal;line-height:1;padding-top:2px;speak:none;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}@font-face{font-family:'fieldissueicon';src:url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUAAA0AAAAAByQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAE5AAAABwAAAAcfzoDmUdERUYAAATIAAAAGwAAAB4AJwALT1MvMgAAAZwAAABKAAAAYC+xTDxjbWFwAAAB+AAAAEQAAAFKwBQjvWdhc3AAAATAAAAACAAAAAj//wADZ2x5ZgAAAkgAAAFeAAABhPocpV5oZWFkAAABMAAAADAAAAA2DEAuiWhoZWEAAAFgAAAAHAAAACQEIwIFaG10eAAAAegAAAAQAAAAEgYAAABsb2NhAAACPAAAAAwAAAAMAFgAwm1heHAAAAF8AAAAHgAAACAATgBKbmFtZQAAA6gAAADjAAAB47FU88Bwb3N0AAAEjAAAADIAAABR2shGr3icY2BkYGAA4uk3ErPi+W2+MnAzMYDAVZ+8TjB9te4fkGJnYmAE0RwMYGkALxEKOXicY2BkYGD8wsDAoMfEAAJAkpEBFbAAACM+AS54nGNgZGBgYGVwZ2BnAAEmIGZkAIk5gPkMAApQAJkAAHicY2BmYmCcwMDKwMHow5jGwMDgDqW/MkgytDAwMDGwcjLAgQCCyRCQ5prC4PCA8QET44P/Dxj0GL/8/wIUZkRSosDACAAr1Q1fAAB4nGNigAAmKGZgAAAAVgAHeJzdisEJwDAQw+RLyRR59NlBuv8M2STxpaWQFSowRiCg8Kwhktum5QeXv/pFQI8xMujKP+PtjSqfyGXWG+L3TGW0BrEAAAAAAAAAAABYAMJ4nG2PvU7CUBiGv4+fcyhwSiH0HAg/ASptKLQ1LaVoDTHGOOjohAnizwW46AU4GBNnZx2dZfQKSJzYvQYHE1fi0dnhXZ68w/NAGgBoAvAWmmDDCLZhAhC5SSua0MAXhtlHF40O0ctchC6Gw5GkhBrC53qgG2EggdCDkMp9j+db7RSheV20Nmy/9nRRV6unuaDdiwOz0rLqdkml/kJhfCGYwh3HOUuYoVvMKKxS4kU1c8eb3bhnjdOdVLdas7okL3/LpcIG0+mV48Cvq1wev3ANJWhDD3zpuwcHAGgW0JSilAtKBPcjHKX/ZKmEDaRDUxgdK+IxRjIj4sI06D8N+K5q56PK8UO7GR8WCqRI8Flbv04GZdYgzX4jcY2e45WrOMfkbtTKcZFllTfBssLzPPzUtEt2sh8PjrQCIfiifvR3aN1ukDqtPmpu7h4JToxN5rHsapVl7mx247o/vPQ77AAAeJyVj8FKw0AURc+0aUAUiht3ltnLhGQgCAXd2U/IFzQtgZJAmv6KOz/IT/ET3HmnPhe6EDrwmDN37rvzBrjhFUdajiXeeEbOs/GcB96MM3k+jBdcu1vjnKV7ktNlV1JW567EM+WXxnMaXowzed6NF9zxaZyzcvec6JnoVAdatgR2DGctUMGpn7rp0G7DbuinIOHX7Y+4MTHtI3sFeSKFxvGsVf8/8u2J1DqliuqreFSs4jfDuG99LEq/9n+GkRLrUIdYVjJf+pFGrpGjOpLLy5PmpWnHYzf0virKizO/AEzyTYUAeJxjYGJABowM6IAVLMrEyMTIzJ+WmZqToptZXFyaqpuZnCeCzM9PSwOK5ecBAP6rDY8AAAAAAAH//wACeJxjYGRgYOABYjEgZmJgBEIWMAbxGAADygAzAAAAAAEAAAAA1BgWEQAAAADVTG6JAAAAANXVfv4=);font-weight:normal;font-style:normal}[class^=\\\"fieldissueicon-\\\"],[class*=\\\" fieldissueicon-\\\"]{font-family:'fieldissueicon';font-style:normal;font-weight:normal;font-variant:normal;line-height:1;padding-top:2px;speak:none;text-transform:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.issueicon-issue_hide:before{content:\\\"\\\\E915\\\"}.issueicon-issue_normal:before{content:\\\"\\\\E916\\\"}.rfiicon-rfi_hide:before{content:\\\"\\\\E003\\\"}.rfiicon-rfi_normal:before{content:\\\"\\\\E002\\\"}.fieldissueicon-issue_hide:before{content:\\\"\\\\E002\\\"}.fieldissueicon-issue_normal:before{content:\\\"\\\\E001\\\"}.leaflet-text-label{display:inherit;font-family:'HelveticaNeue-bold';font-style:normal;font-weight:normal;font-variant:normal;line-height:0;pointer-events:none;text-align:center;font-size:16px;border-radius:.5em;max-width:auto;min-width:60px;height:32px;position:absolute;background-color:rgba(0,0,0,0.7);color:#FFF;border:2px solid white}.leaflet-marker-icon.leaflet-pin-icon{width:40px}.leaflet-text-label span{display:inline-block;vertical-align:middle;line-height:32px;white-space:pre}.leaflet-pushpin-hidden{visibility:hidden}#toolbar-pushpinVis,#toolbar-pushpinRfisVis,#toolbar-pushpinFieldIssuesVis{border:none}.pushpin-billboard-marker{position:absolute;font-size:10px;font-weight:bold;width:22px;height:22px;left:0;top:0;line-height:16px;text-align:center;cursor:pointer;pointer-events:none;color:#1757a8;border:4px solid rgba(255,255,255,0.95);background:#4675A8 no-repeat center;background-size:16px;border-radius:15px;opacity:1;transition:opacity 0.4s;-webkit-transition:opacity 0.4s;will-change:transform}.rfi-billboard-marker{position:absolute;font-size:10px;font-weight:bold;width:22px;height:22px;line-height:16px;text-align:center;cursor:pointer;pointer-events:none;left:0;top:0;color:#1757a8;border:4px solid rgba(255,255,255,0.95);background:#4675A8 no-repeat center;background-size:16px;border-radius:3px;opacity:1;transition:opacity 0.4s;-webkit-transition:opacity 0.4s;will-change:transform}.pushpin-billboard-marker.selected{border:5px solid rgba(255,255,255,0.95);border-radius:20px;background-size:20px;z-index:1;top:-3px;width:28px;height:28px;left:-3px}.rfi-billboard-marker.selected{border:5px solid rgba(255,255,255,0.95);border-radius:4px;background-size:20px;z-index:1;top:-3px;width:28px;height:28px;left:-3px}.pushpin-billboard-marker.grey-out{background-color:#919191 !important;opacity:0.5 !important;cursor:not-allowed}.rfi-billboard-marker.grey-out{background-color:#919191 !important;opacity:0.5 !important;cursor:not-allowed}.pushpin-container{will-change:transform;transform:translateZ(0);left:0;top:0;position:absolute}\\n\", \"\"]);\n\n// exports\n","export const PUSHPIN_EVENTS = {\n    PUSH_PIN_EDIT_START_EVENT: 'pushpin.edit.start',\n    PUSH_PIN_EDIT_END_EVENT: 'pushpin.edit.end',\n    PUSH_PIN_PREPARING_THUMBNAIL: 'pushpin.preparing.thumbnail',\n    PUSH_PIN_CREATED_EVENT: 'pushpin.created',\n    PUSH_PIN_SELECTED_EVENT: 'pushpin.selected',\n    PUSH_PIN_REMOVED_EVENT: 'pushpin.removed',\n    PUSH_PIN_REMOVE_ALL_EVENT: 'pushpin.remove.all',\n    PUSH_PIN_MODIFY_EVENT: 'pushpin.modified', // this will be fired on push pin position changed.\n    PUSH_PIN_UPDATE_EVENT: 'pushpin.update', // this will be fired on an explicit push pin data update.\n    PUSH_PIN_VISIBILITY_EVENT: 'pushpin.visibility.changed',\n    PUSH_PIN_ITEMS_LOADED: 'pushpin.tool.items.loaded',\n\n    // Separate events to distinguish that they are triggered from client by direct API call.\n    // This is a workaround to fix some problems on mobile client.\n    // Mobile is going to rely on this event to get push pin select status.\n    PUSH_PIN_CLICKED_EVENT: 'pushpin.clicked',\n    PUSH_PIN_SELECT_NONE: 'pushpin.select.none'\n};\n","const applyOffsetToCamera = (viewport, offset) => {\n    if (!viewport || !offset) {\n        return;\n    }\n\n    if ('eye' in viewport) {\n        viewport.eye[0] = (Number(viewport.eye[0]) + offset.x).toString();\n        viewport.eye[1] = (Number(viewport.eye[1]) + offset.y).toString();\n        viewport.eye[2] = (Number(viewport.eye[2]) + offset.z).toString();\n    }\n\n    if ('target' in viewport) {\n        viewport.target[0] = (Number(viewport.target[0]) + offset.x).toString();\n        viewport.target[1] = (Number(viewport.target[1]) + offset.y).toString();\n        viewport.target[2] = (Number(viewport.target[2]) + offset.z).toString();\n    }\n\n    if ('pivotPoint' in viewport) {\n        viewport.pivotPoint[0] = (Number(viewport.pivotPoint[0]) + offset.x).toString();\n        viewport.pivotPoint[1] = (Number(viewport.pivotPoint[1]) + offset.y).toString();\n        viewport.pivotPoint[2] = (Number(viewport.pivotPoint[2]) + offset.z).toString();\n    }\n};\n\nconst applyOffsetToCutplanes = (cutplanes, offset) => {\n    if (!cutplanes || !offset) {\n        return;\n    }\n\n    const normal = new THREE.Vector3();\n\n    for (let i = 0; i < cutplanes.length; i++) {\n        const cutplane = cutplanes[i];\n        // A cutplane is an array of 4 numbers. The first 3 numbers represent the plane's normal vector\n        // and the 4th number is the distance along it\n        toVector(cutplane, normal);\n        // Translating a plane by an offset vector is equivalent to adding dot(n,of) where n is the plane normal\n        // This again is equivalent to adding or subtracting dot(n, of) to the constant of the plane\n        // We have plane.constant = -plane.normal.dot(onPlane + globalOffset)\n        //                        = -plane.normal.dot(onPlane) - plane.normal.dot(globalOffset)\n        //                        = oldConstant - plane.normal.dot(globalOffset)\n        cutplane[3] = Number(cutplane[3]) - normal.dot(offset);\n    }\n};\n\nconst amendViewportIfNeeded = (viewer, item) => {\n    const globalOffset = viewer.model ? viewer.model.getData().globalOffset : null;\n    const state = JSON.parse(JSON.stringify(item.data.viewerState));\n\n    if (globalOffset) {\n        const invGlobalOffset = { x: -globalOffset.x, y: -globalOffset.y, z: -globalOffset.z };\n\n        applyOffsetToCamera(state.viewport, invGlobalOffset);\n\n        if (item.getAttributesVersion() >= 2) {\n            applyOffsetToCutplanes(state.cutplanes, invGlobalOffset);\n        }\n    }\n\n    const model = item.findModel(viewer);\n    const modelTransform = model?.getModelTransform();\n\n    if (modelTransform) {\n        transformViewerState(state, modelTransform);\n    }\n\n    //Support legacy edge cases where Viewer state doesn't contain objectState;\n    if (!state.objectSet) {\n        state.objectSet = [];\n    }\n\n    return state;\n};\n\nexport const generateMetadata = (viewer, item) => {\n    const globalOffset = viewer.model ? viewer.model.getData().globalOffset : null;\n    const viewerState = viewer.getState();\n    const state = JSON.parse(JSON.stringify(viewerState));\n\n    // Replace viewerState's seedURN with a specific model's seedURN.\n    // It's needed because viewer.getState() returns always the first model's seedUrn - and not really the relevant model's urn.\n    state.seedURN = item.getSeedUrn() || viewerState.seedURN;\n    \n    if (globalOffset) {\n        applyOffsetToCamera(state.viewport, globalOffset);\n        applyOffsetToCutplanes(state.cutplanes, globalOffset);\n\n        state.globalOffset = globalOffset;\n    }\n\n    const model = item.findModel(viewer);\n    const modelTransform = model?.getModelTransform();\n\n    if (modelTransform) {\n        transformViewerState(state, new THREE.Matrix4().getInverse(modelTransform));\n    }\n\n    return state;\n};\n\nexport const restoreViewState = (viewer, item, immediate) => {\n    if (item.data && item.data.viewerState) {\n        const amendedData = amendViewportIfNeeded(viewer, item);\n        const visibleModels = viewer.getVisibleModels();\n\n        // While restoring Viewer state, check if any of isolated items exist in scene\n        // Remove non-existing dbIds from objectSet inside of Pushpin's viewer state (BLMV-4397)\n        for (let i = 0; i < visibleModels.length; i++) {\n            const seedUrn = visibleModels[i].getSeedUrn();\n            const onlySingleModel = visibleModels.length === 1;\n\n            // Condition that checks if dbId exists before isolating\n            const itemExist = (isolatedItem) => visibleModels[i].isNodeExists(isolatedItem);\n\n            for (let j = 0; j < amendedData.objectSet.length; j++) {\n                // Since Viewer state with single model has no seedUrn within objectSet,\n                // need to check indpendently states with single and multiple models in Viewer state\n                const isSingle = (!amendedData.objectSet[j].seedUrn && onlySingleModel);\n                if (isSingle || amendedData.objectSet[j].seedUrn === seedUrn || amendedData.seedURN === seedUrn) {\n                    const isolatedItems = amendedData.objectSet[j].isolated;\n                    for (let k = 0; k < isolatedItems.length; k++) {\n                        if (!visibleModels[i].isNodeExists(isolatedItems[k])) {\n                            amendedData.objectSet[j].isolated.splice(k, 1);\n                            k--;\n                        }\n                    }\n                }\n            }\n        }\n\n\n        viewer.restoreState(amendedData, null, immediate);\n\n        // RestoreState will async to update camera's all data. Here force update camera before load pushpin.\n        const navapi = viewer.navigation;\n\n        if (navapi) {\n            navapi.updateCamera();\n            const camera = navapi.getCamera();\n\n            camera.updateMatrixWorld();\n        }\n    }\n};\n\n// Convert from array of values (or number-strings) to THREE.Vector.\n// Like THREE.Vector3.fromArray(), but with string->number conversion, because some viewerState values are stored as strings.\nconst toVector = (src, dst) => {\n    dst.x = Number(src[0]);\n    dst.y = Number(src[1]);\n    dst.z = Number(src[2]);\n};\n\n// Transforms a point given as array-3 by a THREE.Matrix4\nconst transformPoint = function() {\n    const v = new THREE.Vector3();\n\n    return (values, tf) => {\n        toVector(values, v);\n        v.applyMatrix4(tf);\n        v.toArray(values);\n    };\n}();\n\n// Transforms a direction vector given as array-3 by a THREE.Matrix4\nconst transformNormal = function() {\n    const v = new THREE.Vector3();\n    const normalMatrix = new THREE.Matrix3();\n\n    return (values, tf) => {\n        toVector(values, v);\n\n        normalMatrix.getNormalMatrix(tf);\n        v.applyMatrix3(normalMatrix);\n        v.normalize(); // Re-normalize, so that scaling doesn't kill normalized directions.\n\n        v.toArray(values);\n    };\n}();\n\n// Transforms orthographic height by using transformed vector distances.\n// Orthographic height may be different from eye/target distance, so we calculate it separately\n// and let the viewerImpl work out which one to use.\n// It is necessary to use this approach because the transform matrix could contain transformations\n// which a naive scalar multiplication wouldn't handle correctly.\nconst transformOrthographicHeight = function() {\n    const eye = new THREE.Vector3();\n    const target = new THREE.Vector3();\n    const orthographicHeightVector    = new THREE.Vector3();\n\n    return (viewport, tf) => {\n        // Convert to THREE.Vectors that we can calculate with as they may be provided as arrays.\n        toVector(viewport.eye, eye);\n        toVector(viewport.target, target);\n\n        // Compute a view-direction vector that is scaled to match orthographicHeight\n        orthographicHeightVector.subVectors(eye, target).normalize().multiplyScalar(viewport.orthographicHeight);\n\n        // Compute new eye vector with distance from target equal to orthographicHeight\n        eye.copy(target).add(orthographicHeightVector);\n\n        // Transform adjusted eye vector and target by the provided model transform.\n        eye.applyMatrix4(tf);\n        target.applyMatrix4(tf);\n\n        // Derive transformed length by getting the distance between the adjusted eye and the target after transform.\n        viewport.orthographicHeight = eye.distanceTo(target);\n    };\n}();\n\nexport const transformViewerState = (state, tf) => {\n    if (!state || !tf) {\n        return;\n    }\n\n    // If we are in orthographic mode and have a real orthographicHeight we need to calculate\n    // a new orthographicHeight using the provided transform.\n    if (state.viewport.isOrthographic && state.viewport.orthographicHeight > 0) {\n        transformOrthographicHeight(state.viewport, tf);\n    }\n\n    // Note that these values are not vectors, but arrays (in some cases even containing string-type-values).\n    transformPoint(state.viewport.eye, tf);\n    transformPoint(state.viewport.target, tf);\n    transformPoint(state.viewport.pivotPoint, tf);\n\n    transformNormal(state.viewport.up, tf); // may become relevant if tf contains a true-north rotation and the camera-up is not vertical\n    transformNormal(state.viewport.worldUpVector, tf);\n\n    if (state.cutplanes) {\n        const plane = new THREE.Plane();\n        const normal = new THREE.Vector3();\n\n        for (let i = 0; i < state.cutplanes.length; i++) {\n            const cutplane = state.cutplanes[i];\n\n            toVector(cutplane, normal);\n            const constant = Number(cutplane[3]);\n            plane.set(normal, constant);\n\n            plane.applyMatrix4(tf);\n\n            plane.normal.toArray(cutplane);\n            cutplane[3] = plane.constant;\n        }\n    }\n};\n","export const statusHexValues = {\n    /* Issues */\n\n    'issues-draft': '#819099',\n    'issues-draft-selected': '#819099',\n    'issues-draft-movable': '#819099',\n\n    'issues-open': '#ffba0c',\n    'issues-open-selected': '#ffba0c',\n    'issues-open-movable': '#ffba0c',\n\n    'issues-answered': '#087cd9',\n    'issues-answered-selected': '#087cd9',\n    'issues-answered-movable': '#087cd9',\n\n    'issues-closed': '#bcc9d1',\n    'issues-closed-selected': '#bcc9d1',\n    'issues-closed-movable': '#bcc9d1',\n\n    /* RFIs */\n\n    'rfis-draft': '#819099',\n    'rfis-draft-selected': '#819099',\n    'rfis-draft-movable': '#819099',\n\n    'rfis-submitted': '#7a77d9',\n    'rfis-submitted-selected': '#7a77d9',\n    'rfis-submitted-movable': '#7a77d9',\n\n    'rfis-open': '#ffba0c',\n    'rfis-open-selected': '#ffba0c',\n    'rfis-open-movable': '#ffba0c',\n\n    'rfis-answered': '#087cd9',\n    'rfis-answered-selected': '#087cd9',\n    'rfis-answered-movable': '#087cd9',\n\n    'rfis-rejected': '#ff495c',\n    'rfis-rejected-selected': '#ff495c',\n    'rfis-rejected-movable': '#ff495c',\n\n    'rfis-closed': '#bcc9d1',\n    'rfis-closed-selected': '#bcc9d1',\n    'rfis-closed-movable': '#bcc9d1',\n\n    'rfis-void': '#bcc9d1',\n    'rfis-void-selected': '#bcc9d1',\n    'rfis-void-movable': '#bcc9d1',\n\n\n    /* Field Issues */\n\n    'quality_issues-draft': '#819099',\n    'quality_issues-draft-selected': '#819099',\n    'quality_issues-draft-movable': '#819099',\n\n    'quality_issues-not_approved': '#ff495c',\n    'quality_issues-not_approved-selected': '#ff495c',\n    'quality_issues-not_approved-movable': '#ff495c',\n\n    'quality_issues-open': '#ffba0c',\n    'quality_issues-open-selected': '#ffba0c',\n    'quality_issues-open-movable': '#ffba0c',\n\n    'quality_issues-ready_to_inspect': '#7a77d9',\n    'quality_issues-ready_to_inspect-selected': '#7a77d9',\n    'quality_issues-ready_to_inspect-movable': '#7a77d9',\n\n    'quality_issues-void': '#bcc9d1',\n    'quality_issues-void-selected': '#bcc9d1',\n    'quality_issues-void-movable': '#bcc9d1',\n\n    'quality_issues-work_completed': '#087cd9',\n    'quality_issues-work_completed-selected': '#087cd9',\n    'quality_issues-work_completed-movable': '#087cd9',\n\n    // \"in_dispute\" pushpins are the same as \"not_approved\" ones\n    'quality_issues-in_dispute': '#ff495c',\n    'quality_issues-in_dispute-selected': '#ff495c',\n    'quality_issues-in_dispute-movable': '#ff495c',\n\n    // \"closed\" pushpins are the same as \"void\" ones\n    'quality_issues-closed': '#bcc9d1',\n    'quality_issues-closed-selected': '#bcc9d1',\n    'quality_issues-closed-movable': '#bcc9d1',\n\n    'quality_issues-answered': '#087cd9',\n    'quality_issues-answered-selected': '#087cd9',\n    'quality_issues-answered-movable': '#087cd9'\n};\n\nexport const moveableIcon = 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABMCAYAAAAlS0pSAAAA4UlEQVR42u3bSw7DIAwFwNz/zhXddNVuoPWHlHkHCGKUgG0p1yVyTMYrJGDFQwFbhAIGKw8KGKw8KGCLUMBg5UEdDQYrGeo4sBEUWLC0O7BgwYIFCxYsWLBgwYL1r1jRm8nGasPP3Ew2VhlY1Waqnl96ntwdKxytagjXifXzOtUTy26sr9YbMoeGaAIMywIaDm+Yc2sbKKVDcr2lKP1c6KHd0Ugb0WwxojH8M1aGBUtgwYIFCxYsgQUL1iYofkeB1Q/mcwQFqw3MzQgrHkwlOglGCJZ2B9YdwIhMgpGAJfKWJ1qioD8mrIWXAAAAAElFTkSuQmCC)';\n\nexport const cursorIcon = 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIxJREFUeNpi/P//PwMlgJGR0QBIfQCa84ASc5gYKAcTgDiBUkOo4RCqgFGHjDpk1CGjDhl1yKhDRoxDGIFYgcJqPAVK3yHXAGBbxoEF1KgBYgcKHPIHiEHmHKCgcaXASIUWWgPIIyBfjSbWUYeMOmTUIaMOGXXIqEOGVMOICs0AUMNKAGjOBUrMAQgwAFWiHzqojsmJAAAAAElFTkSuQmCC)16 16, auto';\n\nexport const markerOffsets = {\n    markerOffsetWidth: 30, // .pushpin-billboard-marker height + (border*2)\n    selectedMarkerOffsetWidth: 38 // .pushpin-billboard-marker.selected height + (border*2)\n};\n\nexport const thumbnailOriginalPixelSize = 200; // Original crop size\nexport const thumbnailSize = 800; // Output size of the thumbnail\nexport const thumbnailZoom = thumbnailSize / thumbnailOriginalPixelSize;\nexport const thumbnailMarkerRadius = 10 * thumbnailZoom;\n\n// ATTRIBUTES_VERSION is used in order to track changes of the pushpin attributes.\n// Change this number only if there is a code change that requires a distinction between pushpins created before & after that change.\n//\n// V1: Legacy pushpins\n// V2: applyOffsetToCutplanes is being applied to pushpins' cutplanes. https://git.autodesk.com/A360/firefly.js/pull/3046\nexport const ATTRIBUTES_VERSION = 2;\n","const namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nimport { transformViewerState } from './PushPins3D/PushPinViewerState';\nimport { ATTRIBUTES_VERSION } from './PushPinConstants';\n\nconst decodeUrn = (urn) => {\n    urn = urn.replace(/-/g, '+');         // Convert '-' (dash) to '+'\n    urn = urn.replace(/_/g, '/');         // Convert '_' (underscore) to '/'\n    while(urn.length % 4) { urn += '='; } // Add padding '='\n\n    try {\n        return atob(urn);\n    } catch {\n        return null;\n    }\n};\n\n// Extract the lineageID string from a base64-encoded version urn\n// Example: dXJuOmFkc2sud2lwc3RnOmZzLmZpbGU6dmYuM3Q4QlBZQXJSSkNpZkFZUnhOSnM0QT92ZXJzaW9uPTI \n//          => (decoded) \"urn:adsk.wipstg:fs.file:vf.3t8BPYArRJCifAYRxNJs4A?version=2\"\n//          => vf.3t8BPYArRJCifAYRxNJs4A\n//\n// An edge case that is being handled here is a seedUrn that has been created on offline mode.\n// In this case, it might look like this: \"OfflineFiles/dXJuOmFkc2sud2lwZW1lYTpkbS5saW5lYWdlOjRlV01pbFl5UkV1SEIzZHQxTHBNUWc/6/dXJuOmFkc2sud2lwZW1lYTpmcy5maWxlOnZmLjRlV01pbFl5UkV1SEIzZHQxTHBNUWc_dmVyc2lvbj02/output/0/0.svf\".\nconst getLineageId = (encodedUrn) => {\n    const parts = encodedUrn.split('/');\n\n    let decodedPart = null;\n\n    for (let i = parts.length - 1; i >= 0; i--) {\n        decodedPart = decodeUrn(parts[i]);\n        \n        if (decodedPart && decodedPart.indexOf('file:') != -1) {\n            break;\n        } else {\n            decodedPart = null;\n        }\n    }\n\n    if (!decodedPart) {\n        console.error('urn is not encoded correctly.');\n        return null;\n    }\n    \n    const start = decodedPart.indexOf('file:') + 'file:'.length; // skip prefix \"urn:adsk.wipstg:fs.file:\" resp. \"urn:adsk.wipprod:fs.file:\"\n    const end   = decodedPart.indexOf('?');\n    return decodedPart.substring(start, end);\n};\n\n// Returns the first visible model for which the lineageID is the same as for the given seedUrn.\n// The is usually not more than 1 anyway, but not guaranteed to be. In case there are more (e.g. for diff), \n// the first matching model determines the issue position.\nexport const findMatchingModel = (viewer, seedUrn) => {\n\n    const models = viewer.getVisibleModels();\n\n    // Skip in case seedUrn is missing (a possible reason is that it was created externally)\n    if (!seedUrn) {\n        // In case seedUrn is missing from the viewerState for some reason - we can still have a fallback in case there is only a single visible model.\n        // In that case, we can assume that the pushpin belongs to the main viewer's model.\n        if (models.length === 1) {\n            console.error('Issue seedUrn does not exist. Assume pushpin belongs to viewer current main model');\n            return models[0];\n        } else {\n            console.error('Issue seedUrn does not exist.');\n            return null;\n        }\n    }\n    // Extract decoded lineage urn from seedUrn\n    // We ignore the version part, so that the visible model is also found if it is another model version.\n    // Note: If the model is outside the version range of the issue, it will\n    //\t\t   not be displayed anyway, so that we don't have to check the version here again.\n    const issueLineageId = getLineageId(seedUrn);\n\n    // Find model with matching lineageId\n    for (let i=0; i<models.length; i++) {\n\n        // get lineageId of next model\n        const model     = models[i];\n        const urn       = model.myData.urn;\n        const lineageId = getLineageId(urn);\n\n        // return model if matching\n        if (lineageId === issueLineageId) {\n            return model;\n        }\n    }\n\n    if (models.length === 1) {\n        //console.error('Issue seedUrn does not match with any visible model urn. Assume pushpin belongs to viewer current main model');\n        return models[0];\n    }\n\n    // We didn't find any model that matches the given issue. This should not happen, because \n    // issues are not supposed to be displayed if it doesn't belong to any visible model. \n    // TODO: Investigate whether the assumption above might be temporarily broken due to async calls. E.g., if a model\n    //       was toggled off shortly before the issue was received.\n    //console.error('Issue seedUrn does not match with any visible model urn.');\n};\n\n// Unique id for runtime-generated PushPinItems. Note that the id will be overwritten by actual GUIDs if issues are saved or loaded.\n// Note: It would be cleaner to consistently use guids in the first place. But, this requires some refactoring first to get rid\n//       of a hack in RenderHandler.createRenderItem (https://git.autodesk.com/fluent/lmv.js/blob/develop/extensions/Pushpins/PushPins3D/RenderHandler3D.js#L188),\n//       which uses the ID length to distinguish between loaded and newly created issues.\nlet _nextPushPinId = 1;\n\nexport default class PushPinItem {\n    constructor() {\n        this.itemData = {\n            id: (_nextPushPinId++).toString(),\n            label: 'New',\n            status: 'issues-open',\n            position: { x: 0, y: 0, z: 0 },\n            type: 'issues',\n            objectId: null,\n            externalId: null,\n            viewerState: null,\n            objectData: null,\n            locationIds: [],\n            seedURN: null,\n        };\n\n        // Params affect render or interaction\n        this.selected = false;\n        this.isVisible = true;\n        this.draggable = false;\n        this.selectable = true;\n    }\n\n    get data() {\n        return this.itemData;\n    }\n\n    get visible() {\n        return this.isVisible;\n    }\n\n    set visible(isVisible) {\n        if (!this.hasPosition()) {\n            this.isVisible = false;\n        } else {\n            this.isVisible = isVisible;\n        }\n    }\n\n    defaultAppearance() {\n        const normalSize = 40;\n        const selectedSize = 60;\n\n        return {\n            normalSize,\n            selectedSize,\n            draggableStatus: '-movable',\n            selectedStatus: '-selected'\n        };\n    }\n\n    set(data) {\n        this.itemData = Object.assign({}, this.itemData, data);\n        this.correctDataFormat();\n\n        return this;\n    }\n\n    // Like set, but performs a conversion of position and viewerState from model-local-coords to viewer-coords.\n    // PushPinItems store viewer coordinates, i.e., ready-to-render for the current viewer. Expected input is \n    // in model-local coordinates, i.e., excluding any load-time transforms.\n    //\n    // Note that the model of the Pushpin must be visible/loaded.\n    setLocal(data, viewer) {\n\n        this.set(data);\n\n        // Positions are specified relative to the model the issue belongs to. We have to find this model first.\n        const model = this.findModel(viewer);\n        if (!model) {\n            // If we ever see this message, we are trying to create an issue for a model that is not shown.\n            // If this actually happens, we need some additional fallback logic here, e.g.\n            // set position to undefined first and update on model-show events.\n            console.error('PushPin coordinate conversion failed: PushPin must belong to a visible model.');\n            return;\n        }\n\n        // Why creating a new vector here instead of converting in-place:\n        //  - this.itemData is only a shallow copy and we don't want to modify the src input data\n        //  - Original vectors cannot be assumed to be THREE types.\n        this.itemData.position = new THREE.Vector3().copy(this.itemData.position);\n\n        // Apply matrix that combines all transforms that have been applied to the model during loading.\n        // Note that modelTf may be undefined. This is no error, but just indicates that neither placement nor offset was applied to the model.\n        const modelTf = model.myData.placementWithOffset;\n        if (modelTf) {\n            this.itemData.position.applyMatrix4(modelTf);\n        }\n\n        // Apply this transforms to position. \n        \n        // Replace viewerState by transformed copy\n        // Note that we cannot use placementWithOffset here as we did for position. To make it more confusing,\n        // there is another legacy constraint: viewerState values are currently stored in world-coords, i.e., viewer-coords with added \n        // global offset. The current globalOffset is subtracted when applying the viewerState (see PushPinViewerState.js:restoreViewState).\n        // \n        // It would be easier and more consistent to store viewerState in viewer-coords as well. But this would currently break legacy code,\n        // e.g., older issue-UI versions that don't use createItemFromLocal() are working based on the assumption that viewerStates are in world-coords.\n        const placementTf = model.myData.placementTransform;\n        this.itemData.viewerState = JSON.parse(JSON.stringify(this.itemData.viewerState));\n\n        // Transform viewer state. Note that placementTf may be undefined if the model was loaded without any placement transform.\n        // This is okay and just means that we can skip the transform step.\n        if (placementTf) {\n            transformViewerState(this.itemData.viewerState, placementTf);\n        }\n    }\n\n    // Returns a copy of the PushPin itemData where position and viewerState are provided in model-local coords.\n    // The model that the issue is assigned to must be visible.\n    getLocal(viewer) {\n\n        // Find the model for which the issue was assigned\n        const model = this.findModel(viewer);\n        if (!model) {\n//            console.error('PushPin coordinate conversion failed: PushPin must belong to a visible model.');\n            return;\n        }\n\n        let localData = Object.assign({}, this.itemData);\n\n        // Create copies of position and viewerState, so that they can be safely transformed and passed outside.\n        localData.position = new THREE.Vector3().copy(this.itemData.position);\n        localData.viewerState = JSON.parse(JSON.stringify(this.itemData.viewerState));\n\n        // Get matrices to convert between different coordinate spaces. \n        // Note that both matrices may be undefined. This is no error and just indicates that the two coordinate\n        // spaces are the same. \n        const modelLocalToViewer = model.myData.placementWithOffset;\n        const modelLocalToWorld   = model.myData.placementTransform;\n\n        // Convert position from viewer coords to model-local coords.\n        if (modelLocalToViewer) {\n            const viewerToModelLocal = new THREE.Matrix4().getInverse(modelLocalToViewer);\n            localData.position.applyMatrix4(viewerToModelLocal);\n        }\n\n        // Convert viewerState from world-coords to model-local coords.\n        if (modelLocalToWorld) {\n            // Create copy of the viewerState that is transformed from world-coords to model-local coords.\n            const worldToModelLocal  = new THREE.Matrix4().getInverse(modelLocalToWorld);\n            transformViewerState(localData.viewerState, worldToModelLocal);\n        }\n\n        return localData;\n    }\n\n    setObjectId(dbId) {\n        this.itemData.objectId = dbId;\n    }\n\n    setObjectData(res) {\n        const model = res.model;\n        if (!model) {\n            return;\n        }\n        const data = model.getData();\n        if (!data) {\n            return;\n        }\n        const documentNode = model.getDocumentNode();\n        if (!documentNode) {\n            return;\n        }\n        const docNodeData = documentNode.data;\n        if (!docNodeData) {\n            return;\n        }\n        this.itemData.objectData = {\n            guid: docNodeData.guid,\n            urn: data.urn,\n            viewableId: docNodeData.viewableID,\n            viewName: docNodeData.name\n        }\n    }\n\n    setExternalId(externalId) {\n        this.itemData.externalId = externalId;\n    }\n\n    setPosition(newPos) {\n        this.itemData.position = Object.assign({}, newPos);\n    }\n    \n    hasPosition() {\n        return this.itemData.position.x !== null && this.itemData.position.y !== null && this.itemData.position.z !== null;\n    }\n\n    // Finds the visible model whose lineageId matches the seedUrn stored for this issue.\n    // May return undefined if the model is currently not visible.\n    findModel(viewer) {\n        // if viewerState doesn't exist, the only way to not \"give up\" on the pushpin, is to check if the viewer has only a single model.\n        const visibleModels = viewer.getVisibleModels();\n        if (!this.itemData.viewerState && visibleModels.length === 1) {\n            return visibleModels[0];\n        }\n\n        const seedUrn = this.getSeedUrn();\n        return findMatchingModel(viewer, seedUrn);\n    }\n\n    setViewerState(state) {\n        this.itemData.viewerState = Object.assign({}, state);\n\n        // Added attributesVersion to viewerState until all the BIM clients will save it in the backend.\n        this.itemData.viewerState.attributesVersion = ATTRIBUTES_VERSION;\n    }\n\n    setOriginalDocumentResolution(originalDocumentResolution) {\n        this.setViewerState({ originalDocumentResolution });\n    }\n\n    correctDataFormat() {\n        const defaultStatusNames = [\n            'draft', 'draft-selected', 'draft-movable', 'open', 'open-selected',\n            'open-movable', 'answered', 'answered-selected', 'answered-movable',\n            'closed', 'closed-selected', 'closed-movable'\n        ];\n\n        defaultStatusNames.forEach((status) => {\n            if (this.itemData.status === status) {\n                this.itemData.status = `${this.itemData.type || 'issues'}-${this.itemData.status}`;\n            }\n        });\n    }\n\n    getAttributesVersion() {\n        // get attributesVersion from viewerState until all the BIM clients will save it in the backend.\n        return this.itemData.attributesVersion || (this.itemData.viewerState && this.itemData.viewerState.attributesVersion);\n    }\n\n    setLocationIds(locationIds) {\n        this.itemData.locationIds = locationIds;\n    }\n\n    getSeedUrn() {\n        // TODO: Find out why for serialized issues, it is called \"seedUrn\" while for newly created PushPins it is called \"seedURN\". In LMV viewer states, it was \n        //       always \"seedURN\" since several years.\n        return this.itemData.seedURN || this.itemData.viewerState?.seedUrn || this.itemData.viewerState?.seedURN;\n    }\n\n    setSeedUrn(seedUrn) {\n        this.itemData.seedURN = seedUrn;\n    }\n}\n\nnamespace.PushPinItem = PushPinItem;\n","// Compute the max level from leaflet max resolution texture.\nfunction computeMaxLevel(w, h) {\n    // compute maxLevel that we would get for 1x1 resolution at level 0\n    const lx = Math.ceil(Math.log2(w));\n    const ly = Math.ceil(Math.log2(h));\n    const maxLevel = Math.max(lx, ly);\n\n    // since the actual root tile has tileSize x tileSize, we subtract the skipped levels.\n    return maxLevel;\n}\n\nexport function clientToWorldLeaflet(viewer, x, y) {\n    let loadOptions;\n    let bounds;\n\n    if (viewer.model.isPdf(true)) {\n        loadOptions = Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(viewer);\n        bounds = Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(viewer);\n    } else {\n        const modelData = viewer.model.getData();\n        loadOptions = modelData.loadOptions.loadOptions;\n        bounds = modelData.bbox;\n    }\n\n    const { texWidth, texHeight } = loadOptions;\n\n    const worldPos = viewer.clientToWorld(x, y, undefined, true).point;\n    const worldTopLeft = new THREE.Vector3(bounds.min.x, bounds.max.y, 0);\n\n    worldPos.sub(worldTopLeft);\n    const newX = (worldPos.x * texWidth) / bounds.size().x;\n    const newY = (worldPos.y * texHeight) / bounds.size().y;\n\n    const point = new THREE.Vector3(newX, newY, 0);\n\n    const maxLevel = computeMaxLevel(texWidth, texHeight);\n    const scale = Math.pow(2, maxLevel);\n\n    const px = point.x / scale;\n    const py = point.y / scale;\n\n    // x & y are swapped for some reason. Can't change it now for backward compatibility.\n    return new THREE.Vector3(py, px, 0);\n}\n\nexport function clientToWorld(viewer, x, y) {\n    if (viewer.model.isLeaflet()) {\n        return clientToWorldLeaflet(viewer, x, y);\n    } else {\n        return viewer.clientToWorld(x, y, undefined, true).point;\n    }\n};\n\nexport function applyPdfWorldScaling(viewer, itemData) {\n    if (viewer.model.isLeaflet() || viewer.model.isPdf(true)) {\n        const originalDocumentResolution = itemData.viewerState && itemData.viewerState.originalDocumentResolution;\n\n        // In case of leaflet - it changes to world coordinates.\n        const clientPos = worldToClient(viewer, itemData.position, originalDocumentResolution);\n        const worldPos = viewer.clientToWorld(clientPos.x, clientPos.y, undefined, true).point;\n        return worldPos;\n    } else {\n        return itemData.position;\n    }\n}\n\nexport function worldToClient(viewer, point, originalDocumentResolution) {\n    if (!viewer.model.isLeaflet() && !viewer.model.isPdf(true)) {\n        return viewer.worldToClient(point);\n    }\n\n    let x = point.y;\n    let y = point.x;\n\n    let loadOptions;\n    let bounds;\n\n    if (viewer.model.isPdf(true)) {\n        loadOptions = Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(viewer);\n        bounds = Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(viewer);\n    } else {\n        const modelData = viewer.model.getData();\n        loadOptions = modelData.loadOptions.loadOptions;\n        bounds = modelData.bbox;\n    }\n\n    const { texWidth, texHeight } = loadOptions;\n\n    const maxLevel = computeMaxLevel(texWidth, texHeight);\n    const scale = Math.pow(2, maxLevel);\n    x *= scale;\n    y *= scale;\n\n    // https://jira.autodesk.com/browse/BLMV-2853\n    // In case that the DPI of the current document is different than the DPI of the document where the pushpin has originally created (or edited)\n    // We need to scale the ratio back in order that the pushpin will appear in the same place.\n    const originalDocumentWidth = (originalDocumentResolution && originalDocumentResolution[0]) || texWidth;\n    const dpiCorrection = texWidth / originalDocumentWidth;\n\n    const wx = (x / (texWidth / dpiCorrection)) * bounds.size().x;\n    const wy = (y / (texHeight / dpiCorrection)) * bounds.size().y;\n\n    const worldPos = new THREE.Vector3(bounds.min.x + wx, bounds.max.y + wy, 0);\n\n    if (viewer.model.isPdf(true)) {\n        Autodesk.Viewing.PDFUtils.leafletToPdfWorld(viewer, worldPos);\n    }\n\n    return viewer.impl.worldToClient(worldPos);\n}\n\n// Used for saving pushpins in the backend like they were created in Leaflet, instead of PDF.\nexport function convertPdfToLeaflet (viewer, itemData) {\n    const p = Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(viewer, new THREE.Vector3().copy(itemData.position));\n    itemData.position = { x: p.y - 1, y: p.x, z: 0 }; // x & y are swapped for some reason. Can't change it now for backward compatibility.\n}\n\nexport function applyModelTransform (point, model) {\n    const modelTransform = model?.getModelTransform();\n\n    if (modelTransform) {\n        point.applyMatrix4(modelTransform);\n    }\n}\n\nexport function invertModelTransform (point, model) {\n    const modelTransform = model?.getModelTransform();\n\n    if (modelTransform) {\n        point.applyMatrix4(new THREE.Matrix4().getInverse(modelTransform));\n    }\n}\n","import PushPinItem from './PushPinItem';\nimport { PUSHPIN_EVENTS } from './PushPinEvents';\nimport { convertPdfToLeaflet, applyPdfWorldScaling, clientToWorldLeaflet } from './PushPinUtils';\nimport { thumbnailSize, thumbnailOriginalPixelSize, thumbnailMarkerRadius } from './PushPinConstants';\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nexport default class PushPinManager extends Autodesk.Viewing.EventDispatcher {\n    constructor(viewer, options = {}) {\n        super();\n\n        this.viewer = viewer;\n        this.options = options;\n\n        this.pushPinList = [];\n        this.selectedItem = null;\n        this.PushPinTypes = {\n            ISSUES: 'issues',\n            RFIS: 'rfis',\n            QUALITY_ISSUES: 'quality_issues'\n        };\n\n        this.is2D = !!this.viewer.impl.is2d;\n\n        // In case the 3d model has no thickness, consider it as a 'pseudo 2D' model.\n        // It will disable the occlusion test. And when creating new pushpins it will not interact with the objects, but with the ground. \n        if (!this.is2D) {\n            const modelBB = this.viewer.model.getBoundingBox();\n            const worldUp = this.viewer.impl.worldUpName();\n            this.isPseudo2D = modelBB.max[worldUp] - modelBB.min[worldUp] === 0;\n            this.options.disableOcclusionTest = this.options.disableOcclusionTest || this.isPseudo2D;\n        }\n\n        this.pushPinsVisibilityByType = this.getInitialPushpinVisibilityByType();\n        this.pushpinsByType = this.getInitialPushpinsByType();\n        this.create = Promise.resolve();\n\n        this.onPushpinEditStartBinded = this.onPushpinEditStart.bind(this);\n        this.onPushpinEditEndBinded = this.onPushpinEditEnd.bind(this);\n\n        this.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_EDIT_START_EVENT, this.onPushpinEditStartBinded);\n        this.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_EDIT_END_EVENT, this.onPushpinEditEndBinded);\n        this.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onPushpinEditEndBinded);\n    }\n\n    items() {\n        return this.pushPinList;\n    }\n\n    getInitialPushpinsByType() {\n        const cache = {};\n\n        Object.keys(this.PushPinTypes).forEach((issueTypeKey) => {\n            cache[this.PushPinTypes[issueTypeKey]] = {};\n        });\n\n        return cache;\n    }\n\n    getInitialPushpinVisibilityByType() {\n        const cache = {};\n\n        Object.keys(this.PushPinTypes).forEach((typeKey) => {\n            cache[this.PushPinTypes[typeKey]] = true;\n        });\n\n        return cache;\n    }\n\n    shouldGenerateThumbnail(item) {\n        return (this.options.generateIssueThumbnail && (item.data.type === this.PushPinTypes.ISSUES || item.data.type === this.PushPinTypes.QUALITY_ISSUES)) ||\n                (this.options.generateRFIThumbnail && item.data.type === this.PushPinTypes.RFIS);\n    }\n\n    generateThumbnail(item) {\n        if (!this.shouldGenerateThumbnail(item)) {\n            return Promise.resolve(null);\n        }\n\n        return new Promise((resolve, reject) => {\n            const { x, y, z } = item.data.position; // Backup position.\n\n            if (this.viewer.model.isPdf(true)) {\n                convertPdfToLeaflet(this.viewer, item.data);\n            }\n\n            this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_PREPARING_THUMBNAIL, value: item });\n\n            item.data.position = { x, y, z }; // Restore position.\n\n            let width, height, zoomRatio;\n            let pWorld;\n            let markerPos;\n            let bounds;\n\n            if (this.viewer.model.isLeaflet()) {\n                pWorld = applyPdfWorldScaling(this.viewer, item.data);\n            } else {\n                pWorld = item.data.position;\n            }\n\n            const canvasBounds = this.viewer.impl.getCanvasBoundingClientRect();\n            const ratio = canvasBounds.width / canvasBounds.height;\n\n            if (ratio > 1) {\n                height = Math.floor(Math.max(canvasBounds.height, thumbnailSize));\n                zoomRatio = (height / canvasBounds.height);\n                width = Math.floor(canvasBounds.width * zoomRatio);\n            } else {\n                width = Math.floor(Math.max(canvasBounds.width, thumbnailSize));\n                zoomRatio = (width / canvasBounds.width);\n                height = Math.floor(canvasBounds.height * zoomRatio);\n            }\n\n            const overlayRenderer = (viewer, options) => {\n                const { width, height, ctx, target, screenshotCamera, onRenderDone } = options;\n                const { canvas } = ctx.targetToCanvas(target);\n\n                // In case bounds were supplied, it means that the marker should be in the center of the screenshot.\n                if (bounds) {\n                    markerPos = { x: width / 2, y: height / 2 };\n                } else {\n                    // Otherwise, we are probably in a 3D scene - marker can be anywhere. In that case we should\n                    // calculate the marker position on canvas according to the pushpin's world position.\n                    markerPos = viewer.worldToClient(pWorld, screenshotCamera).multiplyScalar(zoomRatio);\n                }\n\n                const radius = thumbnailMarkerRadius;\n                var ctx2d = canvas.getContext(\"2d\");\n                ctx2d.fillStyle = \"#FF0000\";\n                ctx2d.beginPath();\n                ctx2d.arc(markerPos.x, height - markerPos.y, radius, 0, 2 * Math.PI);\n                ctx2d.closePath();\n                ctx2d.fill();\n\n                onRenderDone(canvas);\n            };\n\n            const getCropBounds = (viewer, camera) => {\n                let cropCenter = markerPos;\n\n                // Make sure crop won't exceed bounds.\n                if (cropCenter.x + thumbnailSize / 2 > width) {\n                    cropCenter.x -= cropCenter.x + thumbnailSize / 2 - width;\n                }\n\n                if (cropCenter.y + thumbnailSize / 2 > height) {\n                    cropCenter.y -= cropCenter.y + thumbnailSize / 2 - height;\n                }\n\n                const clientBounds = new THREE.Box3().expandByPoint(cropCenter);\n                clientBounds.expandByVector(new THREE.Vector3(thumbnailSize / 2, thumbnailSize / 2, 0));\n\n                return clientBounds;\n            };\n\n            // Zoom in with virtual camera to get the desired thumbnail size.\n            if (this.viewer.model.is2d()) {\n\n                let thumbnailSizeWorld;\n                let zeroWorld;\n\n                if (!this.viewer.model.isPageCoordinates()) {\n                    thumbnailSizeWorld = clientToWorldLeaflet(this.viewer, thumbnailOriginalPixelSize, 0);\n                    zeroWorld = clientToWorldLeaflet(this.viewer, 0, 0);\n                } else {\n                    thumbnailSizeWorld = this.viewer.clientToWorld(thumbnailOriginalPixelSize, 0, undefined, true).point;\n                    zeroWorld = this.viewer.clientToWorld(0, 0, undefined, true).point;\n                }\n\n                const size = thumbnailSizeWorld.distanceTo(zeroWorld);\n\n                bounds = new THREE.Box3().expandByPoint(pWorld);\n                bounds.expandByVector(new THREE.Vector3(size / 2, size / 2, 0));\n                bounds.min.z = 0;\n                bounds.max.z = 0;\n            }\n\n            const options = {\n                bounds,\n                getCropBounds,\n                overlayRenderer\n            };\n        \n            Autodesk.Viewing.ScreenShot.getScreenShotWithBounds(\n                this.viewer,\n                width,\n                height,\n                (blob, outputWidth, outputHeight) => {\n                    if (!blob) {\n                        return reject('Error while preparing pushpin thumbnail.');\n                    }\n            \n                    Autodesk.Viewing.ScreenShot.blobToImage(blob, outputWidth, outputHeight, (img) => {\n                        return resolve(img);\n                    });\n                },\n                options\n            );\n        }).catch((e) => {\n            // In case of an error in the screenshot creation, continue saving the pushpin with empty thumbnail.\n            console.error(e);\n            return null\n        });\n    }\n\n    // Update locationIds array inside the item's data.\n    setItemLocationIds(item) {\n        let point;\n\n        // Locations are stored using page coordinate system.\n        // In case we are viewing a Leaflet document, the pushpin position has to be converted into the same coordinate system.\n        if (this.viewer.model.isLeaflet()) {\n            const pWorld = applyPdfWorldScaling(this.viewer, item.data);\n\n            if (this.viewer.model.isPageCoordinates()) {\n                point = pWorld;\n            } else {\n                point = Autodesk.Viewing.PDFUtils.leafletToPdfWorld(this.viewer, pWorld);\n            }\n            \n        } else {\n            point = item.data.position;\n        }\n        \n        // Intersect pushpin position with locations array.\n        const intersectedLocationIds = this.getLocationIdsAtPoint(point);\n        item.setLocationIds(intersectedLocationIds);\n    }\n\n    // @param {Object} data                - Data to be copied to the PushPin. By default, it must contain a pushpin position.\n    // @param {bool}   [isTriggeringEvent] - Fire PUSH_PIN_CREATED event by default\n    // @param {bool}   [createFromLocal]   - By default, data.position is assumed to be in world-coords (ready-to-render for the viewer).\n    //                                       If true, the position is provided in model-local coordinates instead.\n    // @param {Viewer3D} [viewer}          - Only needed when createFromLocal is true: In this case, we need to find the model for this PushPin to convert the position.\n    createItem(data, isTriggeringEvent = true, createFromLocal = false, viewer = undefined) {\n\n        if (this.getItemById(data.id)) {\n            return null;\n        }\n\n        const newItem = new PushPinItem();\n        \n        if (createFromLocal) {\n            // Set pushPinData - assuming that position and viewerState are given in model-local coords.\n            // In this case, we have to convert them to viewer-coordinates first.\n            newItem.setLocal(data, viewer);\n        } else {\n            newItem.set(data);\n        }\n\n        this.addItem(newItem);\n\n        if (isTriggeringEvent) {\n            this.create(newItem)\n            .then(() => {\n                this.setItemLocationIds(newItem);\n                return this.generateThumbnail(newItem);\n            })\n            .then((thumbnail) => {\n\n                const { x, y, z } = newItem.data.position; // Backup position.\n\n                if (this.viewer.model.isPdf(true)) {\n                    convertPdfToLeaflet(this.viewer, newItem.data);\n                }\n\n                this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_CREATED_EVENT, value: newItem, thumbnail });\n\n                newItem.data.position = { x, y, z }; // Restore position.\n            });\n        }\n\n        return newItem;\n    }\n\n    addItems(dataArray, createFromLocal, viewer) {\n        dataArray.forEach((pushPinData) => {\n            if (this.viewer.model.isPdf(true)) {\n                const { x, y, z } = applyPdfWorldScaling(this.viewer, pushPinData);\n                pushPinData.position = { x, y, z };\n            }\n\n            this.createItem(pushPinData, false, createFromLocal, viewer);\n        });\n    }\n\n    removeAllItems() {\n        this.selectedItem = null;\n        this.pushPinList = [];\n\n        // Update local pushpins cache\n        this.pushpinsByType = this.getInitialPushpinsByType();\n\n        this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT });\n    }\n\n    addItem(item) {\n        if (item.data && item.data.id) {\n            const idx = this.getItemIndexById(item.data.id);\n\n            if (idx > -1) {\n                return false;\n            }\n\n            let type = item.data.type;\n\n            if (type && this.pushPinsVisibilityByType) {\n                item.visible = this.pushPinsVisibilityByType[type];\n            }\n\n            type = type || this.PushPinTypes.ISSUES;\n\n            // Update local pushpins cache, handle only pushpins with supported type\n            if (this.pushpinsByType[type]) {\n                this.pushpinsByType[type][item.data.id] = item.data;\n            }\n\n            this.pushPinList.unshift(item);\n            return true;\n        }\n        return false;\n    }\n\n    removeItemById(id) {\n        if (this.selectedItem && this.selectedItem.data.id === id) {\n            this.selectedItem = null;\n        }\n        const idx = this.getItemIndexById(id);\n\n        if (idx > -1) {\n            const item = this.pushPinList.splice(idx, 1)[0];\n\n            const type = item.data.type;\n\n            // Update local pushpins cache, handle only pushpins with supported type\n            if (type && this.pushpinsByType[type]) {\n                delete this.pushpinsByType[type][id];\n            }\n\n            this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, value: item });\n            return item;\n        }\n\n        return null;\n    }\n\n    removeItemsByType(type) {\n        const pushPinTypeObject = this.pushpinsByType[type] || {};\n\n        Object.keys(pushPinTypeObject).forEach((id) => {\n            this.removeItemById(id);\n        });\n    }\n\n    updateItemById(id, data) {\n        // 1. validate data & create new one\n        const item = this.getItemById(id);\n        if (!item) {\n            return null;\n        }\n        const idx = this.getItemIndexById(item.data.id);\n\n        if (!data || !data.id || data.type !== item.data.type) {\n            return null;\n        }\n\n        if (this.viewer.model.isPdf(true)) {\n            const { x, y, z } = applyPdfWorldScaling(this.viewer, data);\n            data.position = { x, y, z };\n        }\n\n        // 2. update data\n        item.set(data);\n\n        // 3. update local pushpins cache, handle only pushpins with supported type\n        const type = item.data.type;\n\n        if (type && this.pushpinsByType[type]) {\n            delete this.pushpinsByType[type][id];\n            this.pushpinsByType[type][item.data.id] = item.data;\n        }\n        this.pushPinList[idx] = item;\n\n        this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, value: item });\n\n        return item;\n    }\n\n    getItemById(id) {\n        const idx = this.getItemIndexById(id);\n        return (idx > -1) ? this.pushPinList[idx] : null;\n    }\n\n    getItemIndexById(id) {\n        let idx = -1;\n        this.pushPinList.every((item, index) => {\n            if (item.data.id === id) {\n                idx = index;\n                return false;\n            }\n            return true;\n        });\n        return idx;\n    }\n\n    getItemCountByType(type) {\n        const pushPinTypeObject = this.pushpinsByType[type] || {};\n\n        return Object.keys(pushPinTypeObject).length;\n    }\n\n    getSelectedItem() {\n        return this.selectedItem;\n    }\n\n    selectOne(id, reTriggerEvent) {\n        let triggerSelectionEvent = Boolean(reTriggerEvent);\n        if (!this.selectedItem || (this.selectedItem.data.id !== id)) {\n\n            const oldOne = this.selectedItem;\n            this.selectedItem = this.getItemById(id);\n\n            if (oldOne !== this.selectedItem) {\n                oldOne && (oldOne.selected = false);\n                this.selectedItem && (this.selectedItem.selected = true);\n                triggerSelectionEvent = true;\n            }\n        }\n\n        if (triggerSelectionEvent) {\n            this.fireEvent({type: PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, value: this.selectedItem});\n        }\n\n        return this.selectedItem;\n    }\n\n    selectNone() {\n        this.selectOne(null);\n    }\n\n    getVisibleByType(type) {\n        return this.pushPinsVisibilityByType[type];\n    }\n\n    setVisibleByType(type, isVisible) {\n        this.pushPinsVisibilityByType[type] = isVisible;\n        const pushPinTypeObject = this.pushpinsByType[type] || {};\n\n        Object.keys(pushPinTypeObject).forEach((id) => {\n            const item = this.getItemById(id);\n\n            if (item) {\n                item.visible = isVisible;\n            }\n        });\n\n        this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, value: { type, isVisible } });\n    }\n\n    addEventListener(event, func) {\n        if (!this.hasEventListener(event, func)) {\n            super.addEventListener(event, func);\n        }\n    }\n\n    setCreateFunction(func) {\n        this.create = func;\n    }\n\n    removeCreateFunction(func) {\n        if (func === this.create) {\n            this.create = Promise.resolve();\n        }\n    }\n\n    getLocationsExtension() {\n        return this.viewer.getExtension(\"Autodesk.AEC.LocationsExtension\");\n    }\n\n    getLocationsExtensionAsync() {\n        return this.viewer.getExtensionAsync(\"Autodesk.AEC.LocationsExtension\");\n    }\n\n    async onPushpinEditStart() {\n        const explodeExt = this.viewer.getExtension('Autodesk.Explode');\n\n        if (explodeExt) {\n            explodeExt.setUIEnabled(false);\n        }\n\n        // In order to avoid extension loading timing issues, we use the async api here.\n        // Just make sure that the model wasn't changed by the time we got the result.\n        const model = this.viewer.model;\n        this.pushpinEditStarted = true;\n        const locationsExtension = await this.getLocationsExtensionAsync();\n        \n        if (locationsExtension && this.viewer.model === model && this.pushpinEditStarted) {\n            if (this.options.showLocations) {\n                locationsExtension.showAllLocations();\n            }\n\n            // Update initial hover for selected pushpin (before actually moving the mouse).\n            if (this.selectedItem) {\n                locationsExtension.hoverLocationsByIds(this.selectedItem.data.locationIds);\n            }\n\n            // Stop highlight when placing pushpin on 2D locations.\n            this.highlightPausedBackup = this.viewer.isHighlightPaused();\n            this.viewer.impl.pauseHighlight(true);\n        }\n    }\n\n    onPushpinEditEnd() {\n        // If item is still draggable, the edit is not really done.\n        if (this.selectedItem && this.selectedItem.draggable) {\n            return;\n        }\n\n        const explodeExt = this.viewer.getExtension('Autodesk.Explode');\n\n        if (explodeExt) {\n            explodeExt.setUIEnabled(true);\n        }\n\n        const locationsExtension = this.getLocationsExtension();\n\n        if (locationsExtension) {\n            locationsExtension.hideAllLocations();\n\n            // Restore highlights.\n            this.viewer.impl.pauseHighlight(this.highlightPausedBackup);\n        }\n\n        this.pushpinEditStarted = false;\n    }\n\n    getLocationIdsAtPoint(point) {\n        const locationsExtension = this.getLocationsExtension();\n\n        if (locationsExtension) {\n            return locationsExtension.getLocationIdsAtPoint(point);\n        }\n\n        return [];\n    }\n\n    hoverLocations(event) {\n        const locationsExtension = this.getLocationsExtension();\n\n        if (locationsExtension) {\n            locationsExtension.onMouseMove(event);\n        }\n    }\n}\n\nnamespace.PushPinManager = PushPinManager;\n","const av = Autodesk.Viewing;\nconst _document = av.getGlobal().document;\n\nexport default class HTMLPushPinLabel {\n    constructor() {\n        this.container = _document.createElement('div');\n        this.container.className = 'leaflet-text-label';\n        this.text = '';\n        this.dirty = false;\n    }\n\n    setParent(parent) {\n        if (this.container.parentNode) {\n            this.container.parentNode.removeChild(this.container);\n        }\n\n        if (parent) {\n            parent.appendChild(this.container);\n        }\n    }\n\n    set(textString) {\n        if (this.text === textString) {\n            return;\n        }\n\n        this.container.innerHTML = '<span>' + textString + '</span>';\n        this.text = textString;\n\n        const textWidth = this.container.firstChild.clientWidth;\n        let bgWidth = textWidth + 20;\n\n        if (bgWidth < 60) {\n            bgWidth = 60;\n        }\n\n        this.container.style.width = bgWidth.toString() + 'px';\n\n        let top = 10;\n        let left = 0;\n\n        if (this.container.clientWidth !== 0) {\n            const containerHeight = this.container.parentNode.clientHeight;\n            top += containerHeight;\n\n            const containerWidth = this.container.parentNode.clientWidth;\n            left = (containerWidth - this.container.clientWidth) * 0.5;\n        } else {\n            // if label client width is null, need refresh label again.\n            return;\n        }\n\n        top = top.toString() + 'px';\n        left = left.toString() + 'px';\n\n        if (this.container.style.top !== top) {\n            this.container.style.top = top;\n        }\n\n        if (this.container.style.left !== left) {\n            this.container.style.left = left;\n        }\n        this.dirty = false;\n    }\n}\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.HTMLPushPinLabel = HTMLPushPinLabel;\n","import HTMLPushPinLabel from '../PushPinLabel/HTMLPushPinLabel';\n\nexport default class PushPinBillboardLabel extends HTMLPushPinLabel {\n    constructor(marker, labelText) {\n        super();\n\n        this.createLabel(marker, labelText);\n        this.visible = true;\n    }\n\n    createLabel(marker, labelText) {\n        super.setParent(marker);\n        this.update(labelText);\n    }\n\n    get isVisible() {\n        return this.visible;\n    }\n\n    set isVisible(isVisible) {\n        this.visible = isVisible;\n    }\n\n    update(labelText) {\n        super.set(labelText);\n\n        this.container.style.top = PushPinBillboardLabel.TOP_PADDING;\n        this.container.style.left = (this.container.style.width / 3) + 'px';\n    }\n\n    show() {\n        this.visible = true;\n        this.container.style.display = 'block';\n    }\n\n    hide() {\n        this.visible = false;\n        this.container.style.display = 'none';\n    }\n}\n\nPushPinBillboardLabel.TOP_PADDING = '50px';\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.PushPinBillboardLabel = PushPinBillboardLabel;\n","import PushPinBillboardLabel from '../PushPinLabel/PushPinBillboardLabel';\nimport { applyPdfWorldScaling } from '../PushPinUtils';\nimport { statusHexValues, moveableIcon, markerOffsets, ATTRIBUTES_VERSION } from '../PushPinConstants';\n\nconst av = Autodesk.Viewing;\n\nexport default class PushPinBillboardTool2D {\n    constructor(viewer) {\n        this.names = ['pushpinBillboard2D'];\n\n        this.viewer = viewer;\n        this.setGlobalManager(viewer.globalManager);\n        this.active = false;\n\n        this.pushpins = [];\n        this.selectedPushpin = null;\n        this.dirty = false;\n        this.camera = this.viewer.navigation.getCamera();\n        this.curCameraZ = 0;\n        this.curCameraRotationZ = 0;\n\n        this.tmpVec = new THREE.Vector3();\n        this.tmpMatrix = new THREE.Matrix4();\n    }\n\n    getNames() {\n        return this.names;\n    }\n\n    getName() {\n        return this.names[0];\n    }\n\n    isActive() {\n        return this.active;\n    }\n\n    activate(name) {\n        if (name === this.getName()) {\n            this.active = true;\n\n            this.onCameraChangeBinded = e => this.onCameraChange(e);\n            this.handleResizeBinded = e => this.handleResize(e);\n\n            this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n            this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.handleResizeBinded);\n\n            this.createMarkerContainer();\n        }\n    }\n\n    deactivate(name) {\n        if (name === this.getName()) {\n            this.active = false;\n\n            this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n            this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.handleResizeBinded);\n        }\n    }\n\n    onCameraChange(e) {\n        if (e.camera.position.z.toPrecision(5) !== this.curCameraZ.toPrecision(5) || e.camera.rotation.z.toPrecision(5) !== this.curCameraRotationZ.toPrecision(5)) {\n            this.updatePushpinsProjection();\n            this.curCameraZ = e.camera.position.z;\n            this.curCameraRotationZ = e.camera.rotation.z;\n        } else {\n            this.updateContainerProjection();\n        }\n    }\n\n    createMarkerContainer() {\n        if (!this.pushpinContainer) {\n            this.pushpinContainer = this.viewer.appendOrderedElementToViewer('pushpin-container');\n            this.pushpinContainer.className = 'pushpin-container';\n            this.pushpinContainer.position = new THREE.Vector3();\n        }\n    }\n\n    project(pushpin) {\n        const position = pushpin.marker.intersectPoint;\n        const containerBounds = this.viewer.navigation.getScreenViewport();\n        const p = this.tmpVec.copy(position);\n\n        this.tmpMatrix.multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse);\n\n        p.applyProjection(this.tmpMatrix);\n\n        return new THREE.Vector3(\n            Math.round(((p.x + 1) / 2) * containerBounds.width),\n            Math.round(((-p.y + 1) / 2) * containerBounds.height),\n            p.z\n        );\n    }\n\n    unproject(position) {\n        const containerBounds = this.viewer.navigation.getScreenViewport();\n        const p = new THREE.Vector3();\n\n        p.x = ((position.x / containerBounds.width) * 2) - 1;\n        p.y = -(((position.y / containerBounds.height) * 2) - 1);\n        p.z = position.z;\n        p.unproject(this.camera);\n\n        return p;\n    }\n\n    initNewPushpin(item) {\n        if (this.viewer.model.isLeaflet()) {\n            this.convertLeafletPosition(item);\n\n            // https://jira.autodesk.com/browse/BLMV-2918\n            // Update originalDocumentResolution when saving / updating a pushpin, in order to make sure that the pushpin will\n            // maintain the same position for different DPIs of the same document.\n            const modelData = this.viewer.model.getData();\n            const options = modelData.loadOptions.loadOptions;\n            item.setOriginalDocumentResolution([options.texWidth, options.texHeight]);\n        } else {\n            item.intersectPoint = item.data.position;\n        }\n\n        this.pushpins.push(item);\n\n        this.createMarker(item);\n\n        item.draggable ? this.enableDragging(item) : this.disableDragging(item);\n        item.visible ? this.showMarker(item.marker) : this.hideMarker(item.marker);\n    }\n\n    createPushpin(item) {\n        item.data.attributesVersion = ATTRIBUTES_VERSION;\n\n        this.initNewPushpin(item);\n        this.selectPushpin(item);\n\n        return Promise.resolve();\n    }\n\n    convertLeafletPosition(item) {\n        const worldPos = applyPdfWorldScaling(this.viewer, item.data);\n        item.intersectPoint = { x: worldPos.x, y: worldPos.y, z: worldPos.z };\n    }\n\n    loadPushpin(item) {\n        this.initNewPushpin(item);\n\n        return Promise.resolve();\n    }\n\n    createMarker(pushpin) {\n        const _document = this.getDocument();\n        const marker = _document.createElement('div');\n\n        const className = (pushpin.data.type === 'rfis') ? 'rfi-billboard-marker' : 'pushpin-billboard-marker';\n\n        marker.classList.add(className);\n        marker.style.backgroundColor = statusHexValues[pushpin.data.status];\n        marker.style.boxShadow = '0px 1px 6px rgba(0, 0, 0, 0.6)';\n\n        this.pushpinContainer.appendChild(marker);\n\n        marker.id = pushpin.data.id;\n        marker.intersectPoint = pushpin.intersectPoint;\n\n        pushpin.marker = marker;\n        this.setMarkerPosition(pushpin);\n\n        // first pushpin\n        if (this.pushpins.length === 1) {\n            this.setPushpinContainerPosition(pushpin);\n        } else {\n            const newPosX = pushpin.marker.position.x - this.pushpinContainer.position.x;\n            const newPosY = pushpin.marker.position.y - this.pushpinContainer.position.y;\n            pushpin.marker.style.transform = `translate(${newPosX}px, ${newPosY}px)`;\n        }\n    }\n\n    removePushpin(pushpin) {\n        this.pushpins = this.pushpins.filter((curPushpin) => {\n            if (this.selectedPushpin && this.selectedPushpin.data.id === pushpin.data.id) {\n                this.selectedPushpin = null;\n            }\n\n            return curPushpin.data.id !== pushpin.data.id;\n        });\n\n        this.destroyMarker(pushpin);\n    }\n\n    removeAll() {\n        this.pushpins.forEach((pushpin) => {\n            this.removePushpin(pushpin);\n        });\n    }\n\n    destroyMarker(pushpin) {\n        this.destroyLabel(pushpin);\n        this.pushpinContainer.removeChild(pushpin.marker);\n        pushpin.marker = undefined;\n    }\n\n    destroyLabel(pushpin) {\n        if (pushpin.label) {\n            pushpin.marker.removeChild(pushpin.label.container);\n            pushpin.label = undefined;\n        }\n    }\n\n    setPushpinContainerPosition(pushpin) {\n        const xTranslate = pushpin.marker.position.x - (markerOffsets.markerOffsetWidth / 2);\n        const yTranslate = pushpin.marker.position.y - (markerOffsets.markerOffsetWidth / 2);\n\n        this.pushpinContainer.initPos = pushpin.intersectPoint;\n        this.pushpinContainer.position.x = pushpin.marker.position.x;\n        this.pushpinContainer.position.y = pushpin.marker.position.y;\n        this.pushpinContainer.style.transform = `translate(${xTranslate}px, ${yTranslate}px)`;\n    }\n\n    setMarkerPosition(pushpin) {\n        pushpin.marker.position = this.project(pushpin);\n    }\n\n    updateStyle(status, size, hex) {\n        statusHexValues[status] = hex;\n        this.dirty = true;\n    }\n\n    updateContainerProjection() {\n        if (this.pushpins.length > 0) {\n            const newPosition = { marker: { intersectPoint: this.pushpinContainer.initPos } };\n            const updatedPosition = this.pushpinContainer.position = this.project(newPosition);\n            const offsetWidth = markerOffsets.markerOffsetWidth;\n\n            const xTranslate = updatedPosition.x - (offsetWidth / 2);\n            const yTranslate = updatedPosition.y - (offsetWidth / 2);\n\n            this.pushpinContainer.style.transform = `translate(${xTranslate}px, ${yTranslate}px)`;\n        }\n\n        // Update the DOM\n        this.pushpins.forEach((pushpin) => {\n            this.updatePushpin(pushpin);\n        });\n\n        this.dirty = false;\n    }\n\n    updatePushpinsProjection() {\n        this.redraw = true;\n        this.pushpins.forEach((pushpin) => {\n            this.setMarkerPosition(pushpin);\n        });\n\n        this.pushpins.forEach((pushpin) => {\n            if (this.redraw) {\n                this.setPushpinContainerPosition(pushpin);\n                this.redraw = false;\n            }\n\n            const xPos = pushpin.marker.position.x - this.pushpinContainer.position.x;\n            const yPos = pushpin.marker.position.y - this.pushpinContainer.position.y;\n            pushpin.marker.style.transform = `translate(${xPos}px, ${yPos}px)`;\n\n            this.updatePushpin(pushpin);\n        });\n\n        this.dirty = false;\n    }\n\n    updatePushpin(pushpin) {\n        if (this.dirty) {\n            if (pushpin.label) {\n                pushpin.label.update(pushpin.data.label);\n            }\n\n            pushpin.draggable ? this.enableDragging(pushpin) : this.disableDragging(pushpin);\n            pushpin.marker.style.backgroundColor = statusHexValues[pushpin.data.status];\n            pushpin.visible ? this.showMarker(pushpin.marker) : this.hideMarker(pushpin.marker);\n        }\n    }\n\n    setDirty() {\n        this.dirty = true;\n    }\n\n    selectPushpin(pushpin) {\n        this.deselect();\n        this.viewer.clearSelection();\n\n        pushpin.label = new PushPinBillboardLabel(pushpin.marker, pushpin.data.label);\n        pushpin.marker.classList.add('selected');\n\n        this.selectedPushpin = pushpin;\n        pushpin.draggable ? this.enableDragging(pushpin) : this.disableDragging(pushpin);\n    }\n\n    deselect() {\n        if (this.selectedPushpin) {\n            this.destroyLabel(this.selectedPushpin);\n            this.selectedPushpin.marker.style.pointerEvents = 'none';\n            this.selectedPushpin.marker.classList.remove('selected');\n            this.selectedPushpin = null;\n        }\n    }\n\n    enableDragging(item) {\n        if (this.selectedPushpin && this.selectedPushpin.data.id === item.data.id) {\n            item.marker.style.pointerEvents = 'auto';\n        }\n\n        item.marker.style.backgroundImage = moveableIcon;\n    }\n\n    disableDragging(item) {\n        const selectedItem = item || this.selectedPushpin;\n\n        selectedItem.marker.style.pointerEvents = 'none';\n        selectedItem.marker.style.backgroundImage = 'none';\n        selectedItem.draggable = false;\n    }\n\n    showMarker(marker) {\n        marker.style.display = '';\n    }\n\n    hideMarker(marker) {\n        marker.style.display = 'none';\n    }\n\n    showMarkers() {\n        this.pushpins.forEach((pushpin) => {\n            (pushpin.visible) ? this.showMarker(pushpin.marker) : this.hideMarker(pushpin.marker);\n        });\n    }\n\n    hideMarkers() {\n        this.pushpins.forEach((pushpin) => {\n            this.hideMarker(pushpin.marker);\n        });\n\n        if (this.selectedPushpin) {\n            this.destroyLabel(this.selectedPushpin);\n        }\n    }\n\n\n    handleButtonDown(event, button) {\n        return false;\n    }\n\n    handleButtonUp(event, button) {\n        return false;\n    }\n\n    handleResize() {\n        setTimeout(() => {\n            this.updatePushpinsProjection();\n        }, 1);\n    }\n}\n\nav.GlobalManagerMixin.call(PushPinBillboardTool2D.prototype);\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.PushPinBillboardTool2D = PushPinBillboardTool2D;\n","export default class PushPinInputHandler {\n    constructor(pushpinRenderer) {\n        this.pushpin = null;\n        this.pushpinRenderer = pushpinRenderer;\n        this.mousePosition = { x: 0, y: 0 };\n\n        this.onTouchDragBinded = this.onTouchDrag.bind(this);\n        this.onMouseMoveBinded = this.onMouseMove.bind(this);\n        this.onMouseUpBinded = this.onMouseUp.bind(this);\n        this.onMouseDownBinded = this.onMouseDown.bind(this);\n        this.onHammerInputBinded = this.onHammerInput.bind(this);\n\n        this.mouseEnabled = false;\n        this.mousePrevValue = false;\n        this.lock = false;\n    }\n\n    // Convert Hammer touch-event X,Y into mouse-event X,Y.\n    static convertEventHammerToMouse(event) {\n        event.shiftKey = false;\n        event.clientX = event.pointers[0].clientX;\n        event.clientY = event.pointers[0].clientY;\n    }\n\n    processMouseEvent(event) {\n        this.mousePosition.x = event.clientX;\n        this.mousePosition.y = event.clientY;\n    }\n\n    attachTo(pushpin) {\n        if (this.pushpin) {\n            this.detach();\n        }\n\n        this.pushpin = pushpin;\n\n        if (Autodesk.Viewing.isTouchDevice()) {\n            this.hammer = new Autodesk.Viewing.Hammer.Manager(pushpin, {\n                recognizers: [\n                    Autodesk.Viewing.GestureRecognizers.drag\n                ],\n                inputClass: Autodesk.Viewing.isIE11 ? Hammer.PointerEventInput : Hammer.TouchInput\n            });\n\n            this.hammer.on('dragstart dragmove dragend', this.onTouchDragBinded);\n            this.hammer.on('hammer.input', this.onHammerInputBinded);\n        }\n\n        if (!Autodesk.Viewing.isMobileDevice()) {\n            this.enableMouseButtons(true);\n        }\n    }\n\n    onHammerInput(event) {\n        this.setMouseDisabledWhenTouching(event);\n    }\n\n    setMouseDisabledWhenTouching(event) {\n        if (event.isFirst && !this.lock) {\n            this.enableMouseButtons(false);\n            this.lock = true;\n        } else if (event.isFinal) {\n            setTimeout(() => {\n                this.enableMouseButtons(this.mousePrevValue);\n                this.lock = false;\n            }, 10);\n        }\n    }\n\n    enableMouseButtons(state) {\n        if (state && !this.mouseEnabled) {\n            this.pushpin.addEventListener('mousedown', this.onMouseDownBinded);\n            this.pushpinRenderer.viewer.container.addEventListener('mousemove', this.onMouseMoveBinded);\n            this.pushpinRenderer.viewer.container.addEventListener('mouseup', this.onMouseUpBinded);\n        } else if (!state && this.mouseEnabled) {\n            this.pushpin.removeEventListener('mousedown', this.onMouseDownBinded);\n            this.pushpinRenderer.viewer.container.removeEventListener('mousemove', this.onMouseMoveBinded);\n            this.pushpinRenderer.viewer.container.removeEventListener('mouseup', this.onMouseUpBinded);\n        }\n\n        this.mousePrevValue = this.mouseEnabled;\n        this.mouseEnabled = state;\n    }\n\n    detach() {\n        if (this.hammer) {\n            this.hammer.destroy();\n        }\n\n        this.pushpinRenderer.viewer.container.removeEventListener('mousemove', this.onMouseMoveBinded);\n        this.pushpinRenderer.viewer.container.removeEventListener('mouseup', this.onMouseUpBinded);\n\n        if (this.pushpin) {\n            this.pushpin.removeEventListener('mousedown', this.onMouseDownBinded);\n\n            this.pushpin = null;\n        }\n\n        this.mouseEnabled = false;\n    }\n\n    onMouseMove(event) {\n        this.processMouseEvent(event);\n        this.pushpinRenderer.handleMouseMove(event);\n        event.preventDefault();\n    }\n\n    onMouseDown(event) {\n        this.processMouseEvent(event);\n        this.pushpinRenderer.handleMouseDown(event);\n        event.preventDefault();\n    }\n\n    onMouseUp(event) {\n        this.processMouseEvent(event);\n        this.pushpinRenderer.handleMouseUp(event);\n        event.preventDefault();\n    }\n\n    onTouchDrag(event) {\n        PushPinInputHandler.convertEventHammerToMouse(event);\n        switch (event.type) {\n            case 'dragstart':\n                this.onMouseDown(event);\n                break;\n            case 'dragmove':\n                this.onMouseMove(event);\n                break;\n            case 'dragend':\n                this.onMouseUp(event);\n                break;\n            default:\n                break;\n        }\n\n        event.preventDefault();\n    }\n}\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\nnamespace.PushPinInputHandler = PushPinInputHandler;\n","import PushPinBillboardTool2D from '../PushPins2D/PushPinBillboardTool2D';\nimport PushPinInputHandler from '../PushPinInputHandler';\nimport { clientToWorld, convertPdfToLeaflet } from '../PushPinUtils';\nimport { PUSHPIN_EVENTS } from '../PushPinEvents';\n\nconst av = Autodesk.Viewing;\n\nexport default class RenderHandler2D {\n    constructor(viewerApi, pushPinManager) {\n        this.viewer = viewerApi;\n        this.setGlobalManager(this.viewer.globalManager);\n        this.pushPinManager = pushPinManager;\n        this.pushpinDirty = false;\n        this.selectedItem = null;\n\n        this.onSelectedChangedBind = e => this.onSelectedChanged(e);\n        this.onRemoveBind = e => this.onRemove(e);\n        this.onRemoveAllBind = e => this.onRemoveAll(e);\n        this.onModifyBind = e => this.onModify(e);\n        this.onUpdateBind = e => this.onUpdate(e);\n        this.createBind = e => this.create(e);\n        this.onVisibilityChangedBind = e => this.onVisibilityChanged(e);\n    }\n\n    register() {\n        this.pushpinBillboardTool = new PushPinBillboardTool2D(this.viewer);\n        this.viewer.toolController.registerTool(this.pushpinBillboardTool);\n    }\n\n    deregister() {\n        if (this.pushpinBillboardTool) {\n            this.viewer.toolController.deregisterTool(this.pushpinBillboardTool);\n            this.pushpinBillboardTool = null;\n        }\n    }\n\n    activate() {\n        if (!this.pushpinBillboardTool.isActive()) {\n            this.viewer.toolController.activateTool('pushpinBillboard2D');\n        }\n\n        this.inputHandler = new PushPinInputHandler(this);\n\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, this.onSelectedChangedBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onRemoveBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.onRemoveAllBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, this.onModifyBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, this.onUpdateBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, this.onVisibilityChangedBind);\n        this.pushPinManager.setCreateFunction(this.createBind);\n\n        return true;\n    }\n\n    deactivate() {\n        if (this.pushpinBillboardTool.isActive()) {\n            this.viewer.toolController.deactivateTool('pushpinBillboard2D');\n        }\n\n        this.inputHandler.detach();\n\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, this.onSelectedChangedBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onRemoveBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.onRemoveAllBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, this.onModifyBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, this.onUpdateBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, this.onVisibilityChangedBind);\n        this.pushPinManager.removeCreateFunction(this.createBind);\n\n    }\n\n    setPushpinDirty() {\n        this.pushpinDirty = true;\n    }\n\n    onSelectedChanged(event) {\n        if (event.value) {\n            this.selectedItem = event.value;\n\n            if (!this.selectedItem.marker) {\n                this.create(this.selectedItem);\n            }\n\n            this.pushpinBillboardTool.selectPushpin(this.selectedItem);\n            this.focusCameraOnSelectedItem(this.selectedItem);\n\n            if (this.selectedItem.draggable) {\n                this.enableItemDragging(this.selectedItem);\n            }\n\n            this.viewer.dispatchEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT });\n        } else {\n            this.deselectItem();\n            this.pushpinBillboardTool.deselect();\n        }\n\n        this.setPushpinDirty();\n    }\n\n    deselectItem() {\n        this.selectedItem = null;\n        this.inputHandler.detach();\n    }\n\n    onRemove(event) {\n        if (this.selectedItem && event.value.data.id === this.selectedItem.data.id) {\n            this.deselectItem();\n        }\n\n        if (event.value && event.value.marker) {\n            this.pushpinBillboardTool.removePushpin(event.value);\n        }\n    }\n\n    onRemoveAll() {\n        this.deselectItem();\n        this.pushpinBillboardTool.removeAll();\n    }\n\n    onModify() {\n        this.pushpinDirty = true;\n    }\n\n    onVisibilityChanged() {\n        this.pushpinBillboardTool.showMarkers();\n    }\n\n    onUpdate() {\n        setTimeout(() => {\n            this.setPushpinDirty();\n\n            // it could happen that the extension was removed in the meantime\n            this.pushpinBillboardTool && this.pushpinBillboardTool.setDirty();\n            const selectedItem = this.pushPinManager ? this.pushPinManager.getSelectedItem() : null;\n\n            if (!selectedItem) {\n                return;\n            }\n\n            (selectedItem.draggable && selectedItem.marker) ?\n                this.enableItemDragging(selectedItem) :\n                this.disableItemDragging(selectedItem);\n        }, 1);\n    }\n\n    enableItemDragging(item) {\n        this.pushpinBillboardTool.enableDragging(item);\n        this.inputHandler.attachTo(item.marker);\n    }\n\n    disableItemDragging(item) {\n        this.pushpinBillboardTool.disableDragging(item);\n        this.inputHandler.detach();\n    }\n\n    create(item) {\n        // iOS have a special case where they already have the UUID, so we act like we are re-selecting an existing item\n        return this.createRenderItem(item, Autodesk.Viewing.isIOSDevice());\n    }\n\n    createRenderItem(item, reselect) {\n        // Make sure it's a uuid and not a growing counter\n        const isLoaded = (item.data.id.length > 20);\n\n        // If we are actually creating a new pushpin (and not just loading one), make sure to deselect the previous selected one.\n        if (!isLoaded) {\n            this.pushpinBillboardTool.deselect();\n        }\n\n        let promise;\n        if (isLoaded && !reselect) {\n            promise = this.pushpinBillboardTool.loadPushpin(item);\n        } else {\n            promise = this.pushpinBillboardTool.createPushpin(item);\n            this.pushPinManager.selectOne(item.data.id);\n        }\n\n        return promise;\n    }\n\n    updatePattern(status, size, hex) {\n        this.pushpinBillboardTool.updateStyle(status, size, hex);\n\n        this.setPushpinDirty();\n    }\n\n    focusCameraOnSelectedItem(item) {\n        if (item.marker) {\n            const padding = 0.2;\n\n            const modelBounds = this.viewer.utilities.getBoundingBox(true);\n            const modelWidth = (modelBounds.max.x - modelBounds.min.x) * padding;\n            const modelHeight = (modelBounds.max.y - modelBounds.min.y) * padding;\n\n            const min = new THREE.Vector3(item.marker.intersectPoint.x - modelWidth, item.marker.intersectPoint.y - modelHeight, 0);\n            const max = new THREE.Vector3(item.marker.intersectPoint.x + modelWidth, item.marker.intersectPoint.y + modelHeight, 0);\n            const bounds = new THREE.Box3(min, max);\n\n            this.viewer.navigation.fitBounds(this.pushPinManager.restoreViewerStateImmediate, bounds, false);\n        }\n    }\n\n    render() {\n        if (!this.pushPinManager || !this.viewer.model) {\n            return;\n        }\n\n        this.pushPinManager.items().reverse().forEach((item) => {\n            if (!item.marker) {\n                this.createRenderItem(item, false);\n            }\n        });\n\n        if (this.pushpinDirty) {\n            this.pushpinBillboardTool.updateContainerProjection();\n            this.pushpinDirty = false;\n        }\n    }\n\n    findIntersections(event) {\n        const mouseX = event.clientX;\n        const mouseY = event.clientY;\n\n        let hitItem = null;\n\n        this.pushPinManager.items().some((item) => {\n            if (item.selectable && item.marker) {\n                const bb = item.marker.getBoundingClientRect();\n                if (mouseX > bb.left && mouseX < bb.left + bb.width && mouseY > bb.top && mouseY < bb.top + bb.height) {\n                    hitItem = item;\n                    return true;\n                }\n            }\n            return false;\n        });\n\n        return hitItem;\n    }\n\n    handleMouseMove(e) {\n        const self = this;\n        function mouseCoords(ev) {\n            if (ev.pageX || ev.pageY) {\n                return { x: ev.pageX, y: ev.pageY };\n            }\n\n            const _document = self.getDocument();\n            return {\n                x: (ev.clientX + _document.body.scrollLeft) - _document.body.clientLeft,\n                y: (ev.clientY + _document.body.scrollTop) - _document.body.clientTop\n            };\n        }\n\n        if (this.selectedItem.marker && this.selectedItem.marker.startDragging) {\n            // only on first mouse movement\n            if (!this.newX) {\n                this.selectedItem.marker.style.transform = 'translate(0px, 0px)';\n            }\n\n            const mousePos = mouseCoords(e);\n\n            this.newX = mousePos.x - this.mouseOffset.x;\n            this.newY = mousePos.y - this.mouseOffset.y;\n\n            // Check left, top, right, bottom\n            const containerBounds = this.viewer.navigation.getScreenViewport();\n            const wi = this.selectedItem.marker.clientWidth;\n            const hi = this.selectedItem.marker.clientHeight;\n\n            if (this.newX < 5) {\n                this.newX = 0;\n            }\n            if (this.newY < 5) {\n                this.newY = 0;\n            }\n            if (containerBounds.width - 5 < this.newX + wi) {\n                this.newX = containerBounds.width - wi;\n            }\n            if (containerBounds.height - 5 < this.newY + hi) {\n                this.newY = containerBounds.height - hi;\n            }\n\n            const containerPosX = this.pushpinBillboardTool.pushpinContainer.position.x;\n            const containerPosY = this.pushpinBillboardTool.pushpinContainer.position.y;\n\n            this.selectedItem.marker.style.left = `${this.newX - containerPosX}px`;\n            this.selectedItem.marker.style.top = `${this.newY - containerPosY}px`;\n\n            this.selectedItem.marker.dragging = true;\n\n            this.pushPinManager.hoverLocations(event);\n        }\n    }\n\n    handleMouseUp(e) {\n        if (this.selectedItem.marker) {\n            if (this.selectedItem.marker.dragging) {\n                const containerPosX = this.pushpinBillboardTool.pushpinContainer.position.x;\n                const containerPosY = this.pushpinBillboardTool.pushpinContainer.position.y;\n\n                this.selectedItem.marker.style.transform = `translate(${this.newX - containerPosX}px, ${this.newY - containerPosY}px)`;\n\n                const result = clientToWorld(this.viewer, this.newX, this.newY);\n\n                this.selectedItem.data.position = { x: result.x, y: result.y, z: result.z };\n\n                this.pushPinManager.setItemLocationIds(this.selectedItem);\n                this.pushPinManager.generateThumbnail(this.selectedItem).then((thumbnail) => {\n\n                    const { x, y, z } = this.selectedItem.data.position; // Backup position.\n\n                    if (this.viewer.model.isPdf(true)) {\n                        convertPdfToLeaflet(this.viewer, this.selectedItem.data);\n                    }\n\n                    this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, value: this.selectedItem, thumbnail });\n\n                    this.selectedItem.data.position = { x, y, z }; // Restore position.\n                });\n\n                this.pushpinBillboardTool.removeAll();\n                this.render();\n                this.pushpinBillboardTool.selectPushpin(this.pushPinManager.selectedItem);\n                if (this.selectedItem.draggable) {\n                    this.enableItemDragging(this.selectedItem);\n                }\n            } else {\n                this.selectedItem.marker.startDragging = false;\n            }\n        }\n    }\n\n    handleMouseDown(event) {\n        function getOffset(e) {\n            let left = 0;\n            let top = 0;\n\n            while (e.offsetParent) {\n                left += e.offsetLeft;\n                top += e.offsetTop;\n                e = e.offsetParent;\n            }\n\n            left += e.offsetLeft;\n            top += e.offsetTop;\n            return { x: left, y: top };\n        }\n\n        if (this.selectedItem.marker) {\n            if (event.target.tagName.toLowerCase() === 'textarea') {\n                return;\n            }\n\n            this.mouseOffset = getOffset(this.viewer.container);\n\n            this.newX = null;\n            this.newY = null;\n\n            this.selectedItem.marker.startDragging = true;\n        }\n    }\n}\n\nav.GlobalManagerMixin.call(RenderHandler2D.prototype);\n","import PushPinBillboardLabel from '../PushPinLabel/PushPinBillboardLabel';\nimport { statusHexValues, moveableIcon, markerOffsets, ATTRIBUTES_VERSION } from '../PushPinConstants';\nimport { generateMetadata } from '../PushPins3D/PushPinViewerState';\nimport { applyModelTransform } from '../PushPinUtils';\n\nconst av = Autodesk.Viewing;\n\nexport default class PushPinBillboardTool3D {\n    constructor(viewer, options = {}) {\n        this.names = ['pushpinBillboard3D'];\n\n        this.viewer = viewer;\n        this.setGlobalManager(viewer.globalManager);\n\n        this.active = false;\n\n        this.pushpins = [];\n        this.selectedPushpin = null;\n        this.dirty = false;\n        this.camera = this.viewer.navigation.getCamera();\n\n        const raycastLimitPerSecond = 200; // execute at most once every x milliseconds.\n        this.maxMsPerRayCastCycle = 20;\n        this.updateTimestamp = 0;\n\n        this.tmpVec = new THREE.Vector3();\n        this.tmpMatrix = new THREE.Matrix4();\n        this.tmpFrustum = new THREE.Frustum();\n\n        if (!options.disableOcclusionTest) {\n            // Ray-casts for occlusion tests. The only purpose is to change the opacity of occluded PushPins, at the costs of:\n            //  - Memory: Loading the externalID file (may be huge for large projects)\n            //  - Performance: Repeatedly firing lots of raytests and worker tasks (#PushPins separate queries per camera change)\n            this.raycastThrottle = this.throttle(() => {\n                this.continueRayCasts();\n            }, raycastLimitPerSecond);\n        } else {\n            // Bypass raycasts for occlusion checks.\n            this.raycastThrottle = () => {};\n        }\n    }\n\n    continueRayCasts() {\n        const stamp = performance.now();\n        let i = 0;\n        for (; i < this.pushpins.length; i++) {\n            const pushpin = this.pushpins[i];\n            if (!pushpin.visible) {\n                continue;\n            }\n            if (pushpin.updateTimestamp !== this.updateTimestamp) {\n                pushpin.updateTimestamp = this.updateTimestamp;\n                this.castRay(pushpin);\n                if (performance.now() > stamp + this.maxMsPerRayCastCycle) {\n                    break;\n                }\n            }\n        }\n\n        // Make sure that we continue if we couldn't do them all\n        if (i < this.pushpins.length) {\n            this.raycastThrottle();\n        }\n    }\n\n    getNames() {\n        return this.names;\n    }\n\n    getName() {\n        return this.names[0];\n    }\n\n    isActive() {\n        return this.active;\n    }\n\n    activate(name) {\n        if (name === this.getName()) {\n            this.active = true;\n\n            this.onCameraChangeBinded = e => this.onCameraChange(e);\n            this.handleResizeBinded = e => this.handleResize(e);\n\n            this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n            this.viewer.addEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT, this.onCameraChangeBinded);\n            this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.handleResizeBinded);\n        }\n    }\n\n    throttle(callback, wait, context = this) {\n        let timeout = null;\n        let callbackArgs = null;\n\n        const later = () => {\n            timeout = null;\n            callback.apply(context, callbackArgs);\n        };\n\n        return function () {\n            if (!timeout) {\n                callbackArgs = arguments;\n                timeout = setTimeout(later, wait);\n            }\n        };\n    }\n\n    deactivate(name) {\n        if (name === this.getName()) {\n            this.active = false;\n\n            this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n            this.viewer.removeEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT, this.onCameraChangeBinded);\n            this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.handleResizeBinded);\n        }\n    }\n\n    onCameraChange() {\n        this.updatePushpins();\n    }\n\n    project(pushpin) {\n        const position = pushpin.marker.intersectPoint;\n        const containerBounds = this.viewer.navigation.getScreenViewport();\n        const p = this.tmpVec.copy(position);\n\n        const model = pushpin.findModel(this.viewer);\n\n        applyModelTransform(p, model);\n        \n        this.tmpMatrix.multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse);\n\n        // We don't change visibility if pushpin is hidden anyway\n        if (pushpin.visible) {\n            this.tmpFrustum.setFromMatrix(this.tmpMatrix);\n            (!this.tmpFrustum.containsPoint(p)) ? this.hideMarker(pushpin.marker) : this.showMarker(pushpin.marker);\n        }\n\n        p.applyProjection(this.tmpMatrix);\n\n        return new THREE.Vector3(\n            Math.round(((p.x + 1) / 2) * containerBounds.width),\n            Math.round(((-p.y + 1) / 2) * containerBounds.height),\n            p.z\n        );\n    }\n\n    unproject(position) {\n        const containerBounds = this.viewer.navigation.getScreenViewport();\n        const p = new THREE.Vector3();\n\n        p.x = ((position.x / containerBounds.width) * 2) - 1;\n        p.y = -(((position.y / containerBounds.height) * 2) - 1);\n        p.z = position.z;\n        p.unproject(this.camera);\n\n        return p;\n    }\n\n    initNewPushpin(item) {\n        item.intersectPoint = item.data.position;\n\n        this.pushpins.push(item);\n\n        this.createMarker(item);\n\n        item.draggable ? this.enableDragging(item) : this.disableDragging(item);\n        item.visible ? this.showMarker(item.marker) : this.hideMarker(item.marker);\n    }\n\n    fetchExternalId(model, dbId, callback) {\n        return new Promise((resolve, reject) => {\n            const onSuccessCallback = (props) => {\n                let externalId = props.externalId;\n\n                // For some files (i.e. STEP) the externalId is an array that contains the whole hierarchy of the element\n                // Since we need only a string in the end we take the last element (the hierarchy is concatenated anyway,\n                // so each element contains the whole information needed to identify it)\n                if (externalId.startsWith('[') && externalId.endsWith(']')) {\n                    try {\n                        const parsedExternalId = JSON.parse(externalId);\n                        if (Array.isArray(parsedExternalId)) {\n                            externalId = parsedExternalId[parsedExternalId.length - 1];\n                        }\n                    } catch(e) {\n                        console.error('Error ' + e + ' parsing externalId ', externalId);\n                    }\n                }\n\n                // https://wiki.autodesk.com/pages/viewpage.action?spaceKey=saascore&title=Comparison+of+different+behaviors+between+SVF+and+SVF2\n                // Look for \"ifcGUID\" in the wiki above - In SVF2, the ifcGUID is used as the externalID of object.\n                if (!model.isOTG() && model.getData().loadOptions.fileExt === 'ifc') {\n                    const ifcId = props.properties.find(el => el.displayName === 'IfcGUID' || (el.displayName === 'GLOBALID' && el.displayCategory === 'IFC'));\n                    if (ifcId) {\n                        externalId = ifcId.displayValue;\n                    } else { // If there's no IFC id, look at the parent\n                        const parentDbId = props.properties.find(el => el.displayName === 'parent' && el.displayValue > -1);\n                        if (parentDbId) {\n                            resolve(this.fetchExternalId(model, parentDbId.displayValue, callback));\n                            return;\n                        }\n                    }\n                }\n                callback(externalId);\n                resolve();\n            };\n\n            const onErrorCallback = (status, message, data) => {\n                Autodesk.Viewing.Private.logger.warn(message);\n                resolve(); // Log the message but don't fail\n            };\n\n            model.getProperties2(dbId, onSuccessCallback, onErrorCallback, { needsExternalId: true });\n        });\n    }\n\n    createPushpin(item) {\n        item.data.attributesVersion = ATTRIBUTES_VERSION;\n\n        this.initNewPushpin(item);\n\n        item.setViewerState(generateMetadata(this.viewer, item));\n\n        this.selectPushpin(item);\n\n        const vpVec = this.viewer.impl.clientToViewport(item.marker.position.x, item.marker.position.y);\n        const res = this.viewer.impl.castRayViewport(vpVec, false);\n\n        if (res) {\n            item.setObjectId(res.dbId);\n            item.setObjectData(res);\n\n            const model = item.findModel(this.viewer);\n            if (!model) {\n                console.error('Failed to assign externalId: The model for this PushPin is not loaded.');\n                return Promise.resolve();\n            }\n\n            return this.fetchExternalId(model, res.dbId, externalId => item.setExternalId(externalId));\n        } else {\n            return Promise.resolve();\n        }\n    }\n\n    loadPushpin(item) {\n        this.initNewPushpin(item);\n\n        return Promise.resolve();\n    }\n\n    createMarker(pushpin) {\n        const _document = this.getDocument();\n        const marker = _document.createElement('div');\n        pushpin.marker = marker;\n        \n        marker.id = pushpin.data.id;\n        marker.intersectPoint = pushpin.intersectPoint;\n\n        if (pushpin.hasPosition()) {\n            const className = (pushpin.data.type === 'rfis') ? 'rfi-billboard-marker' : 'pushpin-billboard-marker';\n\n            marker.classList.add(className);\n            marker.style.backgroundColor = statusHexValues[pushpin.data.status];\n\n            this.viewer.container.appendChild(marker);\n            \n            this.setMarkerPosition(pushpin);\n\n            const xTranslate = pushpin.marker.position.x - (markerOffsets.markerOffsetWidth / 2);\n            const yTranslate = pushpin.marker.position.y - (markerOffsets.markerOffsetWidth / 2);\n\n            pushpin.marker.style.transform = `translate(${xTranslate}px, ${yTranslate}px)`;\n        } else {\n            // Imported issues (such as from BCF) can arrive without a position. They just store the camera state\n            // In that case create a dummy marker (since the extension assumes it exists in many places) and don't \n            // add it to the viewer.container\n            this.hideMarker(marker);\n            pushpin.visible = false;\n        }\n    }\n\n    removePushpin(pushpin) {\n        this.pushpins = this.pushpins.filter((curPushpin) => {\n            if (this.selectedPushpin && this.selectedPushpin.data.id === pushpin.data.id) {\n                this.selectedPushpin = null;\n            }\n\n            return curPushpin.data.id !== pushpin.data.id;\n        });\n\n        this.destroyMarker(pushpin);\n    }\n\n    removeAll() {\n        this.pushpins.forEach((pushpin) => {\n            this.removePushpin(pushpin);\n        });\n    }\n\n    destroyMarker(pushpin) {\n        this.destroyLabel(pushpin);\n        this.viewer.container.removeChild(pushpin.marker);\n        pushpin.marker = undefined;\n    }\n\n    destroyLabel(pushpin) {\n        if (pushpin.label) {\n            pushpin.marker.removeChild(pushpin.label.container);\n            pushpin.label = undefined;\n        }\n    }\n\n    setMarkerPosition(pushpin) {\n        pushpin.marker.position = this.project(pushpin);\n    }\n\n    updateStyle(status, size, hex) {\n        statusHexValues[status] = hex;\n        this.dirty = true;\n    }\n\n    castRay(pushpin) {\n        const objectId = parseInt(pushpin.data.objectId, 10);\n        if (isNaN(objectId) || objectId === -1) { // no check needed\n            return;\n        }\n\n        const vpVec = this.viewer.impl.clientToViewport(pushpin.marker.position.x, pushpin.marker.position.y);\n        const res = this.viewer.impl.castRayViewport(vpVec, false); \n        if (res && res.dbId) {\n            if (pushpin.data.externalId) {\n                return this.fetchExternalId(res.model, res.dbId, (externalId) => {\n                    // it could happen that the pushpin was removed in the meantime\n                    if (pushpin && pushpin.marker && pushpin.data) {\n                        pushpin.marker.style.opacity = (externalId === pushpin.data.externalId) ? '1.0' : '0.15';\n                    }\n                });\n            }\n            if (pushpin.data.objectId && parseInt(pushpin.data.objectId, 10) !== -1) {\n                pushpin.marker.style.opacity = (res.dbId === parseInt(pushpin.data.objectId, 10)) ? '1.0' : '0.15';\n            }\n        } else { // no object was hit\n            pushpin.marker.style.opacity = '0.15';\n        }\n    }\n\n    updatePushpins() {\n        // Calc new position\n        this.updateTimestamp++;\n        this.raycastThrottle();\n\n        this.pushpins.forEach((pushpin) => {\n            this.setMarkerPosition(pushpin);\n        });\n\n        // Update the DOM\n        this.pushpins.forEach((pushpin) => {\n            const offsetWidth = pushpin.selected ? markerOffsets.selectedMarkerOffsetWidth : markerOffsets.markerOffsetWidth;\n\n            const xTranslate = pushpin.marker.position.x - (offsetWidth / 2);\n            const yTranslate = pushpin.marker.position.y - (offsetWidth / 2);\n\n            pushpin.marker.style.transform = `translate(${xTranslate}px, ${yTranslate}px)`;\n\n            if (this.dirty) {\n                if (pushpin.label) {\n                    pushpin.label.update(pushpin.data.label);\n                }\n\n                pushpin.draggable ? this.enableDragging(pushpin) : this.disableDragging(pushpin);\n                pushpin.marker.style.backgroundColor = statusHexValues[pushpin.data.status];\n                pushpin.visible ? this.showMarker(pushpin.marker) : this.hideMarker(pushpin.marker);\n            }\n        });\n\n        this.dirty = false;\n    }\n\n    setDirty() {\n        this.dirty = true;\n    }\n\n    selectPushpin(pushpin) {\n        this.deselect();\n        this.viewer.clearSelection();\n\n        pushpin.label = new PushPinBillboardLabel(pushpin.marker, pushpin.data.label);\n        pushpin.marker.classList.add('selected');\n\n        this.selectedPushpin = pushpin;\n    }\n\n    deselect() {\n        if (this.selectedPushpin) {\n            this.destroyLabel(this.selectedPushpin);\n            this.selectedPushpin.marker.style.pointerEvents = 'none';\n            this.selectedPushpin.marker.classList.remove('selected');\n            this.selectedPushpin = null;\n        }\n    }\n\n    enableDragging(item) {\n        if (this.selectedPushpin && this.selectedPushpin.data.id === item.data.id) {\n            item.marker.style.pointerEvents = 'auto';\n        }\n        item.marker.style.backgroundImage = moveableIcon;\n    }\n\n    disableDragging(item) {\n        const selectedItem = item || this.selectedPushpin;\n\n        selectedItem.marker.style.pointerEvents = 'none';\n        selectedItem.marker.style.backgroundImage = 'none';\n        selectedItem.draggable = false;\n    }\n\n    hideLabel() {\n        if (this.selectedPushpin) {\n            this.selectedPushpin.label.hide();\n        }\n    }\n\n    showMarker(marker) {\n        marker.style.display = '';\n    }\n\n    hideMarker(marker) {\n        marker.style.display = 'none';\n    }\n\n    showMarkers() {\n        this.pushpins.forEach((pushpin) => {\n            (pushpin.visible) ? this.project(pushpin) : this.hideMarker(pushpin.marker);\n        });\n    }\n\n    hideMarkers() {\n        this.pushpins.forEach((pushpin) => {\n            this.hideMarker(pushpin.marker);\n        });\n\n        if (this.selectedPushpin) {\n            this.destroyLabel(this.selectedPushpin);\n        }\n    }\n\n\n    handleButtonDown(event, button) {\n        return false;\n    }\n\n    handleButtonUp(event, button) {\n        return false;\n    }\n\n    handleResize() {\n        this.updatePushpins();\n    }\n}\n\nav.GlobalManagerMixin.call(PushPinBillboardTool3D.prototype);\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.PushPinBillboardTool3D = PushPinBillboardTool3D;\n","import PushPinBillboardTool3D from '../PushPins3D/PushPinBillboardTool3D';\nimport PushPinInputHandler from '../PushPinInputHandler';\nimport { PUSHPIN_EVENTS } from '../PushPinEvents';\nimport { restoreViewState } from '../PushPins3D/PushPinViewerState';\nimport { markerOffsets } from '../PushPinConstants';\nimport { invertModelTransform } from \"../PushPinUtils\";\n\nconst av = Autodesk.Viewing;\n\nexport default class RenderHandler3D {\n    constructor(viewerApi, pushPinManager) {\n        this.viewer = viewerApi;\n        this.setGlobalManager(this.viewer.globalManager);\n        this.pushPinManager = pushPinManager;\n        this.pushpinDirty = false;\n        this.selectedItem = null;\n\n        this.onSectionBind = e => this.onSection(e);\n\n        this.onSelectedChangedBind = e => this.onSelectedChanged(e);\n        this.onRemoveBind = e => this.onRemove(e);\n        this.onRemoveAllBind = e => this.onRemoveAll(e);\n        this.onModifyBind = e => this.onModify(e);\n        this.onUpdateBind = e => this.onUpdate(e);\n        this.createBind = e => this.create(e);\n        this.onVisibilityChangedBind = e => this.onVisibilityChanged(e);\n    }\n\n    register() {\n        this.pushpinBillboardTool = new PushPinBillboardTool3D(this.viewer, this.pushPinManager.options);\n        this.viewer.toolController.registerTool(this.pushpinBillboardTool);\n    }\n\n    deregister() {\n        if (this.pushpinBillboardTool) {\n            this.viewer.toolController.deregisterTool(this.pushpinBillboardTool);\n            this.pushpinBillboardTool = null;\n        }\n    }\n\n    activate() {\n        if (!this.pushpinBillboardTool.isActive()) {\n            this.viewer.toolController.activateTool('pushpinBillboard3D');\n        }\n\n        this.inputHandler = new PushPinInputHandler(this);\n\n        this.viewer.addEventListener(Autodesk.Viewing.CUTPLANES_CHANGE_EVENT, this.onSectionBind);\n\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, this.onSelectedChangedBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onRemoveBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.onRemoveAllBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, this.onModifyBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, this.onUpdateBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, this.onVisibilityChangedBind);\n        this.pushPinManager.setCreateFunction(this.createBind);\n\n        return true;\n    }\n\n    deactivate() {\n        if (this.pushpinBillboardTool.isActive()) {\n            this.viewer.toolController.deactivateTool('pushpinBillboard3D');\n        }\n\n        this.inputHandler.detach();\n\n        this.viewer.removeEventListener(Autodesk.Viewing.CUTPLANES_CHANGE_EVENT, this.onSectionBind);\n\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, this.onSelectedChangedBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onRemoveBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.onRemoveAllBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, this.onModifyBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, this.onUpdateBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, this.onVisibilityChangedBind);\n        this.pushPinManager.removeCreateFunction(this.createBind);\n    }\n\n    setPushpinDirty() {\n        this.pushpinDirty = true;\n    }\n\n    onSelectedChanged(event) {\n        if (event.value) {\n            this.selectedItem = event.value;\n\n            if (!this.selectedItem.marker) {\n                this.create(this.selectedItem);\n            }\n\n            this.pushpinBillboardTool.selectPushpin(this.selectedItem);\n            restoreViewState(this.viewer, this.selectedItem, this.pushPinManager.restoreViewerStateImmediate);\n\n            if (this.selectedItem.draggable) {\n                this.enableItemDragging(this.selectedItem);\n            }\n\n            this.viewer.dispatchEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT });\n        } else {\n            this.deselectItem();\n            this.pushpinBillboardTool.deselect();\n\n            const sectionExt = this.viewer.getExtension('Autodesk.Section');\n           \n            if (sectionExt && sectionExt.getSectionPlanes().length === 1) {\n                sectionExt.setSectionFromPlane(null);\n            } else {\n                this.viewer.impl.setCutPlaneSet('__set_view', undefined);\n            }\n        }\n\n        this.setPushpinDirty();\n    }\n\n    deselectItem() {\n        this.selectedItem = null;\n        this.inputHandler.detach();\n    }\n\n    onRemove(event) {\n        if (this.selectedItem && event.value.data.id === this.selectedItem.data.id) {\n            this.deselectItem();\n        }\n\n        if (event.value && event.value.marker) {\n            this.pushpinBillboardTool.removePushpin(event.value);\n        }\n    }\n\n    onRemoveAll() {\n        this.deselectItem();\n        this.pushpinBillboardTool.removeAll();\n    }\n\n    onModify() {\n        this.pushpinDirty = true;\n    }\n\n    onVisibilityChanged() {\n        this.pushpinBillboardTool.showMarkers();\n    }\n\n    onUpdate() {\n        setTimeout(() => {\n            this.setPushpinDirty();\n\n            // it could happen that the extension was removed in the meantime\n            this.pushpinBillboardTool && this.pushpinBillboardTool.setDirty();\n            const selectedItem = this.pushPinManager ? this.pushPinManager.getSelectedItem() : null;\n\n            if (!selectedItem) {\n                return;\n            }\n\n            (selectedItem.draggable && selectedItem.marker) ?\n                this.enableItemDragging(selectedItem) :\n                this.disableItemDragging(selectedItem);\n        }, 1);\n    }\n\n    enableItemDragging(item) {\n        this.pushpinBillboardTool.enableDragging(item);\n        this.inputHandler.attachTo(item.marker);\n    }\n\n    disableItemDragging(item) {\n        this.pushpinBillboardTool.disableDragging(item);\n        this.inputHandler.detach();\n    }\n\n    onSection() {\n    }\n\n    create(item) {\n        // iOS have a special case where they already have the UUID, so we act like we are re-selecting an existing item\n        return this.createRenderItem(item, Autodesk.Viewing.isIOSDevice());\n    }\n\n    createRenderItem(item, reselect) {\n        // Make sure it's a uuid and not a growing counter\n        const isLoaded = (item.data.id.length > 20);\n\n        // If we are actually creating a new pushpin (and not just loading one), make sure to deselect the previous selected one.\n        if (!isLoaded) {\n            this.pushpinBillboardTool.deselect();\n        }\n\n        let promise;\n        if (isLoaded && !reselect) {\n            promise = this.pushpinBillboardTool.loadPushpin(item);\n        } else {\n            promise = this.pushpinBillboardTool.createPushpin(item);\n            this.pushPinManager.selectOne(item.data.id);\n        }\n\n        return promise;\n    }\n\n    updatePattern(status, size, hex) {\n        this.pushpinBillboardTool.updateStyle(status, size, hex);\n\n        this.setPushpinDirty();\n    }\n\n    render() {\n        if (!this.pushPinManager || !this.viewer.model) {\n            return;\n        }\n\n        this.pushPinManager.items().reverse().forEach((item) => {\n            if (!item.marker) {\n                this.createRenderItem(item, false);\n            }\n        });\n\n        if (this.pushpinDirty) {\n            this.pushpinBillboardTool.updatePushpins();\n            this.pushpinDirty = false;\n        }\n    }\n\n    findIntersections(event) {\n        const mouseX = event.clientX;\n        const mouseY = event.clientY;\n\n        let hitItem = null;\n\n        this.pushPinManager.items().some((item) => {\n            if (item.selectable && item.marker) {\n                const bb = item.marker.getBoundingClientRect();\n                if (mouseX > bb.left && mouseX < bb.left + bb.width && mouseY > bb.top && mouseY < bb.top + bb.height) {\n                    hitItem = item;\n                    return true;\n                }\n            }\n            return false;\n        });\n\n        return hitItem;\n    }\n\n    handleMouseMove(e) {\n        const self = this;\n        function mouseCoords(ev) {\n            if (ev.pageX || ev.pageY) {\n                return { x: ev.pageX, y: ev.pageY };\n            }\n\n            const _document = self.getDocument();\n            return {\n                x: (ev.clientX + _document.body.scrollLeft) - _document.body.clientLeft,\n                y: (ev.clientY + _document.body.scrollTop) - _document.body.clientTop\n            };\n        }\n\n        if (this.selectedItem.marker.startDragging) {\n            // only on first mouse movement\n            if (!this.newX) {\n                this.selectedItem.marker.style.transform = 'translate(0px, 0px)';\n            }\n\n            const mousePos = mouseCoords(e);\n\n            this.newX = mousePos.x - this.mouseOffset.x;\n            this.newY = mousePos.y - this.mouseOffset.y;\n\n            // Check left, top, right, bottom\n            const containerBounds = this.viewer.navigation.getScreenViewport();\n            const wi = this.selectedItem.marker.clientWidth;\n            const hi = this.selectedItem.marker.clientHeight;\n\n            if (this.newX < 5) {\n                this.newX = 0;\n            }\n            if (this.newY < 5) {\n                this.newY = 0;\n            }\n            if (containerBounds.width - 5 < this.newX + wi) {\n                this.newX = containerBounds.width - wi;\n            }\n            if (containerBounds.height - 5 < this.newY + hi) {\n                this.newY = containerBounds.height - hi;\n            }\n\n            this.selectedItem.marker.style.left = `${this.newX}px`;\n            this.selectedItem.marker.style.top = `${this.newY}px`;\n\n            const vpVec = this.viewer.impl.clientToViewport(this.newX + (this.offsetWidth / 2), this.newY + (this.offsetWidth / 2));\n            const res = this.viewer.impl.castRayViewport(vpVec, false);\n\n            !res && !this.pushPinManager.isPseudo2D ? this.selectedItem.marker.classList.add('grey-out') : this.selectedItem.marker.classList.remove('grey-out');\n\n            this.selectedItem.marker.dragging = true;\n        }\n    }\n\n    handleMouseUp(e) {\n        if (this.selectedItem.marker.dragging) {\n            this.selectedItem.marker.style.left = '0px';\n            this.selectedItem.marker.style.top = '0px';\n            this.selectedItem.marker.style.transform = `translate(${this.newX}px, ${this.newY}px)`;\n\n            this.newX += this.offsetWidth / 2;\n            this.newY += this.offsetWidth / 2;\n\n            let result;\n            if (!this.pushPinManager.isPseudo2D) {\n                result = this.viewer.impl.clientToWorld(this.newX, this.newY);\n            } else {\n                result = {\n                    point: this.viewer.impl.intersectGround(this.newX, this.newY)\n                };\n            }\n\n            if (result) {\n                this.selectedItem.data.position = new THREE.Vector3(result.point.x, result.point.y, result.point.z);\n                invertModelTransform(this.selectedItem.data.position, result.model);\n                this.selectedItem.setSeedUrn(result.model.getSeedUrn());\n            }\n\n            this.pushpinBillboardTool.removePushpin(this.selectedItem);\n            const promise = this.createRenderItem(this.selectedItem, true);\n\n            if (result) {\n                promise.then(() => this.pushPinManager.generateThumbnail(this.selectedItem))\n                .then((thumbnail) => {\n                    this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, value: this.selectedItem, thumbnail });\n                });\n            }\n\n            this.selectedItem.marker.startDragging = false;\n            this.selectedItem.marker.dragging = false;\n\n            this.onUpdate();\n        } else {\n            this.selectedItem.marker.startDragging = false;\n        }\n    }\n\n    handleMouseDown(event) {\n        function getPosition(e) {\n            let left = 0;\n            let top = 0;\n\n            while (e.offsetParent) {\n                left += e.offsetLeft;\n                top += e.offsetTop;\n                e = e.offsetParent;\n            }\n\n            left += e.offsetLeft;\n            top += e.offsetTop;\n            return { x: left, y: top };\n        }\n\n        function getMouseOffset(target, offsetWidth) {\n            const docPos = getPosition(target);\n\n            docPos.x += offsetWidth / 2;\n            docPos.y += offsetWidth / 2;\n            return { x: docPos.x, y: docPos.y };\n        }\n\n        if (event.target.tagName.toLowerCase() === 'textarea') {\n            return;\n        }\n\n        this.offsetWidth = this.selectedItem.selected ? markerOffsets.selectedMarkerOffsetWidth : markerOffsets.markerOffsetWidth;\n\n        this.mouseOffset = getMouseOffset(this.viewer.container, this.offsetWidth);\n\n        this.selectedItem.marker.style.opacity = '1.0';\n\n        this.newX = null;\n        this.newY = null;\n\n        this.selectedItem.marker.startDragging = true;\n    }\n}\n\nav.GlobalManagerMixin.call(RenderHandler3D.prototype);","import { PUSHPIN_EVENTS } from './PushPinEvents';\nimport { clientToWorld, invertModelTransform } from \"./PushPinUtils\";\nimport { cursorIcon } from './PushPinConstants';\nimport RenderHandler2D from './PushPins2D/RenderHandler2D';\nimport RenderHandler3D from './PushPins3D/RenderHandler3D';\n\nconst av = Autodesk.Viewing;\n\nexport default class PushPinTool {\n    constructor(viewer, pushPinManager) {\n        this.setGlobalManager(viewer.globalManager);\n\n        this.names = ['pushpin'];\n        this.priority = 45;\n        this.pushpinCursor = cursorIcon;\n\n        this.isActive = false;\n        this.pushPinInitData = null;\n        this.viewer = viewer;\n        this.pushPinManager = pushPinManager;\n        this.createMode = false;\n\n        // This is for test\n        this.testId = '1111122222333334444455555';\n        this.autoCreate = false;\n        // test end\n    }\n\n    getNames() {\n        return this.names;\n    }\n\n    getName() {\n        return this.names[0];\n    }\n\n    getPriority() {\n        return this.priority;\n    }\n\n    setAutoCreate(auto) {\n        this.autoCreate = auto;\n    }\n\n    getCursor() {\n        if (this.createMode) {\n            return this.pushpinCursor;\n        }\n        return this.isHover ? 'pointer' : null;\n    }\n\n    register() {\n        // Init render tool\n        if (!this.renderTool) {\n            if (this.pushPinManager.is2D) {\n                this.renderTool = new RenderHandler2D(this.viewer, this.pushPinManager);\n            } else {\n                this.renderTool = new RenderHandler3D(this.viewer, this.pushPinManager);\n            }\n\n            this.renderTool.register();\n        }\n    }\n\n    deregister() {\n        if (this.renderTool) {\n            this.renderTool.deregister();\n            this.renderTool = null;\n        }\n    }\n\n    activate(name, viewerApi) {\n        if (name === this.getName()) {\n            this.renderTool.activate();\n            this.isActive = true;\n        }\n    }\n\n    deactivate(name) {\n        if (name === this.getName()) {\n            this.show(false);\n            this.isActive = false;\n        }\n    }\n\n    update() {\n        if (this.isActive) {\n            if (this.duringShowing && this.renderTool) {\n                this.renderTool.render();\n            }\n        }\n\n        // return false, because push pin render doesn't affect LMV model.\n        return false;\n    }\n\n    show(duringShowing) {\n        this.duringShowing = duringShowing;\n    }\n\n    enablePushPinSelect(enable) {\n        this.pushPinManager.items().forEach((item) => {\n            item.selectable = enable;\n        });\n    }\n\n    // Each time client initiate push pin create with default info and one at a time\n    startCreateItem(data) {\n        if (this.isActive) {\n            const controller = this.viewer.toolController;\n            if (controller && controller.getActiveToolName() !== this.getName()) {\n                controller.deactivateTool(this.getName());\n                controller.activateTool(this.getName());\n            }\n\n            if (!this.duringShowing) {\n                this.show(true);\n            }\n\n            this.pushPinInitData = data;\n            this.createMode = true;\n            this.enablePushPinSelect(false);\n        }\n\n        this.viewer.dispatchEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT });\n    }\n\n    endCreateItem() {\n        this.pushPinInitData = null;\n\n        if (this.createMode) {\n            this.createMode = false;\n            this.enablePushPinSelect(true);\n        }\n    }\n\n    createThreePushPin(event) {\n        let pushPin = null;\n        const clientX = event.canvasX;\n        const clientY = event.canvasY;\n        let result;\n        if (!this.pushPinManager.isPseudo2D) {\n            result = this.viewer.impl.clientToWorld(clientX, clientY);\n        } else {\n            result = {\n                point: this.viewer.impl.intersectGround(clientX, clientY)\n            }\n        }\n         \n        if (result && this.pushPinInitData) {\n            this.pushPinInitData.position = new THREE.Vector3(result.point.x, result.point.y, result.point.z);\n            invertModelTransform(this.pushPinInitData.position, result.model);\n            this.pushPinInitData.seedURN = result.model?.getSeedUrn();\n\n            pushPin = this.pushPinManager.createItem(this.pushPinInitData);\n            // Clear pin pin init data, as it is a one time data for creating only one push pin.\n            this.pushPinInitData = null;\n        }\n\n        return pushPin;\n    }\n\n    createTwoPushPin(event) {\n        let pushPin = null;\n        const clientX = event.canvasX;\n        const clientY = event.canvasY;\n        const result = clientToWorld(this.viewer, clientX, clientY);\n\n        if (result && this.pushPinInitData) {\n            this.pushPinInitData.position = { x: result.x, y: result.y, z: result.z };\n\n            pushPin = this.pushPinManager.createItem(this.pushPinInitData);\n            // Clear pin pin init data, as it is a one time data for creating only one push pin.\n            this.pushPinInitData = null;\n        }\n\n        return pushPin;\n    }\n\n    createPushPin(event) {\n        if (this.autoCreate && !this.pushPinInitData) {\n            // Fake push pin data for auto create.\n            this.pushPinInitData = { id: (this.testId + '1'), status: 'issues-open', type: 'issues' };\n        }\n\n        if (this.pushPinInitData) {\n            return this.pushPinManager.is2D ? this.createTwoPushPin(event) : this.createThreePushPin(event);\n        }\n\n        return false;\n    }\n\n    // Below is the standard input handler, so far only care about single click for creating push pins.\n    handleSingleTap(event) {\n        PushPinTool.convertEventHammerToMouse(event);\n\n        return this.handleSingleClick(event, 0);\n    }\n\n    triggerPushpinClick(item) {\n        this.pushPinManager.selectOne(item.data.id);\n        this.pushPinManager.fireEvent({\n            type: PUSHPIN_EVENTS.PUSH_PIN_CLICKED_EVENT,\n            value: this.pushPinManager.getSelectedItem()\n        });\n    }\n\n    checkPushpinClick(event) {\n        return this.renderTool.findIntersections(event);\n    }\n\n    handleSingleClick(event, button) {\n        const pressedItem = this.checkPushpinClick(event);\n        let triggered = false;\n\n        if (!this.createMode) {\n            // Trigger selection only when createMode is false\n            if (pressedItem) {\n                this.triggerPushpinClick(pressedItem);\n                triggered = true;\n            } else if (this.pushPinManager.selectedItem) {\n                this.pushPinManager.selectNone();\n                this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECT_NONE, value: null });\n            }\n        }\n\n        if (this.isActive && button === 0) {\n            if (pressedItem) {\n                if (!triggered) {\n                    this.triggerPushpinClick(pressedItem);\n                }\n            } else {\n                return this.createPushPin(event);\n            }\n        }\n\n        if (pressedItem) {\n            const self = this;\n            // Prevent from other listeners to be alerted for this current click.\n            // This is necessary for a scenario when there is a pushpin on top of a callout rectangle for example.\n            this.addDocumentEventListener('click',\n                function handler(e) {\n                    e.stopPropagation();\n                    self.removeDocumentEventListener('click', handler, true);\n                }, true);\n        }\n\n        return !!pressedItem;\n    }\n\n    handleMouseMove(event) {\n        const hoveredItem = this.checkPushpinClick(event);\n\n        this.isHover = !!hoveredItem;\n        \n        const isEditingPushpin = this.pushPinManager.selectedItem && this.pushPinManager.selectedItem.draggable;\n\n        // When we are in pushpin edit mode, we want to update the hover of the location only when we actively drag the pushpin.\n        // In case the pushpin is draggable, but not we just move the mouse without dragging - don't do anything.\n        if (!isEditingPushpin) {\n          this.pushPinManager.hoverLocations(event);\n        }\n\n        return false;\n    }\n\n    static convertEventHammerToMouse(event) {\n        // Convert Hammer touch-event X,Y into mouse-event X,Y.\n        event.shiftKey = false;\n        event.clientX = event.pointers[0].clientX;\n        event.clientY = event.pointers[0].clientY;\n    }\n\n}\n\nav.GlobalManagerMixin.call(PushPinTool.prototype);\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.PushPinTool = PushPinTool;\n","import { PUSHPIN_EVENTS } from '../PushPinEvents';\n\nconst av = Autodesk.Viewing;\n\nexport default class PushPinVisButton {\n    constructor(viewer, extension, initiallyHidePushpins) {\n        this.viewer = viewer;\n        this.setGlobalManager(viewer.globalManager);\n        this.extension = extension;\n        this.pushpinVisBtn = null;\n        this.initiallyHidePushpins = initiallyHidePushpins;\n\n        this.setButtonConstants();\n    }\n\n    setButtonConstants() {\n        this.buttonConstants = {\n            btnClass: '',\n            btnLabel: '',\n            noPushpinLabel: '',\n            hidePushpinLabel: '',\n            showPushpinLabel: '',\n            pushpinNormalIcon: '',\n            pushpinHideIcon: ''\n        };\n\n        this.type = '';\n    }\n\n    get pushPinButton() {\n        return this.pushpinVisBtn;\n    }\n\n    createButton() {\n        const btn = new Autodesk.Viewing.UI.Button(this.buttonConstants.btnClass);\n        btn.setGlobalManager(this.globalManager);\n\n        btn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.btnLabel));\n        btn.setIcon(this.buttonConstants.pushpinNormalIcon);\n\n        btn.onClick = () => {\n            const state = btn.getState();\n            if (state === Autodesk.Viewing.UI.Button.State.DISABLED) {\n                return;\n            }\n\n            btn.setState(state === Autodesk.Viewing.UI.Button.State.INACTIVE ? Autodesk.Viewing.UI.Button.State.ACTIVE : Autodesk.Viewing.UI.Button.State.INACTIVE);\n        };\n\n        return btn;\n    }\n\n    onPushpinVisBtnStateChange(e) {\n        if (e.state === Autodesk.Viewing.UI.Button.State.DISABLED) {\n            this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.noPushpinLabel));\n            return;\n        }\n\n        let showAll = e.state === Autodesk.Viewing.UI.Button.State.ACTIVE && !this.initiallyHidePushpins;\n        if (this.initiallyHidePushpins) {\n            this.pushpinVisBtn.setState(Autodesk.Viewing.UI.Button.State.INACTIVE);\n            this.initiallyHidePushpins = false;\n        }\n\n        // Toggle the vis button\n        if (showAll) {\n            this.extension.tool.show(true);\n            this.extension.showByType(this.type);\n            this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.hidePushpinLabel));\n            this.pushpinVisBtn.setIcon(this.buttonConstants.pushpinNormalIcon);\n        } else {\n            this.extension.hideByType(this.type);\n            this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.showPushpinLabel));\n            this.pushpinVisBtn.setIcon(this.buttonConstants.pushpinHideIcon);\n        }\n    }\n\n    addButton() {\n        if (this.pushpinVisBtn || !this.viewer.getToolbar) {\n            return;\n        }\n\n        const toolbar = this.viewer.getToolbar();\n\n        if (!toolbar) {\n            return;\n        }\n\n        let modelTools = toolbar.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID);\n\n        if (!modelTools) {\n            // insert model tool below navgiation tool\n            const navigationBar = toolbar.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);\n            const toolbarOptions = {};\n\n            toolbarOptions.index = (navigationBar) ? toolbar.indexOf(navigationBar) + 1 : 0;\n\n            modelTools = new Autodesk.Viewing.UI.ControlGroup(Autodesk.Viewing.TOOLBAR.MODELTOOLSID);\n            modelTools.setGlobalManager(this.globalManager);\n            toolbar.addControl(modelTools, toolbarOptions);\n        }\n\n        this.pushpinVisBtn = this.createButton();\n\n        // Add button to the toolbar\n        this.pushpinVisBtn.addEventListener(Autodesk.Viewing.UI.Button.Event.STATE_CHANGED, (e) => {\n            this.onPushpinVisBtnStateChange(e);\n        });\n        this.updateButtonStatus();\n        modelTools.addControl(this.pushpinVisBtn);\n\n        // add event listener to update visual button status\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_CREATED_EVENT, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_ITEMS_LOADED, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_PREPARING_THUMBNAIL, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_ITEMS_LOADED, () => {\n            this.updateButtonStatus();\n        });\n    }\n\n    updateButtonStatus() {\n        if (!this.pushpinVisBtn) {\n            return;\n        }\n\n        // during push pin is creating, show all push pins and disable show/hide button\n        if (this.extension.tool.createMode) {\n            if (this.pushpinVisBtn.getState() !== Autodesk.Viewing.UI.Button.State.DISABLED) {\n                this.pushpinVisBtn.setState(Autodesk.Viewing.UI.Button.State.DISABLED);\n            }\n        } else {\n            const issuePushpinCount = this.extension.pushPinManager.getItemCountByType(this.type);\n            const issueButtonDisable = this.pushpinVisBtn.getState() === Autodesk.Viewing.UI.Button.State.DISABLED;\n\n            if (issuePushpinCount > 0 && issueButtonDisable) {\n                this.pushpinVisBtn.setState(Autodesk.Viewing.UI.Button.State.ACTIVE);\n            } else if (issuePushpinCount === 0 && !issueButtonDisable) {\n                this.pushpinVisBtn.setState(Autodesk.Viewing.UI.Button.State.DISABLED);\n            }\n        }\n    }\n\n    destroyButton() {\n        if (!this.pushpinVisBtn) {\n            return;\n        }\n\n        this.extension.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.updateButtonStatus);\n        this.extension.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.updateButtonStatus);\n        this.extension.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_CREATED_EVENT, this.updateButtonStatus);\n\n        const toolbar = this.viewer.getToolbar();\n\n        if (toolbar) {\n            this.pushpinVisBtn.removeFromParent();\n        }\n\n        this.pushpinVisBtn.removeEventListener(Autodesk.Viewing.UI.Button.Event.STATE_CHANGED, this.onPushpinVisBtnStateChange);\n        this.pushpinVisBtn = null;\n    }\n}\n\nav.GlobalManagerMixin.call(PushPinVisButton.prototype);\n","import PushPinVisButton from '../PushPinUi/PushPinVisButtonBase';\n\nexport default class IssuePushPinVisButton extends PushPinVisButton {\n    constructor(viewer, extension, initiallyHidePushpins) {\n        super(viewer, extension, initiallyHidePushpins);\n        this.viewer = viewer;\n        this.extension = extension;\n        this.pushpinVisBtn = null;\n\n        this.setButtonConstants();\n    }\n\n    setButtonConstants() {\n        this.buttonConstants = {\n            btnClass: 'toolbar-pushpinVis',\n            btnLabel: 'Show all pushpins',\n            noPushpinLabel: 'No issue in current doc',\n            hidePushpinLabel: 'Hide all issues',\n            showPushpinLabel: 'Show all issues',\n            pushpinNormalIcon: 'issueicon-issue_normal',\n            pushpinHideIcon: 'issueicon-issue_hide',\n        };\n\n        this.type = this.extension.pushPinManager.PushPinTypes.ISSUES;\n    }\n}\n","import PushPinVisButton from '../PushPinUi/PushPinVisButtonBase';\n\nexport default class RfiPushPinVisButton extends PushPinVisButton {\n    constructor(viewer, extension, initiallyHidePushpins) {\n        super(viewer, extension, initiallyHidePushpins);\n        this.viewer = viewer;\n        this.extension = extension;\n        this.pushpinVisBtn = null;\n\n        this.setButtonConstants();\n    }\n\n    setButtonConstants() {\n        this.buttonConstants = {\n            btnClass: 'toolbar-pushpinRfisVis',\n            btnLabel: 'Show all rfis',\n            noPushpinLabel: 'No RFI in current doc',\n            hidePushpinLabel: 'Hide all RFIs',\n            showPushpinLabel: 'Show all RFIs',\n            pushpinNormalIcon: 'rfiicon-rfi_normal',\n            pushpinHideIcon: 'rfiicon-rfi_hide',\n        };\n\n        this.type = this.extension.pushPinManager.PushPinTypes.RFIS;\n    }\n}\n","import PushPinVisButton from '../PushPinUi/PushPinVisButtonBase';\n\nexport default class QualityIssuePushPinVisButton extends PushPinVisButton {\n    constructor(viewer, extension, initiallyHidePushpins) {\n        super(viewer, extension, initiallyHidePushpins);\n        this.viewer = viewer;\n        this.extension = extension;\n        this.pushpinVisBtn = null;\n\n        this.setButtonConstants();\n    }\n\n    setButtonConstants() {\n        this.buttonConstants = {\n            btnClass: 'toolbar-pushpinFieldIssuesVis',\n            btnLabel: 'Show all field pushpins',\n            noPushpinLabel: 'No field issue in current doc',\n            hidePushpinLabel: 'Hide all field issues',\n            showPushpinLabel: 'Show all field issues',\n            pushpinNormalIcon: 'fieldissueicon-issue_normal',\n            pushpinHideIcon: 'fieldissueicon-issue_hide'\n        };\n\n        this.type = this.extension.pushPinManager.PushPinTypes.QUALITY_ISSUES;\n    }\n}\n","const av = Autodesk.Viewing;\nconst _window = av.getGlobal();\nexport default class PushPinMobileObserver {\n    constructor(pushpinManager) {\n        this.pushpinManager = pushpinManager;\n\n        this.addListeners();\n    }\n\n    addListeners() {\n        this.pushpinManager.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_CREATED_EVENT, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinCreated', event);\n        });\n\n        this.pushpinManager.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_PREPARING_THUMBNAIL , function (event) {\n            PushPinMobileObserver.postMessage('onPushPinPreparingThumbnail', event);\n        });\n\n        this.pushpinManager.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_CLICKED_EVENT, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinActived', event);\n        });\n\n        this.pushpinManager.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_MODIFY_EVENT, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinMoved', event);\n        });\n\n        this.pushpinManager.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_SELECT_NONE, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinSelectNone', event);\n        });\n\n        this.pushpinManager.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_UPDATE_EVENT, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinUpdated', event);\n        });\n\n        this.pushpinManager.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_ITEMS_LOADED, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinItemsLoaded', event);\n        });\n\n        PushPinMobileObserver.postMessage('onPushPinToolLoaded', {});\n    }\n\n    static postMessage(messageName, event) {\n        const pushPinItem = event.value;\n        const thumbnail = event.thumbnail || '';\n\n        let metadata = {};\n\n        if (pushPinItem) {\n            metadata = {\n                id: pushPinItem.data.id,\n                label: pushPinItem.data.label,\n                status: pushPinItem.data.status,\n                position: {\n                    x: pushPinItem.data.position.x,\n                    y: pushPinItem.data.position.y,\n                    z: pushPinItem.data.position.z\n                },\n                type: pushPinItem.data.type,\n                objectId: pushPinItem.data.objectId,\n                externalId: pushPinItem.data.externalId,\n                viewerState: pushPinItem.data.viewerState,\n                attributesVersion: pushPinItem.getAttributesVersion(),\n                locationIds: pushPinItem.data.locationIds || [],\n            };\n        }\n\n        if (_window.webkit !== undefined) {\n            // New iOS SDK uses a standard callback method with the pattern of \"command\" and \"data\", just like MobileCallbacks.js\n            _window.webkit.messageHandlers.callbackHandler.postMessage({ command: messageName, data: { metadata, thumbnail } });\n        } else if (_window.JSINTERFACE) {\n            // Android\n            if (!pushPinItem) {\n                _window.JSINTERFACE[messageName]();\n            } else {\n                _window.JSINTERFACE[messageName](metadata.id, metadata.type, metadata.label, metadata.status,\n                    metadata.position.x, metadata.position.y, metadata.position.z, metadata.objectId,\n                    JSON.stringify(metadata.viewerState), metadata.externalId, metadata.attributesVersion, JSON.stringify(metadata.locationIds), thumbnail);\n            }\n        }\n    }\n}\n","import { transformViewerState } from './PushPins3D/PushPinViewerState';\nimport { findMatchingModel } from './PushPinItem';\n\n// Helper function used for saving viewerStates in PushPin attributes:\n// For backward compatibility, the globalOffset of the viewerState is always equal to the center of the model bbox. Here 'model'\n// is the model that the issue has been created for.\n// This corresponds to the default globalOffset when using globalOffset=undefined and applyRefPoint=false in the model options.\n//  @param {av.Model} model for which the PushPin was created\nconst getLegacyGlobalOffset = model => {\n    // The goal here is to reproduce the default globalOffset that LMV would choose for the case\n    // globalOffset=undefined and applyRefPoint=false.\n    //\n    // It is essential NOT to use model.getBoundingBox(): Only the box in the metadata is unaffected by\n    // any lmv load-time transforms.\n    const boxData = model && model.myData.metadata['world bounding box'];\n    const pMin = boxData.minXYZ;\n    const pMax = boxData.maxXYZ;\n    return {\n        x: 0.5 * (pMin[0] + pMax[0]),\n        y: 0.5 * (pMin[1] + pMax[1]),\n        z: 0.5 * (pMin[2] + pMax[2])\n    };\n};\n\n// For legacy reasons, location and viewerState from issue-backend are stored in viewer-coordinates assuming that a single\n// model has been loaded with default load-options in LMV, i.e.,\n//  - Global offset is at the center of the model for which the issue was created.\n//  - No refPointTransform or custom transform/scaling was applied in loadOptions\n//\n// These conditions are true in single-model viewers like BIM360Docs Viewer,\n// but not in aggregated viewers like ModelCoordination and DesignCollaboration.\n// To make it for all viewers in the same way, we convert position and viewerState\n// in model-local coords - which are independent of load-time transforms.\n// \n// @param {Object} pushPinData - pushPin data with position and viewerState. Conversion works in-place.\nexport const legacyToLocalPushPinData = (pushPinData, viewer) => {\n\n    // Get globalOffset. Note that not all pushpins contain viewerState.\n    let offset = pushPinData.viewerState && pushPinData.viewerState.globalOffset;\n\n    // Legacy-fallback: (consider removal of this section in April 2020)\n    //   Older Issues may not have stored the globalOffset attribute, so some information is lost.\n    //   For these, we have to 'recover' it using some guesswork. To avoid regression, we assume here\n    //   that the issue has been created with the same globalOffset as it is viewed. The old code had\n    //   made this assumption implicitly too - so it will keep the scenarios working that had worked before.\n    if (!offset) {\n        // Note that consistent model placement requires globalOffset to be the same for all models.\n        // So, it's okay to just use viewer.model - even for aggregated views.\n        offset = viewer.model && viewer.model.myData.globalOffset;\n    }\n\n    // Convert position to model-local coords\n    if (offset) {\n        pushPinData.position.x += offset.x;\n        pushPinData.position.y += offset.y;\n        pushPinData.position.z += offset.z;\n    }\n\n    // Note: Unlike position, the viewerState (eye, target, up etc.) is already in model-local coordinates, so we don't need to add anything here.\n};\n\n// Converts PushPinData from local coordinates to legacy format - to ensure compatibility with issues that were saved before introducing model-local coordinates.\nconst localToLegacyPushPinData = (pushPinData, model) => {\n    // If there is no saved viewerState, there is nothing to convert;\n    if (!pushPinData.viewerState) {\n        return;\n    }\n\n    // For backward compatibility, the globalOffset is always at the center of the model. (see getLegacyGlobalOffset for details)\n    pushPinData.viewerState.globalOffset = getLegacyGlobalOffset(model);\n\n    // For backward compatibility, the model-local coords are not stored directly in position. Instead the convention is\n    // model-local position is obtained by 'data.position + data.viewerState.globalOffset'. Therefore, we must subtract the globalOffset\n    // before saving.\n    pushPinData.position.x -= pushPinData.viewerState.globalOffset.x;\n    pushPinData.position.y -= pushPinData.viewerState.globalOffset.y;\n    pushPinData.position.z -= pushPinData.viewerState.globalOffset.z;\n};\n\nconst getModelLocalBox = (model) => {\n    const boxData = model && model.myData.metadata['world bounding box'];\n    let box = new THREE.Box3();\n    box.min.fromArray(boxData.minXYZ);\n    box.max.fromArray(boxData.maxXYZ);\n    return box;\n};\n\n// Heuristic to detect PushPins that were written while in DesignCollaboration before the positions were fixed.\n// For these, position and camera will be far outside the actual model and need some auto-correction to keep correct.\nconst isOldDCPushPin = (model, data) => {\n\n    // For new issues or old ones from Docs viewer, the pushpin position is given in model-local\n    // coords and is usually inside the model box.\n    // For old issues from Design Collaboration, the position will be far outside of the model-local box     \n    const localBox = getModelLocalBox(model);\n    const dist = localBox.distanceToPoint(data.position) * model.getUnitScale();\n    \n    // If the point is more than 100m outside, consider it as an old design collaboration issue.\n    // A valid issue should always be within the model box. The length of 100m is just some heuristic choice\n    // to identify \"clearly far outside\".\n    if (dist < 100) {\n        return false;\n    }\n    \n    // Verify that the fallback would actually provide a valid position: If the issue was actually written\n    // by design-collaboration before we fixed the positions, the position should be valid when interpreted \n    // as world coords.\n    const viewerBox = model.getBoundingBox();\n    const pWorld = new THREE.Vector3().copy(data.position);\n\n    if (data.viewerState && data.viewerState.globalOffset) {\n        pWorld.sub(data.viewerState.globalOffset);\n    }\n\n    return viewerBox.containsPoint(pWorld);\n};\n\nconst fixOldDCPushPin = (model, data) => {\n\n    // get matrix to convert position from world coords to model-local coords\n    const modelLocalToWorld = model.myData.placementTransform;\n    const worldToModelLocal = modelLocalToWorld && new THREE.Matrix4().getInverse(modelLocalToWorld);\n\n    // If there is a placement transform & viewerState, transform pos and viewerState from world to model-local coords.\n    // If there is no placement transform or viewerState, there is nothing todo.\n    if (modelLocalToWorld && data.viewerState) {\n        // transform pos\n        data.position = new THREE.Vector3().copy(data.position).applyMatrix4(worldToModelLocal);\n\n        // transform viewer state\n        data.viewerState = JSON.parse(JSON.stringify(data.viewerState));\n        transformViewerState(data.viewerState, worldToModelLocal);\n    }\n};\n\n// Gets the in-memory reporesentation of a PushPinItem and returns the data in a way that is compatible with the \n// issues saved to issues-backend. For 2D, it is just the original PushPinData. For 3D, we have to apply some coordinate transforms.\nexport const getLegacyPushPinData = (pushPin, viewer) => {\n\n    // Check whether we are editing in 2D or 3D. Actually it would be safer to check this on the pushPin, \n    // but they don't contain any information about this.\n    const is3d = viewer.model && viewer.model.is3d();\n    if (!is3d) {\n        // For 2D, we are done here (no modifications needed).\n        return pushPin.data;\n    }\n\n    // Internally, PushPinItem stores positions in viewer-coords and viewer states in world-coords.\n    // Both depend on the model-load options used in the current viewer application, i.e., would not allow issues\n    // between different viewing applications.\n    //\n    // In the PushPinAttributes, we store everything in model-local coords. These coordinates are not affected by any load-time transform.\n    // Therefore, they are always the same for different LMV clients - no matter which loadOptions they are using. Also, it\n    // ensures that the issues automatically \"follows\" the model in case the refPointTransform changed.\n    let data = pushPin.getLocal(viewer);\n\n    // When using getLocal(), position and viewerState (eye, target, ..) are consistently given in model-local coords. In a perfect world, we were done now.\n    // But, for backwards compatibility with previously existing issues, we need some legacy conversions before storing the data.\n\n    // For backward compatibility, the globalOffset is always at the center of the model. (see getLegacyGlobalOffset for details)\n    const model = pushPin.findModel(viewer);\n    if (!model) {\n        console.error('Saving issue attributes failed: Issue must be assigned to a visible model.');\n        return pushPin.data;\n    }\n\n    // Convert from model-local coords to legacy PushPins: For backward compatility, they PushPin position must match with the viewer\n    // position when viewing a single model with default loadOptions (default globalOffset, no transforms).\n    localToLegacyPushPinData(data, model);\n\n    return data;\n};\n\n//\n// The purpose of this function is to avoid regressions for issues that have been created...\n//  - using Design Collaboration\n//  - written before we made the issue positions and viewerStates compatible with BIM360Docs viewer.\n//\n// For these issues, PushPin positions and viewerState will be world-coords. In the past, they had worked - but only under\n// the assumption that an issue is viewed under exactly the same conditions (globalOffset, model placement etc.) in which it was created.\n//\n// The heuristic in this section is making sure that this case keeps working - by converting position and viewerState to model-local coordinates.\n//\n// Note: This fallback is not needed for viewers that use LMV default loadOptions like BIM360Docs viewer.\n//\n// @param {Object} data - PushPinData. Same as in PushPinExtension.createItem(..). Will be modified in-place if needed.\n// @param {Viewer3D} viewer\nexport const applyLegacyFallback = (data, viewer) => {\n    // If there is no saved viewerState, there is nothing we can do.\n    if (!data.viewerState) {\n        return;\n    }\n\n    // find model that the pushpin belongs to\n    const model = findMatchingModel(viewer, data.viewerState.seedUrn);\n    if (!model) {\n        return;\n    }\n    \n    // Apply fallback only if we know for sure that the PushPin position would be broken otherwise.\n    if (!isOldDCPushPin(model, data)) {\n        return;\n    }\n\n    // Transform position and viewerState\n    fixOldDCPushPin(model, data);\n};\n","/**\n * Include each locale json file and return it in an object\n * that can be consumed by i18n\n */\n\nimport json_en from '../../res/locales/en/nobundle-pushpins.loc.json';\n\nimport json_en_GB from '../../res/locales/en-GB/nobundle-pushpins.loc.json';\nimport json_cs from '../../res/locales/cs/nobundle-pushpins.loc.json';\nimport json_de from '../../res/locales/de/nobundle-pushpins.loc.json';\nimport json_es from '../../res/locales/es/nobundle-pushpins.loc.json';\nimport json_fr from '../../res/locales/fr/nobundle-pushpins.loc.json';\nimport json_fr_CA from '../../res/locales/fr-CA/nobundle-pushpins.loc.json';\nimport json_it from '../../res/locales/it/nobundle-pushpins.loc.json';\nimport json_ja from '../../res/locales/ja/nobundle-pushpins.loc.json';\nimport json_ko from '../../res/locales/ko/nobundle-pushpins.loc.json';\nimport json_pl from '../../res/locales/pl/nobundle-pushpins.loc.json';\nimport json_pt_BR from '../../res/locales/pt-BR/nobundle-pushpins.loc.json';\nimport json_ru from '../../res/locales/ru/nobundle-pushpins.loc.json';\nimport json_tr from '../../res/locales/tr/nobundle-pushpins.loc.json';\nimport json_zh_HANS from '../../res/locales/zh-HANS/nobundle-pushpins.loc.json';\nimport json_zh_HANT from '../../res/locales/zh-HANT/nobundle-pushpins.loc.json';\nimport json_zh_HK from '../../res/locales/zh-HK/nobundle-pushpins.loc.json';\nimport json_nl from '../../res/locales/nl/nobundle-pushpins.loc.json';\nimport json_sv from '../../res/locales/sv/nobundle-pushpins.loc.json';\nimport json_da from '../../res/locales/da/nobundle-pushpins.loc.json';\nimport json_no from '../../res/locales/no/nobundle-pushpins.loc.json';\n\nexport const locales = {\n    en: json_en,\n    \"en-GB\": json_en_GB,\n    cs: json_cs,\n    de: json_de,\n    es: json_es,\n    fr: json_fr,\n    \"fr-CA\": json_fr_CA,\n    it: json_it,\n    ja: json_ja,\n    ko: json_ko,\n    pl: json_pl,\n    \"pt-BR\": json_pt_BR,\n    ru: json_ru,\n    tr: json_tr,\n    \"zh-HANS\": json_zh_HANS,\n    \"zh-HANT\": json_zh_HANT,\n    \"zh-HK\": json_zh_HK,\n    nl: json_nl,\n    sv: json_sv,\n    da: json_da,\n    no: json_no,\n};\n\n","import { PUSHPIN_EVENTS } from './PushPinEvents';\nimport PushPinManager from './PushPinManager';\nimport PushPinTool from './PushPinTools';\nimport IssuePushPinVisButton from './PushPinUi/IssuePushPinVisButton';\nimport RfiPushPinVisButton from './PushPinUi/RfiPushPinVisButton';\nimport QualityIssuePushPinVisButton from './PushPinUi/QualityIssuePushPinVisButton';\nimport PushPinMobileObserver from './PushPinObserver';\nimport { applyLegacyFallback, legacyToLocalPushPinData, getLegacyPushPinData } from './PushPinLegacyFallback';\nimport { locales } from './PushPinLocales';\n\nimport CSS from './PushPinExtension.css'; // REQUIRED!!\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nexport default class PushPinExtension extends Autodesk.Viewing.Extension {\n    constructor(viewer, options = {}) {\n        super(viewer, options);\n        this.viewer = viewer;\n        this.options = options;\n        Autodesk.Viewing.EventDispatcher.prototype.apply(this);\n    }\n\n    load() {\n        this.extendLocalization(locales);\n\n        this.onModelAdded = this.onModelAdded.bind(this);\n        this.onModelRemoved = this.onModelRemoved.bind(this);\n        this.viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT, this.onModelAdded);\n        this.viewer.addEventListener(Autodesk.Viewing.MODEL_REMOVED_EVENT, this.onModelRemoved);\n\n        if (this.viewer.getVisibleModels().length > 0) {\n            this.onModelAdded();\n        }\n\n        return true;\n    }\n\n    unload() {\n        this.destroyUI();\n\n        this.destroyPushpinManager();\n\n        this.destroyTool();\n\n        this.viewer.removeEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT, this.onModelAdded);\n        this.viewer.removeEventListener(Autodesk.Viewing.MODEL_REMOVED_EVENT, this.onModelRemoved);\n\n        return true;\n    }\n\n    onModelAdded() {\n        // Need to initialize pushpinManager & pushpinTool in these cases:\n        // - pushpinManager or tool weren't initialized yet\n        // - viewer switched mode from 2D to 3D (or 3D to 2D)\n        const reset = !this.pushPinManager || !this.tool ||\n            // For 3D is2d is undefined, so first convert to boolean\n            Boolean(this.viewer.impl.is2d) !== this.pushPinManager.is2D;\n\n        if (reset) {\n            this.initPushpinManager();\n            this.initTool();\n            this.createUI();\n\n            for (const value of Object.values(PUSHPIN_EVENTS)) {\n                // Forward the events to the pushpin manager\n                // Removing is not necessary as the pushpin manager gets recreated\n                this.pushPinManager.addEventListener(value, (e) => this.fireEvent(e));\n            }\n            this.fireEvent({ type: Events.PUSH_PIN_MANAGER_INITIALIZED, value: this.pushPinManager });\n        }\n    }\n\n    onModelRemoved() {\n        // In case that there is no model left on the viewer.\n        if (this.viewer.getVisibleModels().length === 0) {\n            this.destroyUI();\n            this.destroyPushpinManager();\n            this.destroyTool();\n\n            this.fireEvent({ type: Events.PUSH_PIN_MANAGER_DESTROYED });\n        }\n    }\n\n    initPushpinManager() {\n        // Clean previous instance of pushpin manager if exists.\n        this.destroyPushpinManager();\n\n        this.pushPinManager = new PushPinManager(this.viewer, this.options);\n\n        if (Autodesk.Viewing.isMobileDevice()) {\n            this.observer = new PushPinMobileObserver(this.pushPinManager);\n        }\n    }\n\n    destroyPushpinManager() {\n        if (this.pushPinManager) {\n            this.pushPinManager.selectNone();\n            this.pushPinManager.removeAllItems();\n            this.pushPinManager = null;\n        }\n\n        this.observer = null;\n    }\n\n    initTool() {\n        // Clean previous instance of pushpin tool if exists.\n        this.destroyTool();\n\n        this.tool = new PushPinTool(this.viewer, this.pushPinManager);\n\n        this.viewer.toolController.registerTool(this.tool);\n        this.viewer.toolController.activateTool(this.tool.getName());\n    }\n\n    destroyTool() {\n        if (this.tool) {\n            this.viewer.toolController.deregisterTool(this.tool);\n            this.tool = null;\n        }\n    }\n\n    /**\n     * Public interfaces routing to tool for clients to call\n     */\n    startCreateItem(data) {\n        this.tool.startCreateItem(data);\n        this.updateButtonsStatus();\n        this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_EDIT_START_EVENT });\n    }\n\n    endCreateItem() {\n        this.tool.endCreateItem();\n        this.updateButtonsStatus();\n        this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_EDIT_END_EVENT });\n    }\n\n    showAll() {\n        for (var type in this.pushPinManager.PushPinTypes) {\n            this.showByType(this.pushPinManager.PushPinTypes[type]);\n        }\n    }\n\n    hideAll() {\n        for (var type in this.pushPinManager.PushPinTypes) {\n            this.hideByType(this.pushPinManager.PushPinTypes[type]);\n        }\n    }\n\n    enableItemSelect(enable) {\n        this.tool.enablePushPinSelect(enable);\n    }\n\n    updatePattern(id, size, res) {\n        this.tool.renderTool.updatePattern(id, size, res);\n    }\n\n    // public interfaces routing to push pin manager for clients to call\n    loadItems(pushPinDatas) {\n        if (this.viewer.getVisibleModels().length === 0) {\n            console.warn('model need to be loaded before using loadItems API');\n            return;\n        }\n\n        if (this.viewer.model.is3d()) {\n            console.warn('loadItems is deprecated for 3D models. Use loadItemsV2 instead.');\n        }\n\n        this.tool.show(true);\n        this.pushPinManager.addItems(pushPinDatas);\n        this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_ITEMS_LOADED, value: null });\n    }\n\n    // @param {bool} [blockEvent=false] - By default, we fire a PUSH_PIN_ITEMS_LOADED event each time to make sure that \n    //                                    it's never missed. If you call this function several times in a loop, you can block\n    //                                    the event as long as you ensure to fire it once at the end of the loop.\n    loadItemFromLocal(pushPinData, blockEvent) {\n        if (this.viewer.getVisibleModels().length === 0) {\n            console.warn('model need to be loaded before using loadItemFromLocal API');\n            return;\n        }\n\n        this.pushPinManager.addItems([pushPinData], true, this.viewer);\n\n        if (!blockEvent) {\n            this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_ITEMS_LOADED, value: null });\n        }\n    }\n\n    // New load API that encapsulates the 2D/3D loading APIs.\n    loadItemsV2(pushpinsData) {\n        if (this.viewer.getVisibleModels().length === 0) {\n            console.warn('model need to be loaded before using loadItemsV2 API');\n            return;\n        }\n\n        if (!Array.isArray(pushpinsData)) {\n            pushpinsData = [pushpinsData];\n        }\n\n        // Activate tool so pushpins will be visible.\n        this.tool.show(true);\n\n        pushpinsData.forEach(pushpinData => {\n            if (this.viewer.model.is3d()) {\n                // For legacy reasons, issue positions are not directly stored in model-local coordinates. So we need some legacy conversion.\n                this.legacyToLocalPushPinData(pushpinData);\n\n                // Now, position and viewerState are in model-local coordinates.\n                this.loadItemFromLocal(pushpinData, true);\n            } else {\n                // Old code path for 2D issues.\n                this.pushPinManager.addItems([pushpinData]);\n            }\n        });\n\n        this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_ITEMS_LOADED, value: null });\n    }\n\n    updateItemById(id, data) {\n        return this.pushPinManager.updateItemById(id, data);\n    }\n\n    getItemById(id) {\n        const item = this.pushPinManager.getItemById(id);\n\n        if (item) {\n            return item.data;\n        }\n\n        return null;\n    }\n\n    setDraggableById(id, isDraggable, cancelPositionChange) {\n\n        // Note that this.pushPinManager may temporarily destroyed when removing the last model\n        // during a view switch. We tolerate that case in the same way as we handle a call for a non-existing issue.\n        const item = this.pushPinManager?.getItemById(id);\n\n        if (item) {\n            if (cancelPositionChange) {\n                item.setPosition(this.origItemPosition);\n            }\n\n            item.draggable = isDraggable;\n            this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, value: item });\n            this.origItemPosition = Object.assign({}, item.data.position);\n\n            if (isDraggable) {\n                this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_EDIT_START_EVENT });\n            } else {\n                this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_EDIT_END_EVENT });\n            }\n        }\n    }\n\n    setVisibleById(id, isVisible) {\n        const item = this.pushPinManager.getItemById(id);\n        if (item) {\n            item.visible = isVisible;\n            this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, value: item });\n        }\n    }\n\n    /**\n     * Select one pushpin\n     * @param id Issue id\n     * @param reTriggerEvent Allows to force a re-triggering of the selection event, even if pushpin was selected before.\n     * This makes sense if you want to make sure that the pushpin viewer state is applied anyway (zoom to pushpin).\n     */\n    selectOne(id, reTriggerEvent) {\n        this.pushPinManager && this.pushPinManager.selectOne(id, reTriggerEvent);\n    }\n\n    selectNone() {\n        this.pushPinManager && this.pushPinManager.selectNone();\n    }\n\n    removeItemById(id) {\n        const item = this.pushPinManager.getItemById(id);\n\n        if (!item) {\n            return;\n        }\n\n        this.pushPinManager.removeItemById(id);\n    }\n\n    removeItemsByType(type) {\n        this.pushPinManager.removeItemsByType(type);\n    }\n\n    removeAllItems() {\n        this.pushPinManager && this.pushPinManager.removeAllItems();\n    }\n\n    createUI() {\n        // UI depends on pushpinManager.\n        this.destroyUI();\n\n        this.uiButtons = [];\n\n        if (!this.options.hideIssuesButton) {\n            this.uiButtons.push(new IssuePushPinVisButton(this.viewer, this, this.options.initiallyHideIssuesPushpins));\n        }\n\n        if (!this.options.hideFieldIssuesButton) {\n            this.uiButtons.push(new QualityIssuePushPinVisButton(this.viewer, this, this.options.initiallyHideFieldIssuesPushpins));\n        }\n\n        if (!this.options.hideRfisButton) {\n            this.uiButtons.push(new RfiPushPinVisButton(this.viewer, this, this.options.initiallyHideRfisPushpins));\n        }\n\n        if (this.viewer.model) {\n            // If model is already loaded, then check.\n            this.uiButtons.forEach((uiButton) => {\n                uiButton.addButton();\n            });\n            return;\n        }\n\n        const self = this;\n\n        function enableVisButton() {\n            if (self.viewer.model) {\n                self.uiButtons.forEach((uiButton) => {\n                    uiButton.addButton();\n                });\n            }\n            self.viewer.removeEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT, enableVisButton);\n        }\n\n        // Otherwise, watch model loaded event.\n        this.viewer.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT, enableVisButton);\n    }\n\n    destroyUI() {\n        if (!this.uiButtons) {\n            return;\n        }\n\n        this.uiButtons.forEach((uiButton) => {\n            uiButton.destroyButton();\n        });\n\n        this.uiButtons = null;\n    }\n\n    updateButtonsStatus() {\n        this.uiButtons.forEach((uiButton) => {\n            uiButton.updateButtonStatus();\n        });\n    }\n\n    hideByType(type) {\n        this.pushPinManager && this.pushPinManager.setVisibleByType(type, false);\n    }\n\n    showByType(type) {\n        this.pushPinManager && this.pushPinManager.setVisibleByType(type, true);\n    }\n\n    // Convert legacy 3D pushPinData in-place to make sure that positions and viewerState are consistently in model-local coords.\n    legacyToLocalPushPinData(pushPinData) {\n\n        legacyToLocalPushPinData(pushPinData, this.viewer);\n\n        // Usually, this will be a no-op. It will just detect and auto-repair some previously saved\n        // PushPins that would be broken otherwise.\n        if (this.options.useLegacyFallback) {\n            applyLegacyFallback(pushPinData, this.viewer);\n        }\n    }\n\n    // Takes a PushPinItem and returns its PushPinData - transformed in a way that it is compatible with the PushPins as stored in issues-backend. For this, pushPin position\n    // must match with viewer coordinates when using a single model with default loadOptions (default globalOffset and no transforms).\n    getLegacyPushPinData(pushPin) {\n        return getLegacyPushPinData(pushPin, this.viewer);\n    }\n\n    // Makes restore viewer state immediate (without animation)\n    setRestoreViewerStateImmediate(restoreViewerStateImmediate) {\n        if (this.pushPinManager) {\n            this.pushPinManager.restoreViewerStateImmediate = restoreViewerStateImmediate;\n        }\n    }\n}\n\nconst Events = {\n    PUSH_PIN_MANAGER_INITIALIZED: 'pushpin.manager.initialized',\n    PUSH_PIN_MANAGER_DESTROYED: 'pushpin.manager.destroyed',\n};\n\nPushPinExtension.Events = Events;\n\nnamespace.PUSH_PIN_EXT_NAME = 'Autodesk.BIM360.Extension.PushPin';\nObject.assign(namespace, PUSHPIN_EVENTS);\nAutodesk.Viewing.theExtensionManager.registerExtension(namespace.PUSH_PIN_EXT_NAME, PushPinExtension);\n"],"sourceRoot":""}