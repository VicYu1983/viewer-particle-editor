{"version":3,"file":"NPR/NPR.js","sources":["webpack://Autodesk.Extensions.[name]/webpack/bootstrap","webpack://Autodesk.Extensions.[name]/./extensions/NPR/NPRLocales.js","webpack://Autodesk.Extensions.[name]/./extensions/NPR/NPRRenderContextExtension.js","webpack://Autodesk.Extensions.[name]/./extensions/NPR/NPRRenderOptionsPanel.js","webpack://Autodesk.Extensions.[name]/./extensions/NPR/index.js"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./extensions/NPR/index.js\");\n","/**\n * Include each locale json file and return it in an object\n * that can be consumed by i18n\n */\n\nimport json_en from '../../res/locales/en/nobundle-npr.loc.json';\n\nimport json_en_GB from '../../res/locales/en-GB/nobundle-npr.loc.json';\nimport json_cs from '../../res/locales/cs/nobundle-npr.loc.json';\nimport json_de from '../../res/locales/de/nobundle-npr.loc.json';\nimport json_es from '../../res/locales/es/nobundle-npr.loc.json';\nimport json_fr from '../../res/locales/fr/nobundle-npr.loc.json';\nimport json_fr_CA from '../../res/locales/fr-CA/nobundle-npr.loc.json';\nimport json_it from '../../res/locales/it/nobundle-npr.loc.json';\nimport json_ja from '../../res/locales/ja/nobundle-npr.loc.json';\nimport json_ko from '../../res/locales/ko/nobundle-npr.loc.json';\nimport json_pl from '../../res/locales/pl/nobundle-npr.loc.json';\nimport json_pt_BR from '../../res/locales/pt-BR/nobundle-npr.loc.json';\nimport json_ru from '../../res/locales/ru/nobundle-npr.loc.json';\nimport json_tr from '../../res/locales/tr/nobundle-npr.loc.json';\nimport json_zh_HANS from '../../res/locales/zh-HANS/nobundle-npr.loc.json';\nimport json_zh_HANT from '../../res/locales/zh-HANT/nobundle-npr.loc.json';\nimport json_zh_HK from '../../res/locales/zh-HK/nobundle-npr.loc.json';\nimport json_nl from '../../res/locales/nl/nobundle-npr.loc.json';\nimport json_sv from '../../res/locales/sv/nobundle-npr.loc.json';\nimport json_da from '../../res/locales/da/nobundle-npr.loc.json';\nimport json_no from '../../res/locales/no/nobundle-npr.loc.json';\n\nexport var locales = {\n  en: json_en,\n\n  \"en-GB\": json_en_GB,\n  cs: json_cs,\n  de: json_de,\n  es: json_es,\n  fr: json_fr,\n  \"fr-CA\": json_fr_CA,\n  it: json_it,\n  ja: json_ja,\n  ko: json_ko,\n  pl: json_pl,\n  \"pt-BR\": json_pt_BR,\n  ru: json_ru,\n  tr: json_tr,\n  \"zh-HANS\": json_zh_HANS,\n  \"zh-HANT\": json_zh_HANT,\n  \"zh-HK\": json_zh_HK,\n  nl: json_nl,\n  sv: json_sv,\n  da: json_da,\n  no: json_no };","function _createForOfIteratorHelper(o, allowArrayLike) {var it;if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {if (it) o = it;var i = 0;var F = function F() {};return { s: F, n: function n() {if (i >= o.length) return { done: true };return { done: false, value: o[i++] };}, e: function e(_e) {throw _e;}, f: F };}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");}var normalCompletion = true,didErr = false,err;return { s: function s() {it = o[Symbol.iterator]();}, n: function n() {var step = it.next();normalCompletion = step.done;return step;}, e: function e(_e2) {didErr = true;err = _e2;}, f: function f() {try {if (!normalCompletion && it.return != null) it.return();} finally {if (didErr) throw err;}} };}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === \"Object\" && o.constructor) n = o.constructor.name;if (n === \"Map\" || n === \"Set\") return Array.from(o);if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) {arr2[i] = arr[i];}return arr2;} /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * NPR related functions are moved to an extension\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * to keep default LMV render context unadulterated, and\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * to help customers to implement their own postprocess extensions.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        * This is achieved by extending RenderContextPostProcessExtension.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */\n\nvar POSTPROC_STYLE_OFF = 0;\nvar POSTPROC_STYLE_EDGING = 1;\nvar POSTPROC_STYLE_CEL = 2;\nvar POSTPROC_STYLE_GRAPHITE = 3;\nvar POSTPROC_STYLE_PENCIL = 4;\n\nvar getResourceUrl = Autodesk.Viewing.Private.getResourceUrl;\nvar ShaderPass = Autodesk.Viewing.Private.ShaderPass;\nvar CelShader = Autodesk.Viewing.Private.CelShader;\nvar RenderContextPostProcessExtension = Autodesk.Viewing.Private.RenderContextPostProcessExtension;\n\nvar av = Autodesk.Viewing;\n\nvar NPRRenderContextExtension = function NPRRenderContextExtension(renderContext, viewer) {\n  RenderContextPostProcessExtension.call(this, renderContext, viewer);\n\n  // Initialize private variables\n  var _pencilMap = null;\n  var _graphiteMaps = [];\n  var _pencilBackgroundMap = null;\n\n  this.preloadPostProcessStyle = function (style) {\n    if (style == undefined) {\n      // if no argument given, load them all\n      this.preloadPostProcessStyle(\"graphite\");\n      this.preloadPostProcessStyle(\"pencil\");\n      return;\n    }\n    switch (style) {\n      case \"graphite\":\n        if (_graphiteMaps[0] === undefined) {// TODO better way to test? Note it differs from the one below\n          // LMV-2820 fix - we are in control of the URL, so to have Ninja function, we allow load from \"another\" site.\n          THREE.ImageUtils.crossOrigin = '';\n          for (var i = 0; i < 8; i++) {\n            var file = getResourceUrl(\"extensions/NPR/res/postprocess/Graphite\" + (i + 1) + \".png\");\n            _graphiteMaps[i] = THREE.ImageUtils.loadTexture(file);\n            //_graphiteMaps[i] = THREE.ImageUtils.loadTexture(\"http://localhost:8000/build/res/postprocess/Graphite\" + (i+1) + \".png\"); \n            _graphiteMaps[i].wrapS = _graphiteMaps[i].wrapT = THREE.RepeatWrapping;\n          }\n          this.postProcPass.uniforms['tGraphite1'].value = _graphiteMaps[0];\n          this.postProcPass.uniforms['tGraphite2'].value = _graphiteMaps[1];\n          this.postProcPass.uniforms['tGraphite3'].value = _graphiteMaps[2];\n          this.postProcPass.uniforms['tGraphite4'].value = _graphiteMaps[3];\n          this.postProcPass.uniforms['tGraphite5'].value = _graphiteMaps[4];\n          this.postProcPass.uniforms['tGraphite6'].value = _graphiteMaps[5];\n          this.postProcPass.uniforms['tGraphite7'].value = _graphiteMaps[6];\n          this.postProcPass.uniforms['tGraphite8'].value = _graphiteMaps[7];\n        }\n        break;\n      case \"pencil\":\n        if (_pencilMap === null) {// TODO better way to test?\n          // LMV-2820 fix - we are in control of the URL, so to have Ninja function, we allow load from \"another\" site.\n          THREE.ImageUtils.crossOrigin = '';\n          _pencilMap = THREE.ImageUtils.loadTexture(getResourceUrl(\"extensions/NPR/res/postprocess/ColorPencil_02.png\"));\n          _pencilMap.wrapS = _pencilMap.wrapT = THREE.RepeatWrapping;\n          _pencilBackgroundMap = THREE.ImageUtils.loadTexture(getResourceUrl(\"extensions/NPR/res/postprocess/paper2.jpg\"));\n          _pencilBackgroundMap.wrapS = _pencilBackgroundMap.wrapT = THREE.RepeatWrapping;\n\n          this.postProcPass.uniforms['tFill'].value = _pencilMap;\n          this.postProcPass.uniforms['tPaper'].value = _pencilBackgroundMap;\n        }\n        break;}\n\n  };\n\n  // returns 1 (or some other error code) on failure, 0 on success\n  this.setPostProcessParameter = function (token, value) {\n    this.changePostProcessParameter(token, value);\n\n    this.viewer.impl.fireRenderOptionChanged();\n    this.viewer.impl.invalidate(true);\n  };\n\n\n  this.changePostProcessParameter = function (token, value) {\n    var _settings = this.renderContext.settings;\n\n    switch (token) {\n      case \"style\":\n        this.setPostProcShaded(false);\n        this.postProcPass.uniforms['style'].value = POSTPROC_STYLE_OFF;\n        if (this.renderContext.depthTargetSupported()) {\n          // put this code back in if we can't run with mobile\n          // if _isWeakDevice, I guess we can't use? Needs ID buffer and normals/depths.\n          // if ( _isWeakDevice ) {\n          //     // sorry, not available on mobile - needs ID buffer and normal/depth buffer\n          //     return 1;\n          // } else {\n          // load any textures that haven't been loaded.\n          this.preloadPostProcessStyle(value);\n          switch (value) {\n            case \"edging\":\n              this.setPostProcShaded(true);\n              this.postProcPass.uniforms['style'].value = POSTPROC_STYLE_EDGING;\n              break;\n            case \"cel\":\n              this.setPostProcShaded(true);\n              this.postProcPass.uniforms['style'].value = POSTPROC_STYLE_CEL;\n              break;\n            case \"graphite\":\n              this.setPostProcShaded(true);\n              this.postProcPass.uniforms['style'].value = POSTPROC_STYLE_GRAPHITE;\n              break;\n            case \"pencil\":\n              this.setPostProcShaded(true);\n              this.postProcPass.uniforms['style'].value = POSTPROC_STYLE_PENCIL;\n              break;}\n\n          if (this.isPostProcShaded()) {\n            _settings.idbuffer = true;\n          } else {\n            _settings.idbuffer = !this.renderContext.isWeakDevice(); // TODO are these good conditions?\n          }\n\n          this.renderContext.initPostPipeline(_settings.sao, _settings.antialias);\n        }\n        break;\n\n      case \"edges\":\n        this.postProcPass.uniforms['idEdges'].value = value ? 1 : 0;\n        this.postProcPass.uniforms['normalEdges'].value = value ? 1 : 0;\n        this.postProcPass.uniforms['depthEdges'].value = value ? 1 : 0;\n        // turning off edges means we can use considerably less memory and fragment shading evaluations,\n        // i.e., we can use normal-resolution off-screen targets, not 2x2 larger\n        this.renderContext.initPostPipeline(_settings.sao, _settings.antialias);\n        break;\n      case \"idEdges\":\n        this.postProcPass.uniforms['idEdges'].value = value ? 1 : 0;\n        this.renderContext.initPostPipeline(_settings.sao, _settings.antialias);\n        break;\n      case \"normalEdges\":\n        this.postProcPass.uniforms['normalEdges'].value = value ? 1 : 0;\n        this.renderContext.initPostPipeline(_settings.sao, _settings.antialias);\n        break;\n      case \"depthEdges\":\n        this.postProcPass.uniforms['depthEdges'].value = value ? 1 : 0;\n        this.renderContext.initPostPipeline(_settings.sao, _settings.antialias);\n        break;\n      case \"brightness\":\n        this.postProcPass.uniforms['brightness'].value = value;\n        break;\n      case \"contrast\":\n        this.postProcPass.uniforms['contrast'].value = value;\n        break;\n      case \"grayscale\":\n        this.postProcPass.uniforms['grayscale'].value = value ? 1 : 0;\n        break;\n      case \"preserveColor\":\n        this.postProcPass.uniforms['preserveColor'].value = value ? 1 : 0;\n        break;\n      case \"levels\":\n        this.postProcPass.uniforms['levels'].value = value;\n        break;\n      case \"repeats\":\n        this.postProcPass.uniforms['repeats'].value = value;\n        break;\n      case \"rotation\": // 0.0 to 1.0, around circle (e.g. 0.5 == pi radians, 1.0 == 2*pi)\n        this.postProcPass.uniforms['rotation'].value = value;\n        break;\n      case \"outlineRadius\":\n        this.postProcPass.uniforms['outlineRadius'].value = value;\n        break;\n      case \"outlineNoise\":\n        this.postProcPass.uniforms['outlineNoise'].value = value ? 1 : 0;\n        break;\n      default:\n        console.error(\"setPostProcessParameter: parameter '\" + token + \"' is not valid.\");}\n\n\n    return 0;\n  };\n\n  // TODO what's a better return value if undefined? Or just issue a warning? Should there be a separate query function?\n  this.queryPostProcessParameter = function (token, value) {\n    if (this.postProcPass.uniforms[token] !== 'undefined') {\n      return this.postProcPass.uniforms[token].value;\n    } else {\n      logger.warning(\"queryPostProcessParameter: parameter '\" + token + \"' is not valid\");\n      return value;\n    }\n  };\n\n  this.load = function () {\n    this.postProcPass = new ShaderPass(CelShader);\n    this.renderContext.setNoDepthNoBlend(this.postProcPass);\n\n    // Initialize the NPR related resources\n    this.preloadPostProcessStyle();\n  };\n\n  this.unload = function () {\n\n    this.changePostProcessParameter('style', null);\n\n    // Need to do some cleanup here, once user deactive the extension\n    // Can we remove all those resources to safe a little bit memory\n    var _iterator = _createForOfIteratorHelper(_graphiteMaps),_step;try {for (_iterator.s(); !(_step = _iterator.n()).done;) {var texture = _step.value;\n        texture.dispose();\n      }} catch (err) {_iterator.e(err);} finally {_iterator.f();}\n\n    _graphiteMaps = [];\n\n    RenderContextPostProcessExtension.prototype.unload.call(this);\n  };\n\n  this.postProcessEdgesOn = function () {\n    return (\n      this.isPostProcShaded() && (\n      this.postProcPass.uniforms[\"idEdges\"].value !== 0 ||\n      this.postProcPass.uniforms[\"normalEdges\"].value !== 0 ||\n      this.postProcPass.uniforms[\"depthEdges\"].value !== 0));\n\n  };\n\n  this.getOrder = function () {\n    return 10;\n  };\n\n  this.shouldRenderAfterOverlays = function () {\n    return false;\n  };\n};\n\nNPRRenderContextExtension.prototype = Object.create(RenderContextPostProcessExtension.prototype);\nNPRRenderContextExtension.prototype.constructor = NPRRenderContextExtension;\nav.GlobalManagerMixin.call(NPRRenderContextExtension.prototype);\n\nexport { NPRRenderContextExtension };","\n'use strict';\n\n\nvar TAB_ID = 'configTab';\nvar TAB_LABEL = 'Configuration';\nvar POST_PROCESS_LABEL = 'Postprocess Style';\nvar DISPLAY_EDGES = 'Display edges';\nvar DISPLAY_EDGES_DESC = 'Controls whether edge lines should be drawn around objects';\nvar GRAYSCALE = 'Grayscale';\nvar GRAYSCALE_DESC = 'Converts the rendering to grayscale with no color';\nvar BRIGHTNESS = 'Brightness';\nvar CONTRAST = 'Contrast';\nvar PRESERVE_COLOR = 'Preserve Color';\nvar PRESERVE_COLOR_DESC = 'Maintains the hue by pulling the color back into gamut if its too high';\nvar LEVELS = 'Levels';\nvar REPEATS = 'Repeats';\nvar ROTATION = 'Rotation';\nvar OUTLINE_RADIUS = 'Outline Radius';\nvar OUTLINE_NOISE = 'Outline Noise';\nvar OUTLINE_NOISE_DESC = 'Adds an outline noise to the edges';\n\nvar NPRRenderOptionsPanel = function NPRRenderOptionsPanel(viewer, extension, title) {var _this = this;\n  var PANEL_ID = 'adsk_npr_renderoptions_panel_' + viewer.id;\n  var opts = { heightAdjustment: 90, width: 460 };\n  Autodesk.Viewing.UI.SettingsPanel.call(this, viewer.container, PANEL_ID, title, opts);\n  this.setGlobalManager(viewer.globalManager);\n  this.container.classList.add('viewer-settings-panel');\n  this.viewer = viewer;\n\n  // Add a default tab called Render Options\n  this.addTab(TAB_ID, TAB_LABEL, { className: 'config' });\n  this.selectTab(TAB_ID);\n\n  // DropDown \"Postprocess Style\"\n  var postProcessList = ['none', 'edging', 'cel', 'graphite', 'pencil'];\n\n  this.postProcess = this.addDropDownMenu(TAB_ID, POST_PROCESS_LABEL, postProcessList, 0, function (event) {\n    var value = event.detail.value;\n\n    // load them all up, since someone is fiddling with style\n    extension.preloadPostProcessStyle();\n    extension.setPostProcessParameter(\"style\", postProcessList[value]);\n\n    var styleVal = Math.floor(parseFloat(value));\n    var enable = styleVal != 0.0;\n    _this.edgesCheckbox.setDisabled(!enable);\n    _this.grayscaleCheckbox.setDisabled(!enable);\n    _this.brightnessSlider.setDisabled(!enable);\n    _this.contrastSlider.setDisabled(!enable);\n    _this.preserveColorCheckbox.setDisabled(!enable);\n    _this.levelsSlider.setDisabled(styleVal !== 2.0);\n    _this.repeatsSlider.setDisabled(styleVal < 3.0);\n    _this.rotationSlider.setDisabled(styleVal < 3.0);\n    _this.outlineRadiusSlider.setDisabled(!enable);\n    _this.outlineNoiseCheckbox.setDisabled(!enable);\n  });\n  this.postProcessDropdown = this.getControl(this.postProcess);\n\n  // Checkbox \"Display Edges\"\n  this.edgesToggle = this.addCheckbox(TAB_ID, DISPLAY_EDGES, true, function (checked) {\n    extension.setPostProcessParameter(\"edges\", checked);\n  }, DISPLAY_EDGES_DESC);\n  this.edgesCheckbox = this.getControl(this.edgesToggle);\n\n  // Checkbox \"Gray Scale\"\n  this.grayscaleToggle = this.addCheckbox(TAB_ID, GRAYSCALE, true, function (checked) {\n    extension.setPostProcessParameter(\"grayscale\", checked);\n  }, GRAYSCALE_DESC);\n  this.grayscaleCheckbox = this.getControl(this.grayscaleToggle);\n\n  // Slider \"Brightness\"\n  this.brightness = this.addSlider(TAB_ID, BRIGHTNESS,\n  -1.0, 1.0, 0.0,\n  function (event) {\n    var value = event.detail.value;\n    extension.setPostProcessParameter('brightness', parseFloat(value));\n  },\n  { step: 0.01 });\n\n  this.brightnessSlider = this.getControl(this.brightness);\n\n  // Slider \"Contrast\"\n  this.contrast = this.addSlider(TAB_ID, CONTRAST,\n  -1.0, 1.0, 0.0,\n  function (event) {\n    var value = event.detail.value;\n    extension.setPostProcessParameter('contrast', parseFloat(value));\n  },\n  { step: 0.01 });\n\n  this.contrastSlider = this.getControl(this.contrast);\n\n  // Checkbox \"Preserve Color\"\n  this.preserveColorToggle = this.addCheckbox(TAB_ID, PRESERVE_COLOR, true, function (checked) {\n    extension.setPostProcessParameter(\"preserveColor\", checked);\n  }, PRESERVE_COLOR_DESC);\n  this.preserveColorCheckbox = this.getControl(this.preserveColorToggle);\n\n  // Slider \"Levels\"\n  this.levels = this.addSlider(TAB_ID, LEVELS, 2.0, 2.99, 0,\n  function (event) {\n    var value = event.detail.value;\n    extension.setPostProcessParameter(\"levels\", 2 * parseFloat(value));\n  }, { step: 0.01 });\n\n  this.levelsSlider = this.getControl(this.levels);\n\n  // Slider \"Repeats\"\n  this.repeats = this.addSlider(TAB_ID, REPEATS, 3.0, 5.0, 3.0,\n  function (event) {\n    var value = event.detail.value;\n    // \"graphite\" value ranges from 3.0 - 3.99;\n    // \"pencil\" value ranges from 4.0 - 5.0;\n    extension.setPostProcessParameter(\"repeats\", parseFloat(value));\n  }, { step: 0.01 });\n  this.repeatsSlider = this.getControl(this.repeats);\n\n  // Slider \"Rotation\"\n  this.rotation = this.addSlider(TAB_ID, ROTATION,\n  0.0, 1.0, 0.0,\n  function (event) {\n    var value = event.detail.value;\n    extension.setPostProcessParameter(\"rotation\", parseFloat(value));\n  },\n  { step: 0.01 });\n\n  this.rotationSlider = this.getControl(this.rotation);\n\n  // Checkbox \"Preserve Color\"\n  this.outlineNoiseToggle = this.addCheckbox(TAB_ID, OUTLINE_NOISE, false, function (checked) {\n    extension.setPostProcessParameter(\"outlineNoise\", checked);\n  }, OUTLINE_NOISE_DESC);\n  this.outlineNoiseCheckbox = this.getControl(this.outlineNoiseToggle);\n\n  // Slider \"Rotation\"\n  this.outlineRadius = this.addSlider(TAB_ID, OUTLINE_RADIUS,\n  1.0, 3.0, 1.0,\n  function (event) {\n    var value = event.detail.value;\n    extension.setPostProcessParameter(\"outlineRadius\", parseFloat(value));\n  },\n  { step: 0.01 });\n\n  this.outlineRadiusSlider = this.getControl(this.outlineRadius);\n};\n\nNPRRenderOptionsPanel.prototype = Object.create(Autodesk.Viewing.UI.SettingsPanel.prototype);\nNPRRenderOptionsPanel.prototype.constructor = NPRRenderOptionsPanel;\n\nexport { NPRRenderOptionsPanel };","import { NPRRenderContextExtension } from './NPRRenderContextExtension';\nimport { NPRRenderOptionsPanel } from './NPRRenderOptionsPanel';\nimport { locales } from './NPRLocales';\n\nvar SETTINGS_BUTTON_LABEL = 'Non-Photorealistic Rendering';\n\nvar Extension = Autodesk.Viewing.Extension;\n\n/**\n                                             * Provides UI controls for NPR settings\n                                             * \n                                             * The extension id is: `Autodesk.NPR`\n                                             * \n                                             * @example\n                                             *    viewer.loadExtension('Autodesk.NPR');\n                                             * \n                                             * @memberof Autodesk.Viewing.Extensions.NPR\n                                             * @see {@link Autodesk.Viewing.Extension} for common inherited methods.\n                                             * @constructor\n                                             * @param {Autodesk.Viewing.Viewer3D} viewer - Viewer instance.\n                                             * @param {Object} options - Not used.\n                                             */\nexport function NPRExtension(viewer, options) {\n  Extension.call(this, viewer, options);\n  this.viewer = viewer;\n  this._configButtonId = null;\n  this._panel = null;\n  this.hasUI = Autodesk.Viewing.GuiViewer3D && viewer instanceof Autodesk.Viewing.GuiViewer3D;\n  this.openPanel = this.openPanel.bind(this);\n  this._initButtonConfig = this._initButtonConfig.bind(this);\n};\n\nNPRExtension.prototype = Object.create(Autodesk.Viewing.Extension.prototype);\nNPRExtension.prototype.constructor = NPRExtension;\n\n/**\n                                                    * Load the NPR extension.\n                                                    * It will fail to load when running a headless viewer.\n                                                    */\nNPRExtension.prototype.load = function () {\n  this.extendLocalization(locales);\n  this.nprRenderContextExtension = new NPRRenderContextExtension(this.viewer.impl.renderer(), this.viewer);\n  this.nprRenderContextExtension.load();\n  this.viewer.impl.renderer().postShadingManager().registerPostProcessingExtension(this.nprRenderContextExtension);\n  return true;\n};\n\n/**\n    * Unload the NPR extension.\n    */\nNPRExtension.prototype.unload = function () {\n  if (this._configButtonId !== null) {\n    this.viewer.viewerSettingsPanel.removeConfigButton(this._configButtonId);\n    this._configButtonId = null;\n  }\n  if (this._panel) {\n    this._panel.uninitialize();\n    this._panel = null;\n  }\n  if (this.nprRenderContextExtension) {\n    this.viewer.impl.renderer().postShadingManager().removePostProcessingExtension(this.nprRenderContextExtension);\n    this.viewer.impl.invalidate(true, true, true);\n    this.nprRenderContextExtension = null;\n  }\n  return true;\n};\n\n/**\n    * Invoked by the viewer when the toolbar UI is available. \n    * Adds a button to the Settings panel.\n    *\n    * @alias Autodesk.Viewing.Extensions.NPRExtension#onToolbarCreated\n    */\nNPRExtension.prototype.onToolbarCreated = function () {\n  this._initButtonConfig();\n};\n\n/**\n    * Opens the NPR Render Options panel.\n    *\n    * @alias Autodesk.Viewing.Extensions.NPRExtension#openPanel\n    */\nNPRExtension.prototype.openPanel = function () {\n  if (!this._panel) {\n    this._panel = new NPRRenderOptionsPanel(this.viewer, this.nprRenderContextExtension, SETTINGS_BUTTON_LABEL);\n  }\n  this._panel.setVisible(true);\n};\n\n/**\n    * Changes post-processing setting parameters. The supported param/value combinations are:\n    * \n    * - \"style\": either \"edging\", \"cel\", \"graphite\", \"pencil\" or `null` to turn post-processing off.\n    * - \"edges\": `boolean`\n    * - \"idEdges\": `boolean`\n    * - \"normalEdges\": `boolean` \n    * - \"depthEdges\": `boolean`\n    * - \"brightness\": `Number`\n    * - \"contrast\": `Number`\n    * - \"grayscale\": `boolean`\n    * - \"preserveColor\": `boolean`\n    * - \"levels\": `Number`\n    * - \"repeats\": `Number`\n    * - \"rotation\": `Number` between 0 and 1, around circle (e.g. 0.5 == pi radians, 1.0 == 2*pi)\n    *\n    * Fires event {@link RENDER_OPTION_CHANGED_EVENT}.\n    *\n    * @param {string} param - Either \"style\", \"edges\", \"idEdges\", \"normalEdges\", \"depthEdges\", \"brightness\", \n    *                         \"contrast\", \"grayscale\", \"preserveColor\", \"levels\", \"repeats\" or \"rotation\".\n    * @param {*} value - type depends on the specified `param`.\n    *\n    * @alias Autodesk.Viewing.Extensions.NPRExtension#setParameter\n    */\nNPRExtension.prototype.setParameter = function (param, value) {\n  this.nprRenderContextExtension.setPostProcessParameter(param, value);\n};\n\n/**\n    * Adds a button to the Settings Panel.\n    * @private\n    */\nNPRExtension.prototype._initButtonConfig = function () {\n  var settingsPanel = this.viewer.getSettingsPanel();\n  if (!settingsPanel) {\n    this.addEventListener(av.SETTINGS_PANEL_CREATED_EVENT, this._initButtonConfig, { once: true });\n    return;\n  }\n  this._configButtonId = settingsPanel.addConfigButton(SETTINGS_BUTTON_LABEL, this.openPanel);\n};\n\n\n/**\n    * Register the extension with the extension manager.\n    */\nAutodesk.Viewing.theExtensionManager.registerExtension('Autodesk.NPR', NPRExtension);"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClDA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzOA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACrJA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;A","sourceRoot":""}